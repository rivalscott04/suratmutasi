import{j as e,W as j,au as Ye,Z as Ve,Y as Xe,a0 as q,ap as je,aD as Ze,ar as Qe,ae as ea,_ as K,aE as U,aF as aa,aq as sa,aA as be,ad as ta}from"./ui-vendor-DiY4nm-6.js";import{g as na,d as ia,r as l}from"./react-vendor-C8WR5ETM.js";import{C as b,c as f,a as D,b as A}from"./card-Cu65o8DU.js";import{u as ra,a as G,B as o,b as P,D as O,e as z,f as J,g as H,k as fe,j as L,m as la}from"./index-9P-lsB0e.js";import{A as W,a as Y,b as V,c as X,d as Z,e as Q,g as ve,f as ee}from"./alert-dialog-eX3gEOOO.js";import{T as ke}from"./textarea--GNqmhgS.js";import{L as ca}from"./label-OXHhtbJU.js";import{S as da}from"./switch-C3jbKxcn.js";const ba=()=>{const{pengajuanId:p}=na(),v=ia(),{user:n,token:u,isAuthenticated:ae}=ra(),[s,se]=l.useState(null),[te,ne]=l.useState([]),[ie,M]=l.useState([]),[Ne,re]=l.useState(!0),[le,c]=l.useState(null),[h,ye]=l.useState(null),[we,ce]=l.useState(!1),[_e,C]=l.useState(!1),[Se,T]=l.useState(!1),[De,y]=l.useState(!1),[Ae,R]=l.useState(!1),[Pe,k]=l.useState(!1),[Ce,$]=l.useState(""),[I,de]=l.useState(""),[F,oe]=l.useState(""),[d,g]=l.useState(!1),[me,ue]=l.useState(null),[pe,Te]=l.useState(!1);l.useEffect(()=>{if(!ae){v("/");return}p&&B()},[ae,v,p]),l.useEffect(()=>{const a=()=>{const t=window.pageYOffset||document.documentElement.scrollTop;Te(t>50)};return a(),window.addEventListener("scroll",a,{passive:!0}),()=>window.removeEventListener("scroll",a)},[]);const B=async()=>{var a,t,r;try{re(!0);const i=await G(`/api/pengajuan/${p}`,u);if(i.success)if(se(i.data.pengajuan),Array.isArray(i.data.requiredFiles)?ne(i.data.requiredFiles):ne([]),(n==null?void 0:n.role)==="admin_wilayah")try{const m=await G(`/api/admin-wilayah/pengajuan/${p}`,u),N=((a=m==null?void 0:m.adminWilayahFileConfig)==null?void 0:a.required)||((r=(t=m==null?void 0:m.data)==null?void 0:t.adminWilayahFileConfig)==null?void 0:r.required)||[];M(N.map(S=>S.file_type))}catch{M([])}else M([]);else c(i.message||"Gagal mengambil data pengajuan")}catch(i){console.error("Error fetching pengajuan data:",i),c("Terjadi kesalahan saat mengambil data pengajuan")}finally{re(!1)}},$e=async()=>{try{g(!0);const a=w?await fe(`/api/admin-wilayah/pengajuan/${p}/approve`,{notes:I},u):await L(`/api/pengajuan/${p}/approve`,{catatan:I},u);a.success?($("Pengajuan berhasil disetujui!"),k(!0),C(!1),de(""),await B()):c(a.message||"Gagal approve pengajuan")}catch(a){console.error("Error approving pengajuan:",a),c("Terjadi kesalahan saat approve pengajuan")}finally{g(!1)}},Fe=async()=>{try{g(!0);const a=w?await fe(`/api/admin-wilayah/pengajuan/${p}/reject`,{rejection_reason:F},u):await L(`/api/pengajuan/${p}/reject`,{rejection_reason:F},u);a.success?($("Pengajuan berhasil ditolak!"),k(!0),T(!1),oe(""),await B()):c(a.message||"Gagal reject pengajuan")}catch(a){console.error("Error rejecting pengajuan:",a),c("Terjadi kesalahan saat reject pengajuan")}finally{g(!1)}},Be=async()=>{try{g(!0);const a=await L(`/api/pengajuan/${p}/resubmit`,{},u);a.success?($("Pengajuan berhasil diajukan ulang!"),k(!0),await B()):c(a.message||"Gagal resubmit pengajuan")}catch(a){console.error("Error resubmitting pengajuan:",a),c("Terjadi kesalahan saat resubmit pengajuan")}finally{g(!1)}},Ee=async()=>{try{g(!0);const a=await la(`/api/pengajuan/${p}`,u);a.success?($("Pengajuan berhasil dihapus!"),k(!0),y(!1),setTimeout(()=>{v("/pengajuan")},2e3)):(c(a.message||"Gagal menghapus pengajuan"),y(!1))}catch(a){console.error("Error deleting pengajuan:",a),c("Terjadi kesalahan saat menghapus pengajuan"),y(!1)}finally{g(!1)}},Ke=a=>{const t={draft:{label:"Draft",className:"bg-gray-100 text-gray-800",icon:ta},submitted:{label:"Diajukan",className:"bg-blue-100 text-blue-800",icon:q},approved:{label:"Disetujui",className:"bg-green-100 text-green-800",icon:K},rejected:{label:"Ditolak",className:"bg-red-100 text-red-800",icon:U},admin_wilayah_approved:{label:"Disetujui Admin Wilayah",className:"bg-green-200 text-green-800",icon:K},admin_wilayah_rejected:{label:"Ditolak Admin Wilayah",className:"bg-red-200 text-red-800",icon:U}},r=t[a]||t.draft,i=r.icon;return e.jsxs(P,{className:r.className,children:[e.jsx(i,{className:"h-3 w-3 mr-1"}),r.label]})},Le=a=>({guru:"Guru",eselon_iv:"Eselon IV",fungsional:"Fungsional",pelaksana:"Pelaksana"})[a]||a,he=a=>({surat_pengantar:"Surat Pengantar",surat_permohonan_dari_yang_bersangkutan:"Surat Permohonan Dari Yang Bersangkutan",surat_keputusan_cpns:"Surat Keputusan CPNS",surat_keputusan_pns:"Surat Keputusan PNS",surat_keputusan_kenaikan_pangkat_terakhir:"Surat Keputusan Kenaikan Pangkat Terakhir",surat_keputusan_jabatan_terakhir:"Surat Keputusan Jabatan Terakhir",skp_2_tahun_terakhir:"SKP 2 Tahun Terakhir",surat_keterangan_bebas_temuan_inspektorat:"Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama",surat_keterangan_anjab_abk_instansi_asal:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",surat_keterangan_anjab_abk_instansi_penerima:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",surat_pernyataan_tidak_hukuman_disiplin:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",surat_persetujuan_mutasi_asal:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",surat_lolos_butuh_ppk:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",peta_jabatan:"Peta Jabatan",hasil_uji_kompetensi:"Hasil Uji Kompetensi",hasil_evaluasi_pertimbangan_baperjakat:"Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)",anjab_abk_instansi_asal:"Anjab/Abk Instansi Asal",anjab_abk_instansi_penerima:"Anjab/Abk Instansi Penerima",surat_keterangan_tidak_tugas_belajar:"Surat Keterangan Tidak Sedang Tugas Belajar",sptjm_pimpinan_satker_asal:"SPTJM Pimpinan Satker dari Asal",sptjm_pimpinan_satker_penerima:"SPTJM Pimpinan Satker dari Penerima",surat_rekomendasi_instansi_pembina:"Surat Rekomendasi Instansi Pembina"})[a]||a.replace(/_/g," ").toUpperCase(),Me=async(a,t,r)=>{try{console.log("🔍 Debug handleVerifyFile:",{fileId:a,verificationStatus:t,notes:r,token:u}),ue(a);const i={verification_status:t,verification_notes:r};console.log("📤 Request data:",i);const m=await L(`/api/pengajuan/files/${a}/verify`,i,u);console.log("📥 Response:",m),m.success?se(N=>N&&{...N,files:N.files.map(S=>S.id===a?{...S,verification_status:t,verified_by:(n==null?void 0:n.email)||(n==null?void 0:n.id),verified_at:new Date().toISOString()}:S)}):c(m.message||"Gagal verifikasi file")}catch(i){console.error("❌ Error verifying file:",i),c("Terjadi kesalahan saat verifikasi file")}finally{ue(null)}},Re=async()=>{try{g(!0);const a=await G(`/api/pengajuan/${p}/print-report`,u);a.success?Ie(a.data):c(a.message||"Gagal generate laporan")}catch(a){console.error("Error generating print report:",a),c("Terjadi kesalahan saat generate laporan")}finally{g(!1),R(!1)}},Ie=a=>{const t=window.open("","_blank");if(!t)return;const r=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Laporan Pengajuan - ${a.pegawai.nama}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; }
          .info { margin-bottom: 20px; }
          .info table { width: 100%; border-collapse: collapse; }
          .info td { padding: 5px; }
          .info td:first-child { font-weight: bold; width: 150px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; font-family: Arial, sans-serif; font-size: 10pt; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .checkbox { width: 20px; height: 20px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h2>LAPORAN PENGAJUAN JABATAN</h2>
        </div>
        
        <div class="info">
          <table>
            <tr><td>Nama</td><td>: ${a.pegawai.nama}</td></tr>
            <tr><td>NIP</td><td>: ${a.pegawai.nip}</td></tr>
            <tr><td>Jabatan</td><td>: ${a.pegawai.jabatan}</td></tr>
            <tr><td>Status</td><td>: ${a.pengajuan.status}</td></tr>
            <tr><td>Tanggal Approval</td><td>: ${new Date(a.pengajuan.approved_at).toLocaleDateString("id-ID")}</td></tr>
          </table>
        </div>

        <table>
          <thead>
            <tr>
              <th>No</th>
              <th>Nama Berkas</th>
              <th>Ada Berkas</th>
            </tr>
          </thead>
          <tbody>
            ${a.files.map((i,m)=>`
              <tr>
                <td>${m+1}</td>
                <td>${he(i.file_type)}</td>
                <td>
                  <input type="checkbox" class="checkbox" ${i.verification_status==="approved"?"checked":""} disabled>
                </td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        
        <!-- Verification Footer -->
        <div style="margin-top: 40px; padding: 15px; border-top: 2px solid #ddd; text-align: center; font-size: 10pt; color: #666;">
          <div style="margin-bottom: 8px; font-weight: bold;">
            ✓ Dokumen ini telah diverifikasi dan disetujui oleh Admin Kanwil
          </div>
          <div style="font-size: 9pt;">
            Tanggal Approval: ${a.approved_at?new Date(a.approved_at).toLocaleDateString("id-ID"):new Date().toLocaleDateString("id-ID")}
          </div>
          <div style="font-size: 8pt; margin-top: 5px;">
            Sistem Informasi Generator Surat - Kementerian Agama
          </div>
        </div>
      </body>
      </html>
    `;t.document.write(r),t.document.close(),t.print()},E=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),qe=a=>{const r=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,i)).toFixed(2))+" "+r[i]},Ue=async a=>{try{const t=await fetch(`/api/pengajuan/files/${a.id}`,{headers:{Authorization:`Bearer ${u}`}});if(!t.ok)throw new Error("Gagal mengambil file");const r=await t.blob(),i=URL.createObjectURL(r);ye({...a,blobUrl:i}),ce(!0)}catch(t){console.error("Error previewing file:",t),c("Gagal preview file. Silakan coba lagi.")}},Ge=a=>{window.open(`/api/pengajuan/files/${a.id}`,"_blank")},x=(n==null?void 0:n.role)==="admin",w=(n==null?void 0:n.role)==="admin_wilayah",ge=((s==null?void 0:s.status)==="draft"||(s==null?void 0:s.status)==="rejected")&&(x||(s==null?void 0:s.created_by)===(n==null?void 0:n.id))&&(n==null?void 0:n.role)!=="user",Oe=(s==null?void 0:s.status)==="draft"&&(n==null?void 0:n.role)!=="user",ze=x&&(s==null?void 0:s.status)==="submitted"||w&&((s==null?void 0:s.status)==="approved"||(s==null?void 0:s.status)==="submitted"),Je=x&&(s==null?void 0:s.status)==="submitted"||w&&((s==null?void 0:s.status)==="approved"||(s==null?void 0:s.status)==="submitted"),He=(s==null?void 0:s.status)==="rejected"&&(n==null?void 0:n.role)!=="user",_=(()=>{if(!s)return!1;const a=new Set([...te,...ie]);if(a.size===0)return!1;for(const t of a){const r=s.files.find(i=>i.file_type===t);if(!r||r.verification_status!=="approved")return!1}return!0})(),xe=(()=>{if(!s)return!1;const a=new Set([...te,...ie]);for(const t of a){const r=s.files.find(i=>i.file_type===t);if(!r||r.verification_status==="rejected"||r.verification_status==="pending")return!0}return!1})(),We=!xe;return Ne?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx(b,{children:e.jsxs(f,{className:"flex items-center justify-center py-12",children:[e.jsx(j,{className:"h-8 w-8 animate-spin mr-2"}),e.jsx("span",{children:"Memuat detail pengajuan..."})]})})}):s?e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
          .sidebar-scroll::-webkit-scrollbar {
            width: 8px;
          }
          .sidebar-scroll::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 4px;
          }
          .sidebar-scroll::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
          }
          .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #64748b;
          }
        `}}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"outline",onClick:()=>v("/pengajuan"),className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Kembali ke Data Pengajuan"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Detail Pengajuan"}),e.jsxs("p",{className:"text-gray-600",children:["ID: ",s.id]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:Ke(s.status)})]}),le&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600",children:le})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(b,{children:[e.jsx(D,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Informasi Pegawai"]})}),e.jsx(f,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("p",{className:"text-gray-900 text-base",children:s.pegawai.nama})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"NIP"}),e.jsx("p",{className:"text-gray-900 text-base",children:s.pegawai.nip})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jabatan Saat Ini"}),e.jsx("p",{className:"text-gray-900 text-base",children:s.pegawai.jabatan})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jenis Jabatan Target"}),e.jsx(P,{variant:"outline",className:"text-sm",children:Le(s.jenis_jabatan)})]})]})})]}),e.jsxs(b,{children:[e.jsx(D,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Dokumen yang Diupload",e.jsxs(P,{variant:"outline",className:"ml-2",children:[s.files.length," / ",s.total_dokumen]}),x&&s.status==="submitted"&&e.jsx(P,{variant:_?"default":"destructive",className:`ml-2 ${_?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_?"Semua Dokumen Sesuai":"Ada Dokumen Tidak Sesuai"})]})}),e.jsx(f,{children:s.files.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Belum ada dokumen yang diupload"}),ge&&e.jsxs(o,{onClick:()=>v(s.status==="draft"?`/pengajuan/${s.id}/upload`:`/pengajuan/${s.id}/edit`),className:"mt-4 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),s.status==="draft"?"Upload Dokumen":"Perbaiki Dokumen"]})]}):e.jsx("div",{className:"space-y-4",children:s.files.map(a=>e.jsx("div",{className:"p-6 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-medium text-base",children:he(a.file_type)}),e.jsx("p",{className:"text-sm text-gray-600",children:a.file_name}),e.jsx("p",{className:"text-xs text-gray-500",children:qe(a.file_size)}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs(P,{variant:a.verification_status==="approved"?"default":"destructive",className:`transition-all duration-500 ease-in-out transform ${a.verification_status==="approved"?"bg-green-100 text-green-800":a.verification_status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[a.verification_status==="approved"?"Sesuai":a.verification_status==="rejected"?"Tidak Sesuai":"Belum Diverifikasi",a.verified_by&&` - ${a.verified_by}`]}),a.verification_notes&&e.jsx("p",{className:"text-xs text-gray-600",children:a.verification_notes})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[x&&(s.status==="submitted"||s.status==="rejected")||w&&(s.status==="approved"||s.status==="submitted")?e.jsx("div",{className:"flex items-center gap-3 mr-3",children:me===a.id?e.jsx(j,{className:"h-4 w-4 animate-spin text-gray-500"}):e.jsxs("div",{className:"flex items-center gap-3 transition-all duration-500 ease-in-out",children:[e.jsx("div",{className:"relative transform transition-all duration-500 ease-in-out hover:scale-105 active:scale-95",children:e.jsx(da,{id:`verify-${a.id}`,checked:a.verification_status==="approved",onCheckedChange:t=>{const r=t?"approved":"rejected";Me(a.id,r)},disabled:me===a.id,className:`transition-all duration-500 ease-in-out transform ${a.verification_status==="approved"?"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600":"data-[state=unchecked]:bg-red-600 data-[state=unchecked]:border-red-600"}`})}),e.jsx(ca,{htmlFor:`verify-${a.id}`,className:`text-sm font-medium cursor-pointer transition-all duration-500 ease-in-out transform hover:scale-105 ${a.verification_status==="approved"?"text-green-700":a.verification_status==="rejected"?"text-red-700":"text-gray-700"}`,children:a.verification_status==="approved"?"Sesuai":a.verification_status==="rejected"?"Tidak Sesuai":"Belum Diverifikasi"})]})}):null,e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>Ue(a),className:"px-3 py-2",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Preview"]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>Ge(a),className:"px-3 py-2",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})},a.id))})})]})]}),e.jsxs("div",{className:`space-y-6 transition-all duration-300 ${pe?"lg:sticky lg:top-6 lg:z-40 lg:self-start sidebar-scroll":""}`,style:pe?{position:"sticky",top:"80px",zIndex:40,maxHeight:"calc(100vh - 120px)",overflowY:"scroll",paddingRight:"12px"}:{},children:[e.jsxs(b,{children:[e.jsx(D,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(ea,{className:"h-5 w-5"}),"Timeline Status"]})}),e.jsx(f,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Dibuat"}),e.jsx("p",{className:"text-sm text-gray-600",children:E(s.created_at)})]})]}),s.status!=="draft"&&e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Diajukan"}),e.jsx("p",{className:"text-sm text-gray-600",children:E(s.updated_at)})]})]}),s.status==="approved"&&s.approved_at&&e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Disetujui"}),e.jsx("p",{className:"text-sm text-gray-600",children:E(s.approved_at)}),s.approved_by&&e.jsxs("p",{className:"text-xs text-gray-500",children:["oleh ",s.approved_by]})]})]}),s.status==="rejected"&&s.rejected_at&&e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Ditolak"}),e.jsx("p",{className:"text-sm text-gray-600",children:E(s.rejected_at)}),s.rejected_by&&e.jsxs("p",{className:"text-xs text-gray-500",children:["oleh ",s.rejected_by]})]})]})]})})]}),(s.catatan||s.rejection_reason)&&e.jsxs(b,{children:[e.jsx(D,{children:e.jsx(A,{children:"Catatan"})}),e.jsxs(f,{children:[s.catatan&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Catatan Persetujuan:"}),e.jsx("p",{className:"text-sm text-gray-900 bg-green-50 p-4 rounded-lg leading-relaxed",children:s.catatan})]}),s.rejection_reason&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Alasan Penolakan:"}),e.jsx("p",{className:"text-sm text-gray-900 bg-red-50 p-4 rounded-lg leading-relaxed",children:s.rejection_reason})]})]})]}),e.jsxs(b,{children:[e.jsx(D,{children:e.jsx(A,{children:"Aksi"})}),e.jsxs(f,{className:"space-y-3",children:[ze&&(x?_:!0)&&e.jsxs(o,{onClick:()=>C(!0),className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Setujui"]}),Je&&(x?xe||!_:!0)&&e.jsxs(o,{onClick:()=>T(!0),variant:"destructive",className:"w-full",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Tolak"]}),He&&e.jsx(o,{onClick:Be,disabled:d||!We,className:"w-full bg-yellow-600 hover:bg-yellow-700 text-white",children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Memproses..."]}):e.jsxs(e.Fragment,{children:[e.jsx(aa,{className:"h-4 w-4 mr-2"}),"Ajukan Ulang"]})}),ge&&e.jsxs(o,{onClick:()=>v(s.status==="draft"?`/pengajuan/${s.id}/upload`:`/pengajuan/${s.id}/edit`),className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),s.status==="draft"?"Upload Dokumen":"Perbaiki Dokumen"]}),Oe&&e.jsxs(o,{onClick:()=>y(!0),variant:"destructive",className:"w-full",children:[e.jsx(sa,{className:"h-4 w-4 mr-2"}),"Hapus Pengajuan"]}),s.status==="approved"&&x&&e.jsxs(o,{onClick:()=>R(!0),className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Cetak Laporan"]})]})]})]})]}),e.jsx(O,{open:_e,onOpenChange:C,children:e.jsxs(z,{children:[e.jsx(J,{children:e.jsx(H,{children:"Setujui Pengajuan"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Catatan (Opsional)"}),e.jsx(ke,{value:I,onChange:a=>de(a.target.value),placeholder:"Masukkan catatan persetujuan...",rows:3,className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(o,{onClick:()=>C(!1),variant:"outline",className:"flex-1",disabled:d,children:"Batal"}),e.jsx(o,{onClick:$e,disabled:d,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Memproses..."]}):"Setujui"})]})]})]})}),e.jsx(W,{open:De,onOpenChange:y,children:e.jsxs(Y,{children:[e.jsxs(V,{children:[e.jsx(X,{children:"Hapus Pengajuan"}),e.jsx(Z,{children:"Apakah Anda yakin ingin menghapus pengajuan ini? Tindakan ini tidak dapat dibatalkan dan semua file yang diupload akan dihapus secara permanen."})]}),e.jsxs(Q,{children:[e.jsx(ve,{disabled:d,children:"Batal"}),e.jsx(ee,{onClick:Ee,disabled:d,className:"bg-red-600 hover:bg-red-700 text-white",children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Menghapus..."]}):"Hapus Pengajuan"})]})]})}),e.jsx(W,{open:Ae,onOpenChange:R,children:e.jsxs(Y,{children:[e.jsxs(V,{children:[e.jsx(X,{children:"Cetak Laporan"}),e.jsx(Z,{children:"Apakah Anda yakin ingin mencetak laporan pengajuan ini? Laporan akan dibuka di tab baru untuk dicetak."})]}),e.jsxs(Q,{children:[e.jsx(ve,{disabled:d,children:"Batal"}),e.jsx(ee,{onClick:Re,disabled:d,className:"bg-blue-600 hover:bg-blue-700 text-white",children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Menyiapkan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Cetak Laporan"]})})]})]})}),e.jsx(O,{open:Se,onOpenChange:T,children:e.jsxs(z,{children:[e.jsx(J,{children:e.jsx(H,{children:"Tolak Pengajuan"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Alasan Penolakan *"}),e.jsx(ke,{value:F,onChange:a=>oe(a.target.value),placeholder:"Masukkan alasan penolakan...",rows:3,required:!0,className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(o,{onClick:()=>T(!1),variant:"outline",className:"flex-1",disabled:d,children:"Batal"}),e.jsx(o,{onClick:Fe,disabled:d||!F.trim(),variant:"destructive",className:"flex-1",children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Memproses..."]}):"Tolak"})]})]})]})}),e.jsx(O,{open:we,onOpenChange:a=>{ce(a),!a&&(h!=null&&h.blobUrl)&&URL.revokeObjectURL(h.blobUrl)},children:e.jsxs(z,{className:"max-w-4xl",children:[e.jsx(J,{children:e.jsxs(H,{children:["Preview File: ",h==null?void 0:h.file_name]})}),e.jsx("div",{className:"mt-4",children:h&&e.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[e.jsx("div",{className:"bg-green-600 text-white px-4 py-2 flex items-center justify-between",children:e.jsx("span",{className:"font-medium",children:h.file_name})}),e.jsx("iframe",{src:h.blobUrl||`/api/pengajuan/files/${h.id}`,className:"w-full h-96 border-0",title:"File Preview"})]})})]})}),e.jsx(W,{open:Pe,onOpenChange:k,children:e.jsxs(Y,{children:[e.jsxs(V,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),"Berhasil!"]}),e.jsx(Z,{className:"text-green-700",children:Ce})]}),e.jsx(Q,{children:e.jsx(ee,{onClick:()=>k(!1),className:"bg-green-600 hover:bg-green-700 text-white",children:"OK"})})]})})]}):e.jsx("div",{className:"container mx-auto p-6",children:e.jsx(b,{children:e.jsxs(f,{className:"flex items-center justify-center py-12",children:[e.jsx(Ye,{className:"h-8 w-8 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-600",children:"Pengajuan tidak ditemukan"})]})})})};export{ba as default};
//# sourceMappingURL=PengajuanDetail-BMB2fJfe.js.map
