import{j as a,aa as ka,ax as Ua,F as P,a4 as N,E as X,ao as Q,at as Z,U as aa,X as K,aM as Ka}from"./ui-vendor-DQXcJUOU.js";import{d as Ma,e as $a,u as za,r as o}from"./react-vendor-DheTkQGW.js";import{C as ea,c as sa,a as Ea,b as Ra}from"./card-BAr0wAZw.js";import{u as Ga,d as Ia,a as na,b as B,B as p,P as ta,D as _a,e as fa,f as Na,g as wa,c as Ja,j as qa}from"./index-BTgfMWTc.js";import{A as La,a as Oa,b as Ha,c as Wa,d as Ta,e as Va,g as Ya,f as Xa}from"./alert-dialog-DV5WI_ce.js";import{T as Qa,a as Za,b as va,c as ya}from"./tabs-CwQIhKxO.js";const S=u=>String(u).toLowerCase().replace(/[^a-z0-9_-]+/gi,"_").replace(/^_+|_+$/g,""),F=u=>({surat_pengantar:"Surat Pengantar",surat_permohonan_dari_yang_bersangkutan:"Surat Permohonan Dari Yang Bersangkutan",surat_keputusan_cpns:"Surat Keputusan CPNS",surat_keputusan_pns:"Surat Keputusan PNS",surat_keputusan_kenaikan_pangkat_terakhir:"Surat Keputusan Kenaikan Pangkat Terakhir",surat_keputusan_jabatan_terakhir:"Surat Keputusan Jabatan Terakhir",skp_2_tahun_terakhir:"SKP 2 Tahun Terakhir",surat_keterangan_bebas_temuan_inspektorat:"Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama",surat_keterangan_anjab_abk_instansi_asal:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",surat_keterangan_anjab_abk_instansi_penerima:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",surat_pernyataan_tidak_hukuman_disiplin:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",surat_persetujuan_mutasi_asal:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",surat_lolos_butuh_ppk:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",peta_jabatan:"Peta Jabatan",hasil_uji_kompetensi:"Hasil Uji Kompetensi",hasil_evaluasi_pertimbangan_baperjakat:"Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)",anjab_abk_instansi_asal:"Anjab/Abk Instansi Asal",anjab_abk_instansi_penerima:"Anjab/Abk Instansi Penerima",surat_keterangan_tidak_tugas_belajar:"Surat Keterangan Tidak Sedang Tugas Belajar",sptjm_pimpinan_satker_asal:"SPTJM Pimpinan Satker dari Asal",sptjm_pimpinan_satker_penerima:"SPTJM Pimpinan Satker dari Penerima",surat_rekomendasi_instansi_pembina:"Surat Rekomendasi Instansi Pembina"})[u]||u.replace(/_/g," ").toUpperCase(),ae=u=>({surat_pengantar:"Dokumen Pengantar",surat_permohonan_dari_yang_bersangkutan:"Dokumen Pengantar",surat_keputusan_cpns:"Dokumen Kepegawaian",surat_keputusan_pns:"Dokumen Kepegawaian",surat_keputusan_kenaikan_pangkat_terakhir:"Dokumen Kepegawaian",surat_keputusan_jabatan_terakhir:"Dokumen Kepegawaian",skp_2_tahun_terakhir:"Dokumen Kepegawaian",surat_keterangan_bebas_temuan_inspektorat:"Dokumen Keterangan",surat_keterangan_anjab_abk_instansi_asal:"Dokumen Keterangan",surat_keterangan_anjab_abk_instansi_penerima:"Dokumen Keterangan",surat_pernyataan_tidak_hukuman_disiplin:"Dokumen Pernyataan",surat_persetujuan_mutasi_asal:"Dokumen Persetujuan",surat_lolos_butuh_ppk:"Dokumen Persetujuan",peta_jabatan:"Dokumen Pendukung",hasil_uji_kompetensi:"Dokumen Pendukung",hasil_evaluasi_pertimbangan_baperjakat:"Dokumen Pendukung",anjab_abk_instansi_asal:"Dokumen Pendukung",anjab_abk_instansi_penerima:"Dokumen Pendukung",surat_keterangan_tidak_tugas_belajar:"Dokumen Keterangan",sptjm_pimpinan_satker_asal:"Dokumen Pernyataan",sptjm_pimpinan_satker_penerima:"Dokumen Pernyataan",surat_rekomendasi_instansi_pembina:"Dokumen Rekomendasi"})[u]||"Dokumen Lainnya",ia=u=>({guru:"Guru",eselon_iv:"Eselon IV",fungsional:"Fungsional",pelaksana:"Pelaksana"})[u]||u,le=()=>{var ja,ba;const{pengajuanId:u}=Ma(),D=$a(),ra=za(),{token:b,user:M}=Ga(),{toast:_}=Ia(),[l,Pa]=o.useState(null),[f,w]=o.useState([]),[$,la]=o.useState({}),[z,E]=o.useState({}),[Sa,da]=o.useState(!1),[Fa,R]=o.useState(!1),[Da,oa]=o.useState(!0),[ca,m]=o.useState(null),[U,ua]=o.useState(!1),[j,Ca]=o.useState(null),[Aa,G]=o.useState(!1),[I,C]=o.useState(null),v=o.useRef({}),h=(ja=ra.state)==null?void 0:ja.jabatan,J=(ba=ra.state)==null?void 0:ba.requiredFiles,[ma,ga]=o.useState(null);o.useState([]);const[y,q]=o.useState([]),k=(M==null?void 0:M.role)==="kanwil";o.useEffect(()=>{u&&pa()},[u]),o.useEffect(()=>{if(!k||!b){console.log("â­ï¸ Skipping admin wilayah config fetch:",{isKanwil:k,hasToken:!!b});return}(async()=>{console.log("ðŸ” Checking for jabatan data:",{jabatanData:h==null?void 0:h.id,pengajuanJabatanId:l==null?void 0:l.jabatan_id}),h!=null&&h.id?(console.log("ðŸ“‹ Using jabatanData.id:",h.id),await L(h.id)):l!=null&&l.jabatan_id?(console.log("ðŸ“‹ Using pengajuan.jabatan_id:",l.jabatan_id),await L(l.jabatan_id)):console.log("âš ï¸ No jabatan_id found for admin wilayah config")})()},[k,h==null?void 0:h.id,l==null?void 0:l.jabatan_id,b]),o.useEffect(()=>{(()=>{Object.values(v.current).forEach(n=>{n&&(n.value="")})})()});const pa=async()=>{try{oa(!0);const e=await na(`/api/pengajuan/${u}`,b);if(e.success){if(Pa(e.data.pengajuan),J&&J.length>0)w(J),h&&ga(h);else if(e.data.requiredFiles&&e.data.requiredFiles.length>0)w(e.data.requiredFiles);else if(e.data.pengajuan.jabatan_id)try{const n=await na(`/api/job-type-configurations/${e.data.pengajuan.jabatan_id}`,b);n.success&&n.data.required_files?(w(n.data.required_files),ga(n.data)):(m("Konfigurasi dokumen untuk jabatan ini belum tersedia. Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan."),w([]))}catch(n){console.error("Error fetching job type configuration:",n),m("Gagal mengambil konfigurasi dokumen. Silakan hubungi admin."),w([])}else m("Jabatan belum dikonfigurasi. Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan."),w([]);k&&e.data.pengajuan.jabatan_id&&await L(e.data.pengajuan.jabatan_id)}else m(e.message||"Gagal mengambil data pengajuan")}catch(e){console.error("Error fetching pengajuan data:",e),m("Terjadi kesalahan saat mengambil data pengajuan")}finally{oa(!1)}},L=async e=>{try{console.log("ðŸ” Fetching admin wilayah config for jabatan_id:",e);const n=await na(`/api/admin-wilayah-file-config/job-type/${e}`,b);console.log("ðŸ” Admin wilayah config response:",n),n.success&&Array.isArray(n.data)?(console.log("âœ… Setting admin wilayah required files:",n.data),q(n.data)):(console.log("âš ï¸ Admin wilayah config not found or empty for jabatan_id:",e),q([]))}catch(n){console.error("âŒ Error fetching admin wilayah config:",n),q([])}},O=async(e,n)=>{if(!l){const t="Data pengajuan tidak ditemukan. Silakan refresh halaman.";m(t),_({title:"Error",description:t,variant:"destructive"});return}const s=y.some(t=>t.file_type===e);if(!f.includes(e)&&!s){const t=l.jenis_jabatan||"tidak diketahui",i=`File "${F(e)}" tidak sesuai dengan jabatan pengajuan saat ini.

â€¢ Jabatan pengajuan: ${ia(t)}
â€¢ File yang diupload: ${F(e)}

Silakan pastikan Anda mengupload file yang sesuai dengan jabatan pengajuan.`;m(i),_({title:"Jabatan Tidak Sesuai",description:`File "${F(e)}" tidak sesuai dengan jabatan pengajuan "${ia(t)}". Silakan upload file yang sesuai dengan jabatan pengajuan.`,variant:"destructive"});return}if(n.type!=="application/pdf"&&!n.name.toLowerCase().endsWith(".pdf")){const t="Hanya file PDF yang diizinkan untuk diupload.";m(t),_({title:"Format File Tidak Valid",description:t,variant:"destructive"});return}const x=e==="skp_2_tahun_terakhir"?Math.floor(1.7*1024*1024):500*1024;if(n.size>x){const t=e==="skp_2_tahun_terakhir"?"1.7MB":"500KB",i=(n.size/(1024*1024)).toFixed(2),r=`File terlalu besar. Maksimal ${t}. Ukuran file saat ini: ${i}MB`;m(r),_({title:"Ukuran File Terlalu Besar",description:r,variant:"destructive"});return}la(t=>({...t,[e]:!0})),E(t=>({...t,[e]:0}));const g=new FormData;g.append("file",n),g.append("file_type",e),g.append("file_category",s?"admin_wilayah":"kabupaten");try{const t=setInterval(()=>{E(r=>({...r,[e]:Math.min(r[e]+10,90)}))},200),i=await fetch(`/api/pengajuan/${u}/upload`,{method:"POST",headers:{Authorization:`Bearer ${b}`},body:g});if(clearInterval(t),E(r=>({...r,[e]:100})),i.ok){const r=await i.json();if(r.success){await pa(),m(null),_({title:"Upload Berhasil",description:`File ${F(e)} berhasil diupload`,variant:"default"});const c=v.current[e];c&&(c.value="")}else{const c=r.message||"Gagal upload file";m(c),_({title:"Upload Gagal",description:c,variant:"destructive"})}}else{let r="Gagal upload file";try{const c=await i.json();r=c.message||c.error||`Error ${i.status}: ${i.statusText}`}catch{i.status===413?r="File terlalu besar. Untuk SKP 2 Tahun Terakhir maksimal 1.7MB, file lain maksimal 500KB.":i.status===400?r="Format file tidak valid atau file terlalu besar.":r=`Error ${i.status}: ${i.statusText}`}m(r),_({title:"Upload Gagal",description:r,variant:"destructive"})}}catch(t){console.error("Error uploading file:",t);const i=(t==null?void 0:t.message)||"Terjadi kesalahan saat upload file. Silakan coba lagi.";m(i),_({title:"Upload Gagal",description:i,variant:"destructive"})}finally{la(i=>({...i,[e]:!1})),C(null);const t=v.current[e];t&&(t.value="")}},Ba=async()=>{try{ua(!0);const e=k?`/api/pengajuan/${u}/submit-kanwil`:`/api/pengajuan/${u}/submit`,s=await(k?Ja:qa)(e,{catatan:""},b);s.success?da(!0):m(s.message||"Gagal submit pengajuan")}catch(e){console.error("Error submitting pengajuan:",e),m("Terjadi kesalahan saat submit pengajuan")}finally{ua(!1),R(!1)}},H=async e=>{try{const n=await fetch(`/api/pengajuan/files/${e.id}`,{headers:{Authorization:`Bearer ${b}`}});if(!n.ok)throw new Error("Gagal mengambil file");const s=await n.blob(),d=URL.createObjectURL(s);Ca({...e,blobUrl:d}),G(!0)}catch(n){console.error("Error previewing file:",n),m("Gagal preview file. Silakan coba lagi.")}},W=e=>{window.open(`/api/pengajuan/files/${e.id}`,"_blank")},T=e=>{C(e)},ha=()=>{const e=f.every(n=>l==null?void 0:l.files.some(s=>s.file_type===n&&(!s.file_category||s.file_category==="kabupaten")));if(k&&y.length>0){const n=y.every(s=>l==null?void 0:l.files.some(d=>d.file_type===s.file_type&&d.file_category==="admin_wilayah"));return e&&n}return e},V=(e,n)=>n?l!=null&&l.files.some(s=>s.file_type===e&&s.file_category===n)?"uploaded":"pending":l!=null&&l.files.some(s=>s.file_type===e&&(!s.file_category||s.file_category==="kabupaten"))?"uploaded":"pending",Y=e=>{const s=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,d)).toFixed(2))+" "+s[d]},xa=f.reduce((e,n)=>{const s=ae(n);return e[s]||(e[s]=[]),e[s].push(n),e},{});return Da?a.jsx("div",{className:"container mx-auto p-6",children:a.jsx(ea,{children:a.jsxs(sa,{className:"flex items-center justify-center py-12",children:[a.jsx(ka,{className:"h-8 w-8 animate-spin text-green-600"}),a.jsx("span",{className:"ml-2",children:"Memuat data pengajuan..."})]})})}):l?a.jsxs("div",{className:"container mx-auto p-6",children:[a.jsxs(ea,{children:[a.jsxs(Ea,{children:[a.jsx(Ra,{children:"Upload Berkas Pengajuan Mutasi PNS"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[l.pegawai.nama," - ",l.pegawai.jabatan]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Jenis Jabatan: ",ia(l.jenis_jabatan)]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Total Dokumen: ",ma?ma.max_dokumen:f.length," surat"]})]}),a.jsxs(sa,{children:[ca&&a.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-red-600",children:ca})}),f.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(P,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500 mb-2",children:"Tidak ada dokumen yang diperlukan"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan"})]}):k&&y.length>0?a.jsxs(Qa,{defaultValue:"kabupaten",className:"w-full",children:[a.jsxs(Za,{className:"grid w-full grid-cols-2 mb-6",children:[a.jsxs(va,{value:"kabupaten",className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-4 w-4"}),"Dokumen Kabupaten/Kota",a.jsx(B,{variant:"secondary",className:"ml-2",children:f.length})]}),a.jsxs(va,{value:"admin_wilayah",className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-4 w-4"}),"Dokumen Admin Wilayah",a.jsx(B,{variant:"secondary",className:"ml-2 bg-purple-100 text-purple-800",children:y.length})]})]}),a.jsx(ya,{value:"kabupaten",className:"space-y-6",children:Object.entries(xa).map(([e,n])=>a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 border-b pb-2",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(s=>{const d=V(s),x=$[s],g=z[s],t=l.files.find(r=>r.file_type===s),i=I===s;return a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:F(s)}),a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Upload file PDF (maks. ",s==="skp_2_tahun_terakhir"?"1.7MB":"500KB",")"]})]}),a.jsxs(B,{variant:"secondary",className:d==="uploaded"?"bg-green-600 text-white hover:bg-green-700":"",children:[d==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),d==="uploaded"?"Uploaded":"Pending"]})]}),d==="uploaded"&&t&&!i?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-green-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:t.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(t.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>H(t),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>W(t),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>T(s),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:r=>v.current[s]=r,type:"file",accept:".pdf",onChange:r=>{var A;const c=(A=r.target.files)==null?void 0:A[0];c&&(O(s,c),r.target.value="")},disabled:x,className:"hidden",id:`file-${S(s)}`}),a.jsxs("label",{htmlFor:`file-${S(s)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),x?"Uploading...":i?"Pilih File Baru":"Pilih File"]}),i&&a.jsxs(p,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(K,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),x&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:g,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g,"% uploaded"]})]})]},s)})})]},e))}),a.jsx(ya,{value:"admin_wilayah",className:"space-y-6",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(e=>{const n=e.file_type,s=V(n,"admin_wilayah"),d=$[n],x=z[n],g=l.files.find(i=>i.file_type===n&&i.file_category==="admin_wilayah"),t=I===n;return a.jsxs("div",{className:"border rounded-lg p-4 border-purple-300",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:e.display_name||n}),e.description&&a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:e.description}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Upload file PDF (maks. 500KB)"})]}),a.jsxs(B,{variant:"secondary",className:s==="uploaded"?"bg-purple-600 text-white hover:bg-purple-700":"bg-purple-100 text-purple-800",children:[s==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),s==="uploaded"?"Uploaded":"Pending"]})]}),s==="uploaded"&&g&&!t?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-purple-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:g.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(g.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>H(g),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>W(g),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>T(n),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:i=>v.current[n]=i,type:"file",accept:".pdf",onChange:i=>{var c;const r=(c=i.target.files)==null?void 0:c[0];r&&(O(n,r),i.target.value="")},disabled:d,className:"hidden",id:`file-aw-${S(n)}`}),a.jsxs("label",{htmlFor:`file-aw-${S(n)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-purple-300 rounded-md shadow-sm text-sm font-medium text-purple-700 bg-white hover:bg-purple-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),d?"Uploading...":t?"Pilih File Baru":"Pilih File"]}),t&&a.jsxs(p,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(K,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),d&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:x,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x,"% uploaded"]})]})]},n)})})})]}):Object.entries(xa).map(([e,n])=>a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 border-b pb-2",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(s=>{const d=V(s),x=$[s],g=z[s],t=l.files.find(r=>r.file_type===s),i=I===s;return a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:F(s)}),a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Upload file PDF (maks. ",s==="skp_2_tahun_terakhir"?"1.7MB":"500KB",")"]})]}),a.jsxs(B,{variant:"secondary",className:d==="uploaded"?"bg-green-600 text-white hover:bg-green-700":"",children:[d==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),d==="uploaded"?"Uploaded":"Pending"]})]}),d==="uploaded"&&t&&!i?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-green-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:t.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(t.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>H(t),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>W(t),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(p,{size:"sm",variant:"outline",onClick:()=>T(s),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:r=>v.current[s]=r,type:"file",accept:".pdf",onChange:r=>{var A;const c=(A=r.target.files)==null?void 0:A[0];c&&(O(s,c),r.target.value="")},disabled:x,className:"hidden",id:`file-${S(s)}`}),a.jsxs("label",{htmlFor:`file-${S(s)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),x?"Uploading...":i?"Pilih File Baru":"Pilih File"]}),i&&a.jsxs(p,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(K,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),x&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:g,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g,"% uploaded"]})]})]},s)})})]},e)),f.length>0&&a.jsxs("div",{className:"mt-8 pt-6 border-t",children:[a.jsxs(p,{onClick:()=>R(!0),disabled:!ha()||U,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"lg",children:[a.jsx(Ka,{className:"h-4 w-4 mr-2"}),"Submit Pengajuan"]}),!ha()&&a.jsx("p",{className:"text-sm text-gray-500 mt-2 text-center",children:"Semua berkas harus diupload sebelum dapat submit"})]})]})]}),a.jsx(La,{open:Fa,onOpenChange:R,children:a.jsxs(Oa,{children:[a.jsxs(Ha,{children:[a.jsx(Wa,{children:"Submit Pengajuan"}),a.jsx(Ta,{children:"Apakah Anda yakin ingin submit pengajuan ini? Setelah disubmit, pengajuan tidak dapat diedit lagi dan akan diproses oleh admin."})]}),a.jsxs(Va,{children:[a.jsx(Ya,{disabled:U,children:"Batal"}),a.jsx(Xa,{onClick:Ba,disabled:U,className:"bg-green-600 hover:bg-green-700 text-white",children:U?a.jsxs(a.Fragment,{children:[a.jsx(ka,{className:"h-4 w-4 mr-2 animate-spin text-green-600"}),"Submitting..."]}):"Submit Pengajuan"})]})]})}),a.jsx(_a,{open:Sa,onOpenChange:da,children:a.jsxs(fa,{children:[a.jsx(Na,{children:a.jsx(wa,{children:"Pengajuan Berhasil!"})}),a.jsxs("div",{className:"text-center py-6",children:[a.jsx(N,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),a.jsxs("p",{className:"text-lg font-medium mb-2",children:["Pengajuan untuk ",l.pegawai.nama," berhasil disubmit"]}),a.jsx("p",{className:"text-gray-600 mb-6",children:k?"Pengajuan akan diproses oleh superadmin. Anda akan mendapat notifikasi ketika status berubah.":"Pengajuan akan diproses oleh admin. Anda akan mendapat notifikasi ketika status berubah."}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(p,{onClick:()=>D("/dashboard"),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:"Kembali ke Dashboard"}),a.jsx(p,{onClick:()=>D("/pengajuan/select"),variant:"outline",className:"flex-1",children:"Buat Pengajuan Baru"})]})]})]})}),a.jsx(_a,{open:Aa,onOpenChange:e=>{G(e),!e&&(j!=null&&j.blobUrl)&&URL.revokeObjectURL(j.blobUrl)},children:a.jsxs(fa,{className:"max-w-4xl",children:[a.jsx(Na,{children:a.jsx(wa,{className:"flex items-center justify-between",children:a.jsxs("span",{children:["Preview File: ",j==null?void 0:j.file_name]})})}),a.jsx("div",{className:"mt-4",children:j&&a.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"bg-green-600 text-white px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:j.file_name}),a.jsx(p,{variant:"ghost",size:"sm",onClick:()=>G(!1),className:"text-white hover:bg-green-700",children:a.jsx(K,{className:"h-4 w-4"})})]}),a.jsx("iframe",{src:j.blobUrl||`/api/pengajuan/files/${j.id}`,className:"w-full h-96 border-0",title:"File Preview"})]})})]})})]}):a.jsx("div",{className:"container mx-auto p-6",children:a.jsx(ea,{children:a.jsxs(sa,{className:"flex items-center justify-center py-12",children:[a.jsx(Ua,{className:"h-8 w-8 text-red-500"}),a.jsx("span",{className:"ml-2 text-red-600",children:"Pengajuan tidak ditemukan"})]})})})};export{le as default};
//# sourceMappingURL=PengajuanFileUpload-Zy1wAjT5.js.map
