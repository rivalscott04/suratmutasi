import{j as e,K as c,a3 as H,x as B,a4 as M,a5 as U,a6 as $,a7 as K}from"./ui-vendor-e65TVV2G.js";import{d as q,r,L as D}from"./react-vendor-C8WR5ETM.js";import{u as J,a as k,S as m,B as O,b as h}from"./index-On9BQ588.js";import{C as g,a as u,b as j,c as p}from"./card-BaAea6zS.js";import{T as z,a as Q,b,c as o,d as V,e as n}from"./table-DfpZqIyh.js";import"./data-vendor-DtxkLsA5.js";const te=()=>{const{user:a,token:d,loading:f}=J(),N=q(),[i,A]=r.useState([]),[E,w]=r.useState([]),[y,R]=r.useState(null),[F,v]=r.useState(!1),[W,S]=r.useState(!1),[x,_]=r.useState(""),C=i.filter(s=>{var t,l,T;return((t=s.letter_number)==null?void 0:t.toLowerCase().includes(x.toLowerCase()))||((l=s.subject)==null?void 0:l.toLowerCase().includes(x.toLowerCase()))||((T=s.template_name)==null?void 0:T.toLowerCase().includes(x.toLowerCase()))});if(r.useEffect(()=>{!f&&!a&&N("/")},[a,f,N]),r.useEffect(()=>{a&&d&&(v(!0),k("/api/letters",d).then(s=>A(s.letters||[])).catch(s=>R(s.message||"Gagal fetch surat")).finally(()=>v(!1)),S(!0),k("/api/employees",d).then(s=>w(s.employees||[])).catch(()=>w([])).finally(()=>S(!1)))},[a,d]),f)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx(m,{className:"h-8 w-1/2 mb-4"}),e.jsx(m,{className:"h-10 w-1/3 mb-2"}),e.jsx(m,{className:"h-10 w-1/3 mb-2"}),e.jsx(m,{className:"h-10 w-1/3 mb-2"})]});const I=[{title:"Total Surat",value:i.length,change:"+12%",icon:c,color:"text-blue-600"},{title:"Surat Bulan Ini",value:i.filter(s=>new Date(s.createdAt).getMonth()===new Date().getMonth()).length,change:"+5%",icon:H,color:"text-green-600"},{title:"Pegawai Terdaftar",value:E.length,change:"+3%",icon:B,color:"text-purple-600"},{title:"Surat Pending",value:i.filter(s=>s.status==="draft").length,change:"-1",icon:M,color:"text-orange-600"}],L=Array.from(new Set(i.map(s=>s.template_name))).filter(Boolean),P=[{title:"Buat Surat Baru",description:"Mulai membuat surat dengan template yang tersedia",icon:c,href:"/generator",color:"bg-blue-500",showForRoles:["admin","operator"]},{title:"Kelola Pegawai",description:"Tambah atau edit data pegawai",icon:B,href:"/settings",color:"bg-green-500",showForRoles:["admin","operator"]},{title:"Lihat Laporan",description:"Analisis penggunaan surat",icon:K,href:"/reports",color:"bg-purple-500",showForRoles:["admin","operator","user"]}],G=s=>s==="generated"?e.jsx(h,{className:"bg-green-100 text-green-700 border-green-200",children:"Generated"}):s==="draft"?e.jsx(h,{className:"bg-orange-100 text-orange-700 border-orange-200",children:"Draft"}):s==="signed"?e.jsx(h,{className:"bg-blue-100 text-blue-700 border-blue-200",children:"Signed"}):e.jsx(h,{className:"bg-gray-100 text-gray-700 border-gray-200",children:s});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Selamat datang, ",(a==null?void 0:a.full_name)||(a==null?void 0:a.email)||"User"," - ",(a==null?void 0:a.role)||"Operator"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:I.map((s,t)=>{const l=s.icon;return e.jsxs(g,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium text-gray-600",children:s.title}),e.jsx(l,{className:`h-4 w-4 ${s.color}`})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"text-green-600",children:s.change})," dari bulan lalu"]})]})]},t)})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:P.filter(s=>s.showForRoles.includes((a==null?void 0:a.role)||"")).map((s,t)=>{const l=s.icon;return e.jsxs(g,{className:"hover:shadow-md transition-shadow cursor-pointer",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.color}`,children:e.jsx(l,{className:"h-5 w-5 text-white"})}),e.jsx("div",{children:e.jsx(j,{className:"text-lg",children:s.title})})]})}),e.jsxs(p,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsx(O,{asChild:!0,variant:"outline",className:"w-full",children:e.jsxs(D,{to:s.href,children:["Akses ",e.jsx($,{className:"ml-2 h-4 w-4"})]})})]})]},t)})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(g,{children:[e.jsx(u,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5 text-green-700"})," Jenis Template"]})}),e.jsx(p,{children:e.jsx("div",{className:"space-y-3",children:L.length===0?e.jsx("div",{className:"text-center text-gray-500",children:"Belum ada template surat"}):L.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx(c,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:s})]},t))})})]})}),e.jsxs(g,{className:"mb-4",children:[e.jsx(u,{children:e.jsx(j,{className:"text-xl font-semibold",children:"Daftar Surat"})}),e.jsxs(p,{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-2",children:e.jsx("input",{type:"text",className:"input input-bordered w-full md:w-64",placeholder:"Cari nomor, perihal, atau template...",value:x,onChange:s=>_(s.target.value)})}),F?e.jsx("div",{children:"Loading surat..."}):y?e.jsx("div",{className:"text-error",children:y}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(z,{children:[e.jsx(Q,{children:e.jsxs(b,{children:[e.jsx(o,{children:"No."}),e.jsx(o,{children:"Nomor Surat"}),e.jsx(o,{children:"Perihal"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Aksi"})]})}),e.jsx(V,{children:C.length===0?e.jsx(b,{children:e.jsx(n,{colSpan:5,className:"text-center",children:"Tidak ada surat"})}):C.slice(0,5).map((s,t)=>e.jsxs(b,{children:[e.jsx(n,{children:t+1}),e.jsx(n,{children:s.letter_number}),e.jsx(n,{children:s.subject}),e.jsx(n,{children:G(s.status)}),e.jsx(n,{children:e.jsxs(D,{to:`/letters/${s.id}`,className:"btn btn-xs btn-outline flex items-center gap-1",children:[e.jsx(c,{className:"w-4 h-4"})," Detail"]})})]},s.id))})]})})]})]})]})};export{te as default};
//# sourceMappingURL=Dashboard-CziEG-3i.js.map
