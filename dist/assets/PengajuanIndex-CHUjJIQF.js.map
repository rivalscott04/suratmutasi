{"version":3,"file":"PengajuanIndex-CHUjJIQF.js","sources":["../../src/pages/PengajuanIndex.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { \n  Plus, \n  Search, \n  Filter, \n  MoreHorizontal, \n  Eye, \n  Edit, \n  Trash2, \n  CheckCircle, \n  XCircle, \n  Clock, \n  FileText,\n  Loader2,\n  ChevronLeft,\n  ChevronRight,\n  Settings,\n  HelpCircle,\n  Download\n} from 'lucide-react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { apiGet, apiDelete, apiPut, apiPost } from '@/lib/api';\nimport { useToast } from '@/hooks/use-toast';\nimport { formatError } from '@/utils/errorFormatter';\nimport Shepherd, { type Tour } from 'shepherd.js';\nimport 'shepherd.js/dist/css/shepherd.css';\n\ninterface PengajuanData {\n  id: string;\n  created_by?: string;\n  pegawai: {\n    nama: string;\n    jabatan: string;\n  };\n  jenis_jabatan: string;\n  total_dokumen: number;\n  status: 'draft' | 'submitted' | 'approved' | 'rejected' | 'resubmitted' | 'admin_wilayah_approved' | 'admin_wilayah_rejected' | 'admin_wilayah_submitted' | 'kanwil_submitted' | 'kanwil_approved' | 'final_approved' | 'final_rejected';\n  catatan?: string;\n  rejection_reason?: string;\n  resubmitted_at?: string;\n  resubmitted_by?: string;\n  created_at: string;\n  files: Array<{\n    id: string;\n    file_type: string;\n    file_name: string;\n    file_category?: string;\n  }>;\n}\n\nconst PengajuanIndex: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { user, token, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const [pengajuanList, setPengajuanList] = useState<PengajuanData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Initialize state from URL params or sessionStorage\n  const getInitialFilter = (key: string, defaultValue: string): string => {\n    // First try URL params\n    const urlValue = searchParams.get(key);\n    if (urlValue !== null) return urlValue;\n    \n    // Fallback to sessionStorage (for backward navigation from detail)\n    const stored = sessionStorage.getItem(`pengajuan_filter_${key}`);\n    if (stored) return stored;\n    \n    return defaultValue;\n  };\n  \n  const [searchTerm, setSearchTerm] = useState(() => getInitialFilter('search', ''));\n  const [statusFilter, setStatusFilter] = useState<string>(() => getInitialFilter('status', 'all'));\n  const [createdByFilter, setCreatedByFilter] = useState<string>(() => getInitialFilter('created_by', 'all'));\n  const [jenisJabatanFilter, setJenisJabatanFilter] = useState<string>(() => getInitialFilter('jenis_jabatan', 'all'));\n  const [currentPage, setCurrentPage] = useState(() => {\n    const page = getInitialFilter('page', '1');\n    return parseInt(page, 10) || 1;\n  });\n  const [totalPages, setTotalPages] = useState(1);\n  const [totalItems, setTotalItems] = useState(0);\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [pengajuanToDelete, setPengajuanToDelete] = useState<string | null>(null);\n  const [deleting, setDeleting] = useState(false);\n  const [showUpdateStatusDialog, setShowUpdateStatusDialog] = useState(false);\n  const [selectedPengajuan, setSelectedPengajuan] = useState<PengajuanData | null>(null);\n  const [newStatus, setNewStatus] = useState<string>('');\n  const [statusChangeReason, setStatusChangeReason] = useState<string>('');\n  const [updatingStatus, setUpdatingStatus] = useState(false);\n  const [filterOptions, setFilterOptions] = useState<{\n    users: Array<{ id: string; email: string; full_name: string }>;\n    statuses: Array<{ value: string; label: string; count: number }>;\n    jenisJabatan: Array<{ value: string; label: string; count: number }>;\n    kabupatenGroups?: Array<{ groupName: string; kabupaten: string[]; count: number }>;\n    kabupaten?: Array<{ name: string; count: number }>;\n  }>({ users: [], statuses: [], jenisJabatan: [] });\n  const [kabupatenGroupFilter, setKabupatenGroupFilter] = useState<string>(() => getInitialFilter('kabupaten_group', 'all'));\n  const [groupedByKabkota, setGroupedByKabkota] = useState<Record<string, PengajuanData[]>>({});\n  const pengajuanTourRef = useRef<Tour | null>(null);\n  const [showGenerateDownloadDialog, setShowGenerateDownloadDialog] = useState(false);\n  const [generateDownloadFilterType, setGenerateDownloadFilterType] = useState<'jabatan' | 'kabupaten' | 'pegawai'>('jabatan');\n  const [generateDownloadFilterValue, setGenerateDownloadFilterValue] = useState<string | string[]>('');\n  const [generatingDownload, setGeneratingDownload] = useState(false);\n  const [generateDownloadProgress, setGenerateDownloadProgress] = useState<string>('');\n  const [generateFilterOptions, setGenerateFilterOptions] = useState<{\n    jenisJabatan: Array<{ value: string; label: string; count: number }>;\n    kabupatenGroups?: Array<{ groupName: string; kabupaten: string[]; count: number }>;\n    pegawai?: Array<{ id: string; nama: string; nip?: string; count?: number }>;\n  }>({ jenisJabatan: [], pegawai: [] });\n  const [generateOptionsLoading, setGenerateOptionsLoading] = useState(false);\n  const [generatePegawaiSearch, setGeneratePegawaiSearch] = useState('');\n  const [showPegawaiSuggestions, setShowPegawaiSuggestions] = useState(false);\n  const [selectedGeneratePegawai, setSelectedGeneratePegawai] = useState<Array<{ id: string; label: string }>>([]);\n\n  const itemsPerPage = 50;\n  const isAdmin = user?.role === 'admin';\n  const isReadOnlyUser = user?.role === 'user';\n  const isBimas = user?.role === 'bimas';\n  const isKanwil = user?.role === 'kanwil';\n  const isAdminWilayah = user?.role === 'admin_wilayah';\n  const isReadOnlyRole = isReadOnlyUser || isBimas;\n  const isGroupingRole = isAdmin || isReadOnlyUser || isBimas;\n\n  // Fallback grouping on client for admin when server doesn't provide grouping\n  const clientGroupedByKabkota: Record<string, PengajuanData[]> = React.useMemo(() => {\n    if (!isGroupingRole) return {};\n    \n    // Always use server grouping if available\n    if (Object.keys(groupedByKabkota).length > 0) {\n      console.log(' Using server grouping:', groupedByKabkota);\n      return groupedByKabkota;\n    }\n    \n    // Fallback to client grouping\n    if (!pengajuanList || pengajuanList.length === 0) return {};\n    \n    console.log(' Using client grouping, pengajuanList length:', pengajuanList.length);\n    const clientGrouped = pengajuanList.reduce((acc: Record<string, PengajuanData[]>, item: any) => {\n      const kab = (item.office && (item.office.kabkota || item.office.name)) || (item.pegawai && (item.pegawai as any).induk_unit) || (item.pegawai as any)?.unit_kerja || 'Lainnya';\n      if (!acc[kab]) acc[kab] = [];\n      acc[kab].push(item);\n      return acc;\n    }, {});\n    \n    console.log(' Client grouped result:', clientGrouped);\n    return clientGrouped;\n  }, [isGroupingRole, groupedByKabkota, pengajuanList]);\n\n  const startPengajuanTour = useCallback(() => {\n    if (!isReadOnlyUser) {\n      toast({\n        title: 'Tutorial khusus pengguna tracking',\n        description: 'Menu ini hanya tersedia untuk role user yang fokus tracking.',\n      });\n      return;\n    }\n\n    if (loading) {\n      toast({\n        title: 'Tunggu sebentar',\n        description: 'Kami masih menyiapkan data pengajuan untuk tur.',\n      });\n      return;\n    }\n\n    const totalRows = Object.values(clientGroupedByKabkota).reduce((acc, list) => acc + list.length, 0);\n    if (totalRows === 0) {\n      toast({\n        title: 'Data belum tersedia',\n        description: 'Tidak ada pengajuan untuk ditampilkan. Coba sesuaikan filter atau kembali lagi nanti.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (pengajuanTourRef.current) {\n      pengajuanTourRef.current.cancel();\n      pengajuanTourRef.current = null;\n    }\n    sessionStorage.removeItem('pending_pengajuan_list_tour');\n\n    // Pastikan accordion pertama terbuka supaya step terlihat\n    setTimeout(() => {\n      const firstAccordionTrigger = document.querySelector('[data-tour-id=\"pengajuan-accordion\"] button');\n      if (firstAccordionTrigger && firstAccordionTrigger.getAttribute('aria-expanded') !== 'true') {\n        (firstAccordionTrigger as HTMLButtonElement).click();\n      }\n    }, 0);\n\n    const tour = new Shepherd.Tour({\n      useModalOverlay: true,\n      defaultStepOptions: {\n        cancelIcon: {\n          enabled: true\n        },\n        classes: 'bg-white shadow-xl rounded-lg border border-gray-200 text-gray-800',\n        scrollTo: { behavior: 'smooth', block: 'center' }\n      }\n    });\n\n    const buildButtons = (options?: { showBack?: boolean; isFinal?: boolean }) => {\n      const buttons = [\n        {\n          text: 'Lewati',\n          classes: 'shepherd-button-secondary text-gray-500',\n          action: async () => {\n            tour.cancel();\n          }\n        }\n      ];\n\n      if (options?.showBack) {\n        buttons.push({\n          text: 'Kembali',\n          classes: 'shepherd-button-secondary',\n          action: async () => {\n            tour.back();\n          }\n        });\n      }\n\n      buttons.push({\n        text: options?.isFinal ? 'Selesai' : 'Lanjut',\n        classes: 'shepherd-button-primary bg-green-600 text-white hover:bg-green-700',\n        action: async () => {\n          if (options?.isFinal) {\n            tour.complete();\n          } else {\n            tour.next();\n          }\n        }\n      });\n\n      return buttons;\n    };\n\n    tour.addStep({\n      id: 'intro',\n      title: 'Daftar Pengajuan',\n      text: 'Halaman ini menampilkan seluruh pengajuan dengan grouping kabupaten/kota agar Anda mudah memilih dokumen mana yang akan dicek.',\n      attachTo: {\n        element: '[data-tour-id=\"pengajuan-header\"]',\n        on: 'bottom'\n      },\n      buttons: buildButtons()\n    });\n\n    tour.addStep({\n      id: 'filters',\n      title: 'Filter & Pencarian',\n      text: 'Gunakan pencarian dan filter status untuk mempersempit daftar. Sistem otomatis menyimpan filter Anda.',\n      attachTo: {\n        element: '[data-tour-id=\"pengajuan-filter\"]',\n        on: 'top'\n      },\n      buttons: buildButtons({ showBack: true })\n    });\n\n    if (document.querySelector('[data-tour-id=\"pengajuan-jabatan-filter\"]')) {\n      tour.addStep({\n        id: 'jabatan',\n        title: 'Filter Jenis Jabatan',\n        text: 'Khusus role user, filter ini membantu fokus pada jabatan tertentu (misal Guru, Fungsional).',\n        attachTo: {\n          element: '[data-tour-id=\"pengajuan-jabatan-filter\"]',\n          on: 'bottom'\n        },\n        buttons: buildButtons({ showBack: true })\n      });\n    }\n\n    tour.addStep({\n      id: 'accordion',\n      title: 'Kelompok Kabupaten/Kota',\n      text: 'Setiap Kanwil memuat daftar kabupaten/kota. Klik untuk membuka tabel pengajuan di dalamnya.',\n      attachTo: {\n        element: '[data-tour-id=\"pengajuan-accordion\"]',\n        on: 'top'\n      },\n      buttons: buildButtons({ showBack: true })\n    });\n\n    tour.addStep({\n      id: 'row-action',\n      title: 'Masuk ke Detail Pengajuan',\n      text: 'Gunakan tombol aksi “...” lalu pilih Lihat Detail untuk membuka dokumen dan catatan lengkap.',\n      attachTo: {\n        element: '[data-tour-id=\"pengajuan-row-action\"]',\n        on: 'left'\n      },\n      buttons: buildButtons({ showBack: true })\n    });\n\n    tour.addStep({\n      id: 'finish',\n      title: 'Siap ke Halaman Detail',\n      text: 'Setelah menemukan pengajuan yang ingin dicek, buka detailnya. Kami akan menampilkan tur lanjutan otomatis ketika detail terbuka.',\n      buttons: buildButtons({ showBack: true, isFinal: true })\n    });\n\n    tour.on('complete', () => {\n      sessionStorage.setItem('pending_pengajuan_detail_tour', 'true');\n      sessionStorage.removeItem('pending_pengajuan_list_tour');\n      toast({\n        title: 'Langkah berikutnya',\n        description: 'Buka salah satu pengajuan lalu klik Lihat Detail untuk melihat tur lanjutan.',\n      });\n    });\n\n    tour.on('cancel', () => {\n      sessionStorage.removeItem('pending_pengajuan_list_tour');\n      sessionStorage.removeItem('pending_pengajuan_detail_tour');\n    });\n\n    tour.start();\n    pengajuanTourRef.current = tour;\n  }, [isReadOnlyUser, loading, clientGroupedByKabkota, toast]);\n\n  useEffect(() => {\n    if (!loading && isReadOnlyUser) {\n      const pendingTour = sessionStorage.getItem('pending_pengajuan_list_tour');\n      if (pendingTour === 'true') {\n        startPengajuanTour();\n      }\n    }\n  }, [loading, isReadOnlyUser, startPengajuanTour]);\n\n  useEffect(() => {\n    return () => {\n      if (pengajuanTourRef.current) {\n        pengajuanTourRef.current.cancel();\n        pengajuanTourRef.current = null;\n      }\n    };\n  }, []);\n\n  // Update URL params when filters change\n  useEffect(() => {\n    if (!isAuthenticated) return;\n    \n    const params = new URLSearchParams();\n    if (searchTerm) params.set('search', searchTerm);\n    if (statusFilter !== 'all') params.set('status', statusFilter);\n    if (createdByFilter !== 'all') params.set('created_by', createdByFilter);\n    if (jenisJabatanFilter !== 'all') params.set('jenis_jabatan', jenisJabatanFilter);\n    if (kabupatenGroupFilter !== 'all') params.set('kabupaten_group', kabupatenGroupFilter);\n    if (currentPage > 1) params.set('page', currentPage.toString());\n    \n    // Update URL without triggering navigation\n    setSearchParams(params, { replace: true });\n    \n    // Also save to sessionStorage for backward navigation\n    sessionStorage.setItem('pengajuan_filter_search', searchTerm);\n    sessionStorage.setItem('pengajuan_filter_status', statusFilter);\n    sessionStorage.setItem('pengajuan_filter_created_by', createdByFilter);\n    sessionStorage.setItem('pengajuan_filter_jenis_jabatan', jenisJabatanFilter);\n    sessionStorage.setItem('pengajuan_filter_kabupaten_group', kabupatenGroupFilter);\n    sessionStorage.setItem('pengajuan_filter_page', currentPage.toString());\n  }, [isAuthenticated, searchTerm, statusFilter, createdByFilter, jenisJabatanFilter, kabupatenGroupFilter, currentPage, setSearchParams]);\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      navigate('/');\n      return;\n    }\n    // Lock status filter to final_approved for read-only user (admin pusat)\n    if (isReadOnlyUser && statusFilter !== 'final_approved') {\n      setStatusFilter('final_approved');\n    }\n    fetchPengajuanData();\n  }, [isAuthenticated, navigate, currentPage, statusFilter, createdByFilter, jenisJabatanFilter, kabupatenGroupFilter, isReadOnlyUser, searchTerm]);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchFilterOptions();\n    }\n  }, [isAuthenticated, jenisJabatanFilter, statusFilter, createdByFilter, searchTerm]);\n\n  const fetchGenerateFilterOptions = useCallback(async () => {\n    if (!isAuthenticated) return;\n    try {\n      setGenerateOptionsLoading(true);\n      const response = await apiGet('/api/pengajuan/filter-options?status=final_approved', token);\n      if (response.success) {\n        const { jenisJabatan = [], kabupatenGroups = [], pegawai = [] } = response.data || {};\n        setGenerateFilterOptions({\n          jenisJabatan,\n          kabupatenGroups,\n          pegawai\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching generate filter options:', error);\n    } finally {\n      setGenerateOptionsLoading(false);\n    }\n  }, [isAuthenticated, token]);\n\n  useEffect(() => {\n    if (showGenerateDownloadDialog && (isAdmin || isReadOnlyUser)) {\n      fetchGenerateFilterOptions();\n    }\n  }, [showGenerateDownloadDialog, isAdmin, isReadOnlyUser, fetchGenerateFilterOptions]);\n\n\n    const fetchPengajuanData = async () => {\n    try {\n      setLoading(true);\n      const params = new URLSearchParams({\n        page: currentPage.toString(),\n        limit: itemsPerPage.toString(),\n        ...(statusFilter !== 'all' && { status: statusFilter }),\n        ...(jenisJabatanFilter !== 'all' && { jenis_jabatan: jenisJabatanFilter }),\n        ...(searchTerm && { search: searchTerm }),\n        ...(isAdmin && createdByFilter !== 'all' && { created_by: createdByFilter }),\n        ...((isAdmin || isReadOnlyUser) && kabupatenGroupFilter !== 'all' && { kabupaten_group: kabupatenGroupFilter }),\n        // Kanwil hanya melihat pengajuan yang mereka buat\n        ...(isKanwil && user?.id && { created_by: user.id })\n      });\n\n\n      const response = await apiGet(`/api/pengajuan?${params}`, token);\n      \n      \n      if (response.success) {\n        setPengajuanList(response.data);\n        if (isAdmin) {\n          const grouped = response.grouped_by_kabkota;\n          console.log(' Frontend received grouped data:', grouped);\n          console.log(' Frontend received data length:', response.data?.length);\n          if (grouped) {\n            setGroupedByKabkota(grouped as Record<string, PengajuanData[]>);\n          } else {\n            setGroupedByKabkota({});\n          }\n        }\n        \n        const totalPagesValue = response.pagination?.totalPages || 1;\n        const totalItemsValue = response.pagination?.total || 0;\n        \n        \n        setTotalPages(totalPagesValue);\n        setTotalItems(totalItemsValue);\n        \n      } else {\n        setError(response.message || 'Gagal mengambil data pengajuan');\n      }\n     } catch (error) {\n       console.error('Error fetching pengajuan data:', error);\n       const errorMsg = formatError(error);\n       setError(errorMsg);\n     } finally {\n       setLoading(false);\n     }\n   };\n\n       const fetchFilterOptions = async () => {\n      try {\n        console.log(' Fetching filter options...');\n        // Kirim filter aktif saat ini ke backend untuk menghitung count yang akurat\n        const params = new URLSearchParams();\n        if (jenisJabatanFilter !== 'all') params.set('jenis_jabatan', jenisJabatanFilter);\n        if (statusFilter !== 'all') params.set('status', statusFilter);\n        if (isAdmin && createdByFilter !== 'all') params.set('created_by', createdByFilter);\n        if (searchTerm) params.set('search', searchTerm);\n        \n        const queryString = params.toString();\n        const url = queryString ? `/api/pengajuan/filter-options?${queryString}` : '/api/pengajuan/filter-options';\n        const response = await apiGet(url, token);\n        console.log(' Filter options response:', response);\n        if (response.success) {\n          setFilterOptions(response.data);\n          console.log(' Filter options set:', response.data);\n          console.log(' Kabupaten groups:', response.data?.kabupatenGroups);\n          console.log(' Kabupaten groups length:', response.data?.kabupatenGroups?.length);\n        } else {\n          console.error(' Filter options failed:', response.message);\n        }\n      } catch (error) {\n        console.error('Error fetching filter options:', error);\n      }\n    };\n\n  const handleSearch = (value: string) => {\n    setSearchTerm(value);\n    setCurrentPage(1);\n  };\n\n  const handleStatusFilter = (value: string) => {\n    if (isReadOnlyUser) return; // locked to final_approved\n    setStatusFilter(value);\n    setCurrentPage(1);\n  };\n\n  const handleCreatedByFilter = (value: string) => {\n    setCreatedByFilter(value);\n    setCurrentPage(1);\n  };\n\n  const handleJenisJabatanFilter = (value: string) => {\n    setJenisJabatanFilter(value);\n    setCurrentPage(1);\n  };\n\n  const handleKabupatenGroupFilter = (value: string) => {\n    setKabupatenGroupFilter(value);\n    setCurrentPage(1);\n  };\n\n  const filteredGeneratePegawaiOptions = useMemo(() => {\n    const list = generateFilterOptions.pegawai || [];\n    const q = generatePegawaiSearch.trim().toLowerCase();\n    if (!q) return list;\n    return list.filter((p) => \n      (p.nama && p.nama.toLowerCase().includes(q)) ||\n      (p.nip && p.nip.toLowerCase().includes(q))\n    );\n  }, [generateFilterOptions.pegawai, generatePegawaiSearch]);\n\n  const handleSelectGeneratePegawai = (pegawaiId: string, label: string) => {\n    // avoid duplicate\n    if (selectedGeneratePegawai.find((p) => p.id === pegawaiId)) {\n      setGeneratePegawaiSearch('');\n      setShowPegawaiSuggestions(false);\n      return;\n    }\n    // limit 20\n    if (selectedGeneratePegawai.length >= 20) {\n      toast({\n        title: 'Batas tercapai',\n        description: 'Maksimal 20 pegawai per generate.',\n        variant: 'destructive'\n      });\n      return;\n    }\n    const next = [...selectedGeneratePegawai, { id: pegawaiId, label }];\n    setSelectedGeneratePegawai(next);\n    setGenerateDownloadFilterValue(next.map((p) => p.id));\n    setGeneratePegawaiSearch('');\n    setShowPegawaiSuggestions(false);\n  };\n\n  const handleRemoveGeneratePegawai = (pegawaiId: string) => {\n    const next = selectedGeneratePegawai.filter((item) => item.id !== pegawaiId);\n    setSelectedGeneratePegawai(next);\n    setGenerateDownloadFilterValue(next.map((item) => item.id));\n  };\n\n  // Helper function to navigate to detail while preserving filter state\n  const navigateToDetail = (pengajuanId: string) => {\n    // Filter state is already saved in sessionStorage by the useEffect above\n    // Just navigate to detail\n    navigate(`/pengajuan/${pengajuanId}`);\n  };\n\n\n\n    const handleDelete = async () => {\n    if (!pengajuanToDelete) return;\n\n    try {\n      setDeleting(true);\n      const response = await apiDelete(`/api/pengajuan/${pengajuanToDelete}`, token);\n      \n      if (response.success) {\n        fetchPengajuanData();\n        setDeleteDialogOpen(false);\n        setPengajuanToDelete(null);\n      } else {\n        setError(response.message || 'Gagal menghapus pengajuan');\n      }\n    } catch (error) {\n      console.error('Error deleting pengajuan:', error);\n      setError('Terjadi kesalahan saat menghapus pengajuan');\n    } finally {\n      setDeleting(false);\n    }\n  };\n\n  const handleUpdateStatus = async () => {\n    if (!selectedPengajuan || !newStatus) return;\n\n    setUpdatingStatus(true);\n    try {\n      const response = await apiPut(\n        `/api/pengajuan/${selectedPengajuan.id}/update-status`,\n        {\n          status: newStatus,\n          reason: statusChangeReason\n        },\n        token\n      );\n\n      if (response.success) {\n        toast({\n          title: 'Berhasil',\n          description: 'Status pengajuan berhasil diubah',\n        });\n        setShowUpdateStatusDialog(false);\n        setSelectedPengajuan(null);\n        setNewStatus('');\n        setStatusChangeReason('');\n        fetchPengajuanData();\n      } else {\n        toast({\n          title: 'Error',\n          description: response.message || 'Gagal mengubah status',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error updating status:', error);\n      toast({\n        title: 'Error',\n        description: 'Terjadi kesalahan saat mengubah status',\n        variant: 'destructive',\n      });\n    } finally {\n      setUpdatingStatus(false);\n    }\n  };\n\n  const getStatusBadge = (status: string, pengajuan?: PengajuanData) => {\n    // Helper function to determine if this is submitted after admin wilayah approval\n    const isSubmittedAfterAdminWilayah = (status: string, pengajuan?: PengajuanData) => {\n      if (status !== 'submitted' || !pengajuan) return false;\n      // Only show \"Diajukan Admin Wilayah\" if there are actual admin wilayah files\n      return pengajuan.files?.some(f => f.file_category === 'admin_wilayah') || false;\n    };\n\n    const statusConfig = {\n      draft: { label: 'Draft', className: 'bg-gray-100 text-gray-800 hover:bg-gray-200', icon: Clock },\n      submitted: { \n        label: isSubmittedAfterAdminWilayah(status, pengajuan) ? 'Diajukan Admin Wilayah' : 'Diajukan', \n        className: isSubmittedAfterAdminWilayah(status, pengajuan) ? 'bg-blue-200 text-blue-800 hover:bg-blue-300' : 'bg-blue-100 text-blue-800 hover:bg-blue-200', \n        icon: FileText \n      },\n      approved: { label: 'Disetujui', className: 'bg-green-100 text-green-800 hover:bg-green-200', icon: CheckCircle },\n      rejected: { label: 'Ditolak Admin Wilayah', className: 'bg-red-100 text-red-800 hover:bg-red-200', icon: XCircle },\n      resubmitted: { label: 'Diajukan Ulang', className: 'bg-yellow-100 text-yellow-800 hover:bg-yellow-200', icon: Clock },\n      admin_wilayah_approved: { label: 'Disetujui Admin Wilayah', className: 'bg-green-200 text-green-800 hover:bg-green-300', icon: CheckCircle },\n      admin_wilayah_rejected: { label: 'Ditolak Superadmin', className: 'bg-red-200 text-red-800 hover:bg-red-300', icon: XCircle },\n      admin_wilayah_submitted: { label: 'Diajukan Admin Wilayah', className: 'bg-blue-200 text-blue-800 hover:bg-blue-300', icon: FileText },\n      kanwil_submitted: { label: 'Diajukan Kanwil', className: 'bg-purple-200 text-purple-800 hover:bg-purple-300', icon: FileText },\n      kanwil_approved: { label: 'Disetujui Kanwil', className: 'bg-purple-300 text-purple-900 hover:bg-purple-400', icon: CheckCircle },\n      final_approved: { label: 'Final Approved', className: 'bg-green-600 text-white', icon: CheckCircle },\n      final_rejected: { label: 'Final Rejected', className: 'bg-red-600 text-white', icon: XCircle }\n    } as const;\n\n    const config = (statusConfig as any)[status] || { label: status, className: 'bg-gray-100 text-gray-800', icon: FileText };\n    const Icon = config.icon as any;\n\n    return (\n      <Badge className={config.className}>\n        <Icon className=\"h-3 w-3 mr-1\" />\n        {config.label}\n      </Badge>\n    );\n  };\n\n  const getJabatanDisplayName = (jenisJabatan: string): string => {\n    const jabatanMap: Record<string, string> = {\n      'guru': 'Guru',\n      'eselon_iv': 'Eselon IV',\n      'fungsional': 'Fungsional',\n      'pelaksana': 'Pelaksana'\n    };\n    \n    return jabatanMap[jenisJabatan] || jenisJabatan;\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('id-ID', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Rekap dan export (khusus read-only user)\n  const buildRekapPerKabkota = () => {\n    const source = Object.keys(clientGroupedByKabkota).length > 0\n      ? clientGroupedByKabkota\n      : pengajuanList.reduce((acc: Record<string, PengajuanData[]>, item: any) => {\n          const kab = (item.office && (item.office.kabkota || item.office.name)) || (item.pegawai && (item.pegawai as any).induk_unit) || (item.pegawai as any)?.unit_kerja || 'Lainnya';\n          if (!acc[kab]) acc[kab] = [];\n          acc[kab].push(item);\n          return acc;\n        }, {});\n    return Object.entries(source).map(([kab, items]) => ({ kabkota: kab, total: items.length }));\n  };\n\n  const downloadBlob = (blob: Blob, filename: string) => {\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n  };\n\n  const exportExcel = () => {\n    const rows = buildRekapPerKabkota();\n    const today = new Date();\n    const ymd = `${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}${String(today.getDate()).padStart(2, '0')}`;\n    const filename = `Rekap-final_approved-per-kabkota-${ymd}.xls`;\n    const tableHtml = `\n      <html>\n      <head><meta charset=\"UTF-8\" /></head>\n      <body>\n        <table border=\"1\">\n          <thead>\n            <tr><th>Kab/Kota</th><th>Jumlah Pengajuan Final Approved</th></tr>\n          </thead>\n          <tbody>\n            ${rows.map(r => `<tr><td>${r.kabkota}</td><td>${r.total}</td></tr>`).join('')}\n          </tbody>\n        </table>\n      </body>\n      </html>`;\n    const blob = new Blob([tableHtml], { type: 'application/vnd.ms-excel' });\n    downloadBlob(blob, filename);\n  };\n\n  const exportPDF = () => {\n    const rows = buildRekapPerKabkota().sort((a, b) => b.total - a.total);\n    const total = rows.reduce((acc, r) => acc + r.total, 0);\n    const max = Math.max(1, ...rows.map(r => r.total));\n    const kabCount = rows.length;\n    const now = new Date();\n    const dateStr = now.toLocaleString('id-ID', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' });\n    const ymd = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}`;\n    const filename = `Rekap-disetujui-kanwil-per-kabkota-${ymd}.pdf`;\n\n    const createdBy = (user?.full_name || user?.email || 'Admin Pusat');\n    const top5 = rows.slice(0, 5);\n\n    const win = window.open('', '_blank');\n    if (!win) return;\n    win.document.write(`\n      <html>\n        <head>\n          <meta charset=\\\"UTF-8\\\" />\n          <title>${filename}</title>\n          <style>\n            @page { size: A4; margin: 18mm 14mm; }\n            * { box-sizing: border-box; }\n            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color: #111827; }\n            .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }\n            .title { font-size: 18px; font-weight: 700; }\n            .meta { font-size: 12px; color: #4b5563; }\n            .summary { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 8px; margin: 12px 0 16px; }\n            .card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; }\n            .card h3 { font-size: 12px; color: #6b7280; margin: 0 0 4px; font-weight: 600; }\n            .card .value { font-size: 20px; font-weight: 700; color: #111827; }\n            table { border-collapse: collapse; width: 100%; margin-top: 4px; }\n            th, td { border: 1px solid #e5e7eb; padding: 8px 10px; font-size: 12px; }\n            th { background: #f9fafb; text-align: left; }\n            tfoot td { font-weight: 700; background: #f3f4f6; }\n            .row { display: flex; align-items: center; gap: 10px; }\n            .bar { height: 8px; background: #d1fae5; border-radius: 4px; overflow: hidden; }\n            .bar > span { display: block; height: 100%; background: #10b981; }\n            .note { margin-top: 12px; font-size: 11px; color: #6b7280; }\n            .section-title { margin-top: 16px; font-size: 14px; font-weight: 700; }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <div>\n              <div class=\"title\">Rekap Pengajuan Telah Disetujui Kanwil per Kab/Kota</div>\n              <div class=\"meta\">Dihasilkan: ${dateStr} • Dibuat oleh: ${createdBy}</div>\n            </div>\n          </div>\n\n          <div class=\"summary\">\n            <div class=\"card\">\n              <h3>Total Telah Disetujui Kanwil</h3>\n              <div class=\"value\">${total}</div>\n            </div>\n            <div class=\"card\">\n              <h3>Jumlah Kab/Kota</h3>\n              <div class=\"value\">${kabCount}</div>\n            </div>\n            <div class=\"card\">\n              <h3>Top Kab/Kota</h3>\n              <div style=\"font-size:12px; color:#111827; line-height:1.4;\">\n                ${top5.map((r, i) => `${i + 1}. ${r.kabkota} (${r.total})`).join('<br/>') || '-'}\n              </div>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Tabel Rekap</div>\n          <table>\n            <thead>\n              <tr>\n                <th style=\"width:36px;\">No</th>\n                <th>Kab/Kota</th>\n                <th style=\"width:110px;\">Jumlah</th>\n                <th style=\"width:80px;\">Persen</th>\n                <th>Visual</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${rows.map((r, idx) => {\n                const pct = total > 0 ? Math.round((r.total / total) * 1000) / 10 : 0;\n                const rel = Math.round((r.total / max) * 100);\n                const barWidth = 140;\n                const filled = Math.max(1, Math.round((rel / 100) * barWidth));\n                return `\n                  <tr>\n                    <td>${idx + 1}</td>\n                    <td>${r.kabkota}</td>\n                    <td style=\"text-align:right; font-variant-numeric: tabular-nums;\">${r.total}</td>\n                    <td style=\"text-align:right; font-variant-numeric: tabular-nums;\">${pct.toFixed(1)}%</td>\n                    <td>\n                      <svg width=\"${barWidth}\" height=\"10\" viewBox=\"0 0 ${barWidth} 10\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <rect x=\"0\" y=\"0\" width=\"${barWidth}\" height=\"10\" fill=\"#E5F6F1\" stroke=\"#D1D5DB\" />\n                        <rect x=\"0\" y=\"0\" width=\"${filled}\" height=\"10\" fill=\"#10B981\" />\n                      </svg>\n                    </td>\n                  </tr>\n                `;\n              }).join('')}\n            </tbody>\n            <tfoot>\n              <tr>\n                <td colspan=\"2\">Total</td>\n                <td style=\"text-align:right; font-variant-numeric: tabular-nums;\">${total}</td>\n                <td></td>\n                <td></td>\n              </tr>\n            </tfoot>\n          </table>\n\n          <div class=\"note\">Catatan: Laporan ini menampilkan pengajuan yang <strong>telah disetujui Kanwil</strong>.</div>\n\n          <script>\n            window.onload = function() { window.print(); };\n          <\\/script>\n        </body>\n      </html>\n    `);\n    win.document.close();\n  };\n  \n  const handleGenerateDownload = async () => {\n    const hasPegawaiSelection = generateDownloadFilterType === 'pegawai'\n      ? selectedGeneratePegawai.length > 0\n      : !!generateDownloadFilterValue;\n\n    if (!hasPegawaiSelection) {\n      toast({\n        title: 'Error',\n        description: 'Pilih filter terlebih dahulu',\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    // Create AbortController for timeout (5 minutes for ZIP generation)\n    const abortController = new AbortController();\n    const timeoutId = setTimeout(() => abortController.abort(), 5 * 60 * 1000); // 5 minutes timeout\n\n    try {\n      setGeneratingDownload(true);\n      setGenerateDownloadProgress('Sedang memproses data pengajuan dan membuat file ZIP...');\n\n      // Generate file ZIP\n      const baseUrl = (import.meta as any).env?.VITE_API_URL || (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' ? 'http://localhost:3000' : '');\n      const generateUrl = baseUrl ? `${baseUrl}/api/pengajuan/generate-download` : '/api/pengajuan/generate-download';\n      \n      const fetchResponse = await fetch(generateUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          filter_type: generateDownloadFilterType,\n          filter_value: generateDownloadFilterType === 'pegawai'\n            ? selectedGeneratePegawai.map((p) => p.id)\n            : generateDownloadFilterValue\n        }),\n        signal: abortController.signal\n      });\n\n      clearTimeout(timeoutId);\n\n      if (!fetchResponse.ok) {\n        // Handle 502 Bad Gateway specifically\n        if (fetchResponse.status === 502) {\n          throw new Error('Server sedang sibuk atau timeout. Proses generate ZIP memakan waktu terlalu lama. Silakan coba lagi dengan filter yang lebih spesifik atau hubungi administrator.');\n        }\n        \n        const errorData = await fetchResponse.json().catch(() => ({ message: 'Gagal generate download' }));\n        throw new Error(errorData.message || 'Gagal generate download');\n      }\n\n      // Response should be JSON with file_id and download_url\n      const responseData = await fetchResponse.json();\n      \n      if (!responseData.success) {\n        throw new Error(responseData.message || 'Gagal generate download');\n      }\n\n      setGenerateDownloadProgress('File ZIP berhasil di-generate, sedang mengunduh...');\n\n      // Download file using the download_url\n      const fileDownloadUrl = baseUrl \n        ? `${baseUrl}${responseData.data.download_url}` \n        : responseData.data.download_url;\n      \n      const downloadResponse = await fetch(fileDownloadUrl, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (!downloadResponse.ok) {\n        const errorData = await downloadResponse.json().catch(() => ({ message: 'Gagal download file' }));\n        throw new Error(errorData.message || 'Gagal download file');\n      }\n\n      const blob = await downloadResponse.blob();\n      downloadBlob(blob, responseData.data.filename);\n\n      toast({\n        title: 'Berhasil',\n        description: 'File ZIP berhasil di-generate dan di-download',\n      });\n\n      setShowGenerateDownloadDialog(false);\n      setGenerateDownloadFilterValue('');\n      setGenerateDownloadProgress('');\n    } catch (error: any) {\n      clearTimeout(timeoutId);\n      console.error('Error generating download:', error);\n      \n      let errorMsg = formatError(error);\n      \n      // Handle timeout/abort errors\n      if (error.name === 'AbortError' || error.message?.includes('aborted')) {\n        errorMsg = 'Request timeout. Proses generate ZIP memakan waktu terlalu lama. Silakan coba lagi dengan filter yang lebih spesifik atau hubungi administrator.';\n      }\n      \n      // Handle network errors that might indicate server issues\n      if (error.message?.includes('Failed to fetch') || error.message?.includes('NetworkError')) {\n        errorMsg = 'Tidak dapat terhubung ke server. Pastikan koneksi internet stabil atau server sedang dalam maintenance.';\n      }\n      \n      toast({\n        title: 'Error',\n        description: errorMsg,\n        variant: 'destructive',\n      });\n    } finally {\n      setGeneratingDownload(false);\n      setGenerateDownloadProgress('');\n    }\n  };\n\n  // Debug info\n  console.log(' Debug PengajuanIndex:', {\n    userRole: user?.role,\n    isAdmin,\n    userEmail: user?.email\n  });\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      <Card>\n        <CardHeader>\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n              <CardTitle data-tour-id=\"pengajuan-header\" className=\"flex items-center gap-2\">\n                <FileText className=\"h-5 w-5\" />\n                Daftar Pengajuan Mutasi PNS\n              </CardTitle>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                {isAdmin ? 'Semua pengajuan mutasi PNS' : (isReadOnlyUser ? 'Semua pengajuan berstatus final_approved (read-only)' : (isKanwil ? 'Pengajuan mutasi PNS Anda (Kanwil)' : 'Pengajuan mutasi PNS Anda'))}\n              </p>\n            </div>\n            <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 w-full sm:w-auto\">\n              {isReadOnlyUser && (\n                <Button\n                  variant=\"outline\"\n                  onClick={startPengajuanTour}\n                  className=\"w-full sm:w-auto justify-center border-green-200 text-green-700\"\n                >\n                  <HelpCircle className=\"h-4 w-4 mr-2\" />\n                  Mulai Tutorial\n                </Button>\n              )}\n              {isReadOnlyUser && (\n                <>\n                  <Button onClick={exportExcel} className=\"w-full sm:w-auto justify-center bg-green-600 hover:bg-green-700 text-white\">Export Excel</Button>\n                  <Button onClick={exportPDF} className=\"w-full sm:w-auto justify-center bg-blue-600 hover:bg-blue-700 text-white\">Export PDF</Button>\n                </>\n              )}\n              {(isAdmin || isReadOnlyUser) && (\n                <Button\n                  onClick={() => setShowGenerateDownloadDialog(true)}\n                  className=\"w-full sm:w-auto justify-center bg-green-600 hover:bg-green-700 text-white\"\n                >\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  Generate Download\n                </Button>\n              )}\n              {/* Only show Add button for admin and operator, not for user role */}\n              {!isReadOnlyRole && (\n                <Button\n                  onClick={() => navigate('/pengajuan/select')}\n                  className=\"w-full sm:w-auto justify-center bg-green-600 hover:bg-green-700 text-white\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Tambah Pengajuan\n                </Button>\n              )}\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {error && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg\">\n              <p className=\"text-red-600\">{error}</p>\n            </div>\n          )}\n\n          {/* Search and Filter */}\n           <div className=\"flex flex-col gap-4 mb-6\" data-tour-id=\"pengajuan-filter\">\n             {/* Search Bar */}\n             <div className=\"relative flex-1\">\n               <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n               <Input\n                 placeholder=\"Cari berdasarkan nama pegawai, jabatan, atau jenis jabatan...\"\n                 value={searchTerm}\n                 onChange={(e) => handleSearch(e.target.value)}\n                 className=\"pl-10\"\n               />\n             </div>\n             \n             {/* Filter Row */}\n             <div className=\"flex flex-col sm:flex-row gap-4\">\n               <div className=\"flex items-center gap-2\">\n                 <Filter className=\"h-4 w-4 text-gray-400\" />\n                 <Select value={statusFilter} onValueChange={handleStatusFilter}>\n                   <SelectTrigger className=\"w-48\">\n                     <SelectValue placeholder=\"Filter Status\" />\n                   </SelectTrigger>\n                   <SelectContent>\n                     <SelectItem value=\"all\">Semua Status</SelectItem>\n                     {filterOptions.statuses\n                       .filter(status => status.count > 0) // Only show statuses with data\n                       .map((status) => (\n                         <SelectItem key={status.value} value={status.value}>\n                           {status.label} ({status.count})\n                         </SelectItem>\n                       ))}\n                   </SelectContent>\n                 </Select>\n               </div>\n               \n              {/* Filter Jenis Jabatan untuk admin, pengguna tracking, dan admin wilayah */}\n               {(isReadOnlyUser || isAdmin || isAdminWilayah) && (\n                  <div className=\"flex items-center gap-2\">\n                    <Filter className=\"h-4 w-4 text-gray-400\" />\n                    <Select value={jenisJabatanFilter} onValueChange={handleJenisJabatanFilter}>\n                      <SelectTrigger className=\"w-48\" data-tour-id=\"pengajuan-jabatan-filter\">\n                        <SelectValue placeholder=\"Filter Jenis Jabatan\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"all\">Semua Jenis Jabatan</SelectItem>\n                        {filterOptions.jenisJabatan\n                          .filter(jabatan => jabatan.count > 0)\n                          .map((jabatan) => (\n                            <SelectItem key={jabatan.value} value={jabatan.value}>\n                              {jabatan.label} ({jabatan.count})\n                            </SelectItem>\n                          ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                )}\n\n              {/* Filter Pulau/Wilayah untuk admin dan user */}\n              {(isAdmin || isReadOnlyUser) && (\n                <div className=\"flex items-center gap-2\">\n                  <Filter className=\"h-4 w-4 text-gray-400\" />\n                  <Select value={kabupatenGroupFilter} onValueChange={handleKabupatenGroupFilter}>\n                    <SelectTrigger className=\"w-48\">\n                      <SelectValue placeholder=\"Filter Pulau/Wilayah\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">Semua Pulau/Wilayah</SelectItem>\n                      {filterOptions.kabupatenGroups && filterOptions.kabupatenGroups.length > 0 ? (\n                        filterOptions.kabupatenGroups\n                          .filter(group => group.count > 0 || group.groupName === 'Sumbawa')\n                          .map((group) => (\n                            <SelectItem key={group.groupName} value={group.groupName}>\n                              {group.groupName} ({group.count})\n                            </SelectItem>\n                          ))\n                      ) : (\n                        <SelectItem value=\"all\" disabled>Memuat data...</SelectItem>\n                      )}\n                    </SelectContent>\n                  </Select>\n                </div>\n              )}\n\n                               {/* Admin Only Filters */}\n                {isAdmin && (\n                  <div className=\"flex items-center gap-2\">\n                    <Filter className=\"h-4 w-4 text-gray-400\" />\n                    <Select value={createdByFilter} onValueChange={handleCreatedByFilter}>\n                      <SelectTrigger className=\"w-48\">\n                        <SelectValue placeholder=\"Filter Pembuat\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"all\">Semua Pembuat</SelectItem>\n                        {filterOptions.users.map((user) => (\n                          <SelectItem key={user.id} value={user.id}>\n                            {user.full_name || user.email || 'Unknown User'}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                )}\n             </div>\n           </div>\n\n          {/* Grouped view for admin and read-only user */}\n          {isGroupingRole && Object.keys(clientGroupedByKabkota).length > 0 ? (\n            <div className=\"space-y-4\">\n              <div className=\"text-sm text-gray-600\">Tergabung berdasarkan kabupaten/kota</div>\n              <Accordion type=\"multiple\" className=\"w-full\" data-tour-id=\"pengajuan-accordion\">\n                {Object.entries(clientGroupedByKabkota).map(([kab, items]) => (\n                  <AccordionItem key={kab} value={kab} className=\"border rounded-lg\">\n                    <AccordionTrigger className=\"px-4 py-3 hover:no-underline\">\n                      <div className=\"flex items-center justify-between w-full\">\n                        <div className=\"font-medium\">{kab}</div>\n                        <Badge variant=\"secondary\" className=\"ml-2\">{items.length}</Badge>\n                      </div>\n                    </AccordionTrigger>\n                    <AccordionContent className=\"px-0\">\n                      <div className=\"border-t\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Pegawai</TableHead>\n                              <TableHead>Jenis Jabatan</TableHead>\n                              <TableHead>Status</TableHead>\n                              <TableHead>Jumlah Dokumen</TableHead>\n                              {isAdmin && <TableHead>Pembuat</TableHead>}\n                              <TableHead>Tanggal Dibuat</TableHead>\n                              <TableHead className=\"text-right\">Aksi</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {items.map((pengajuan) => (\n                              <TableRow key={pengajuan.id} className=\"hover:bg-gray-50\">\n                                <TableCell>\n                                  <div>\n                                    <div className=\"font-medium\">{pengajuan.pegawai.nama}</div>\n                                    <div className=\"text-sm text-gray-500\">{pengajuan.pegawai.jabatan}</div>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  <Badge variant=\"outline\">{getJabatanDisplayName(pengajuan.jenis_jabatan)}</Badge>\n                                </TableCell>\n                                <TableCell>{getStatusBadge(pengajuan.status, pengajuan)}</TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <span className=\"text-sm\">{pengajuan.files.length}</span>\n                                  </div>\n                                </TableCell>\n                                {isAdmin && (\n                                  <TableCell>\n                                    <div className=\"text-sm text-gray-600\">\n                                      {(() => {\n                                        const u = filterOptions.users.find(u => u.id === pengajuan.created_by);\n                                        if (u) return u.full_name || u.email || 'Unknown User';\n                                        return pengajuan.created_by?.includes('@') ? pengajuan.created_by : 'Unknown User';\n                                      })()}\n                                    </div>\n                                  </TableCell>\n                                )}\n                                <TableCell>\n                                  <div className=\"text-sm text-gray-600\">{formatDate(pengajuan.created_at)}</div>\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  <DropdownMenu>\n                                    <DropdownMenuTrigger asChild>\n                                      <Button variant=\"ghost\" size=\"sm\" data-tour-id=\"pengajuan-row-action\">\n                                        <MoreHorizontal className=\"h-4 w-4\" />\n                                      </Button>\n                                    </DropdownMenuTrigger>\n                                    <DropdownMenuContent align=\"end\">\n                                      <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                        <Eye className=\"h-4 w-4 mr-2\" />\n                                        Lihat Detail\n                                      </DropdownMenuItem>\n                                      {/* Ubah Status - hanya untuk admin */}\n                                      {isAdmin && (\n                                        <DropdownMenuItem \n                                          onClick={() => {\n                                            setSelectedPengajuan(pengajuan);\n                                            setNewStatus(pengajuan.status);\n                                            setStatusChangeReason('');\n                                            setShowUpdateStatusDialog(true);\n                                          }}\n                                        >\n                                          <Settings className=\"h-4 w-4 mr-2\" />\n                                          Ubah Status\n                                        </DropdownMenuItem>\n                                      )}\n                                      {isAdmin && pengajuan.status === 'admin_wilayah_submitted' && (\n                                        <>\n                                          <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                            <CheckCircle className=\"h-4 w-4 mr-2\" />\n                                            Setujui\n                                          </DropdownMenuItem>\n                                          <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                            <XCircle className=\"h-4 w-4 mr-2\" />\n                                            Tolak\n                                          </DropdownMenuItem>\n                                        </>\n                                      )}\n                                      {isAdmin && (\n                                        <DropdownMenuItem \n                                          onClick={() => {\n                                            setPengajuanToDelete(pengajuan.id);\n                                            setDeleteDialogOpen(true);\n                                          }}\n                                          className=\"text-red-600\"\n                                        >\n                                          <Trash2 className=\"h-4 w-4 mr-2\" />\n                                          Hapus\n                                        </DropdownMenuItem>\n                                      )}\n                                    </DropdownMenuContent>\n                                  </DropdownMenu>\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </AccordionContent>\n                  </AccordionItem>\n                ))}\n              </Accordion>\n              {/* Pagination for admin grouped view */}\n              {totalPages > 1 && (\n                <div className=\"flex items-center justify-between px-4 py-3 border rounded-lg bg-gray-50\">\n                  <div className=\"text-sm text-gray-700\">\n                    Menampilkan {((currentPage - 1) * itemsPerPage) + 1} sampai {Math.min(currentPage * itemsPerPage, totalItems)} dari {totalItems} pengajuan\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setCurrentPage(currentPage - 1)}\n                      disabled={currentPage === 1}\n                    >\n                      <ChevronLeft className=\"h-4 w-4\" />\n                      Sebelumnya\n                    </Button>\n                    <div className=\"flex items-center gap-1\">\n                      {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n                        <Button\n                          key={page}\n                          variant={currentPage === page ? \"default\" : \"outline\"}\n                          size=\"sm\"\n                          onClick={() => setCurrentPage(page)}\n                          className={`w-8 h-8 p-0 ${\n                            currentPage === page \n                              ? \"bg-green-600 hover:bg-green-700 text-white border-green-600\" \n                              : \"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300\"\n                          }`}\n                        >\n                          {page}\n                        </Button>\n                      ))}\n                    </div>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setCurrentPage(currentPage + 1)}\n                      disabled={currentPage === totalPages}\n                    >\n                      Selanjutnya\n                      <ChevronRight className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n          /* Table */\n          <div className=\"border rounded-lg overflow-hidden\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"h-8 w-8 animate-spin mr-2 text-green-600\" />\n                <span>Memuat data pengajuan...</span>\n              </div>\n            ) : pengajuanList.length === 0 && totalItems === 0 ? (\n              <div className=\"text-center py-12\">\n                <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-500 mb-2\">\n                  {searchTerm || statusFilter !== 'all' \n                    ? 'Tidak ada pengajuan yang sesuai dengan filter'\n                    : 'Belum ada pengajuan'\n                  }\n                </p>\n                {!searchTerm && statusFilter === 'all' && user?.role !== 'user' && (\n                  <Button\n                    onClick={() => navigate('/pengajuan/select')}\n                    className=\"bg-green-600 hover:bg-green-700 text-white\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Buat Pengajuan Pertama\n                  </Button>\n                )}\n              </div>\n            ) : pengajuanList.length === 0 && totalItems > 0 ? (\n              <>\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Pegawai</TableHead>\n                      <TableHead>Jenis Jabatan</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Jumlah Dokumen</TableHead>\n                      <TableHead>Tanggal Dibuat</TableHead>\n                      <TableHead>Aksi</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    <TableRow>\n                      <TableCell colSpan={6} className=\"text-center py-8 text-gray-500\">\n                        Tidak ada data di halaman ini\n                      </TableCell>\n                    </TableRow>\n                  </TableBody>\n                </Table>\n\n\n                {/* Pagination Info - Always show for debugging */}\n                <div className=\"flex items-center justify-between px-4 py-3 border-t bg-gray-50\">\n                  <div className=\"text-sm text-gray-700\">\n                    Menampilkan {((currentPage - 1) * itemsPerPage) + 1} sampai {Math.min(currentPage * itemsPerPage, totalItems)} dari {totalItems} pengajuan\n                  </div>\n                  {true && ( // Always show for debugging - change back to (totalPages > 1 || totalItems > itemsPerPage) later\n                    <div className=\"flex items-center gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(currentPage - 1)}\n                        disabled={currentPage === 1}\n                      >\n                        <ChevronLeft className=\"h-4 w-4\" />\n                        Sebelumnya\n                      </Button>\n                      \n                      <div className=\"flex items-center gap-1\">\n                        {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n                          <Button\n                            key={page}\n                            variant={currentPage === page ? \"default\" : \"outline\"}\n                            size=\"sm\"\n                            onClick={() => setCurrentPage(page)}\n                            className={`w-8 h-8 p-0 ${\n                              currentPage === page \n                                ? \"bg-green-600 hover:bg-green-700 text-white border-green-600\" \n                                : \"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300\"\n                            }`}\n                          >\n                            {page}\n                          </Button>\n                        ))}\n                      </div>\n                      \n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(currentPage + 1)}\n                        disabled={currentPage === totalPages}\n                      >\n                        Selanjutnya\n                        <ChevronRight className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </>\n            ) : (\n              <>\n                <Table>\n                   <TableHeader>\n                     <TableRow>\n                       <TableHead>Pegawai</TableHead>\n                       <TableHead>Jenis Jabatan</TableHead>\n                       <TableHead>Status</TableHead>\n                       <TableHead>Dokumen</TableHead>\n                       {isAdmin && <TableHead>Pembuat</TableHead>}\n                       <TableHead>Tanggal Dibuat</TableHead>\n                       <TableHead className=\"text-right\">Aksi</TableHead>\n                     </TableRow>\n                   </TableHeader>\n                  <TableBody>\n                    {pengajuanList.map((pengajuan) => (\n                      <TableRow key={pengajuan.id} className=\"hover:bg-gray-50\">\n                        <TableCell>\n                          <div>\n                            <div className=\"font-medium\">{pengajuan.pegawai.nama}</div>\n                            <div className=\"text-sm text-gray-500\">{pengajuan.pegawai.jabatan}</div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">\n                            {getJabatanDisplayName(pengajuan.jenis_jabatan)}\n                          </Badge>\n                        </TableCell>\n                                                 <TableCell>\n                           {getStatusBadge(pengajuan.status, pengajuan)}\n                         </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-sm\">{pengajuan.files.length}</span>\n                          </div>\n                        </TableCell>\n                                                   {isAdmin && (\n                            <TableCell>\n                              <div className=\"text-sm text-gray-600\">\n                                {(() => {\n                                  const user = filterOptions.users.find(u => u.id === pengajuan.created_by);\n                                  if (user) {\n                                    // Prioritaskan full_name, jika tidak ada gunakan email\n                                    return user.full_name || user.email || 'Unknown User';\n                                  }\n                                  // Jika user tidak ditemukan, tampilkan email dari created_by (jika itu email)\n                                  return pengajuan.created_by?.includes('@') ? pengajuan.created_by : 'Unknown User';\n                                })()}\n                              </div>\n                            </TableCell>\n                          )}\n                         <TableCell>\n                           <div className=\"text-sm text-gray-600\">\n                             {formatDate(pengajuan.created_at)}\n                           </div>\n                         </TableCell>\n                        <TableCell className=\"text-right\">\n                          <DropdownMenu>\n                            <DropdownMenuTrigger asChild>\n                              <Button variant=\"ghost\" size=\"sm\">\n                                <MoreHorizontal className=\"h-4 w-4\" />\n                              </Button>\n                            </DropdownMenuTrigger>\n                            <DropdownMenuContent align=\"end\">\n                              <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                <Eye className=\"h-4 w-4 mr-2\" />\n                                Lihat Detail\n                              </DropdownMenuItem>\n                              {/* Only show edit actions for admin and operator, not for user role */}\n                              {!isReadOnlyRole && (\n                                <>\n                                  {pengajuan.status === 'draft' && (\n                                    <DropdownMenuItem onClick={() => navigate(`/pengajuan/${pengajuan.id}/upload`)}>\n                                      <Edit className=\"h-4 w-4 mr-2\" />\n                                      Upload Dokumen\n                                    </DropdownMenuItem>\n                                  )}\n                                  {pengajuan.status === 'rejected' && (\n                                    <DropdownMenuItem onClick={() => navigate(`/pengajuan/${pengajuan.id}/edit`)}>\n                                      <Edit className=\"h-4 w-4 mr-2\" />\n                                      Perbaiki Dokumen\n                                    </DropdownMenuItem>\n                                  )}\n                                </>\n                              )}\n                              {/* Ubah Status - hanya untuk admin */}\n                              {isAdmin && (\n                                <DropdownMenuItem \n                                  onClick={() => {\n                                    setSelectedPengajuan(pengajuan);\n                                    setNewStatus(pengajuan.status);\n                                    setStatusChangeReason('');\n                                    setShowUpdateStatusDialog(true);\n                                  }}\n                                >\n                                  <Settings className=\"h-4 w-4 mr-2\" />\n                                  Ubah Status\n                                </DropdownMenuItem>\n                              )}\n                               {isAdmin && pengajuan.status === 'admin_wilayah_submitted' && (\n                                 <>\n                                   <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                     <CheckCircle className=\"h-4 w-4 mr-2\" />\n                                     Setujui\n                                   </DropdownMenuItem>\n                                   <DropdownMenuItem onClick={() => navigateToDetail(pengajuan.id)}>\n                                     <XCircle className=\"h-4 w-4 mr-2\" />\n                                     Tolak\n                                   </DropdownMenuItem>\n                                 </>\n                               )}\n                                                                                          {/* Only show delete for admin and operator, not for user role */}\n                              {(isAdmin || (pengajuan.status === 'draft' && user?.role !== 'user')) && (\n                                <DropdownMenuItem \n                                  onClick={() => {\n                                    console.log(' Debug: Klik hapus untuk pengajuan:', {\n                                      id: pengajuan.id,\n                                      status: pengajuan.status,\n                                      isAdmin,\n                                      userRole: user?.role\n                                    });\n                                    setPengajuanToDelete(pengajuan.id);\n                                    setDeleteDialogOpen(true);\n                                  }}\n                                  className=\"text-red-600\"\n                                >\n                                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                                  Hapus\n                                </DropdownMenuItem>\n                              )}\n                             \n                            </DropdownMenuContent>\n                          </DropdownMenu>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n\n\n                {/* Pagination Info - Always show for debugging */}\n                <div className=\"flex items-center justify-between px-4 py-3 border-t bg-gray-50\">\n                  <div className=\"text-sm text-gray-700\">\n                    Menampilkan {((currentPage - 1) * itemsPerPage) + 1} sampai {Math.min(currentPage * itemsPerPage, totalItems)} dari {totalItems} pengajuan\n                  </div>\n                  {true && ( // Always show for debugging - change back to (totalPages > 1 || totalItems > itemsPerPage) later\n                    <div className=\"flex items-center gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(currentPage - 1)}\n                        disabled={currentPage === 1}\n                      >\n                        <ChevronLeft className=\"h-4 w-4\" />\n                        Sebelumnya\n                      </Button>\n                      \n                      <div className=\"flex items-center gap-1\">\n                        {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n                          <Button\n                            key={page}\n                            variant={currentPage === page ? \"default\" : \"outline\"}\n                            size=\"sm\"\n                            onClick={() => setCurrentPage(page)}\n                            className={`w-8 h-8 p-0 ${\n                              currentPage === page \n                                ? \"bg-green-600 hover:bg-green-700 text-white border-green-600\" \n                                : \"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300\"\n                            }`}\n                          >\n                            {page}\n                          </Button>\n                        ))}\n                      </div>\n                      \n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(currentPage + 1)}\n                        disabled={currentPage === totalPages}\n                      >\n                        Selanjutnya\n                        <ChevronRight className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Update Status Dialog */}\n      <Dialog open={showUpdateStatusDialog} onOpenChange={setShowUpdateStatusDialog}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Ubah Status Pengajuan</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"status\">Status Saat Ini</Label>\n              <div className=\"mt-1 p-2 bg-gray-50 rounded-md\">\n                {selectedPengajuan && getStatusBadge(selectedPengajuan.status, selectedPengajuan)}\n              </div>\n            </div>\n            <div>\n              <Label htmlFor=\"newStatus\">Status Baru</Label>\n              <select\n                id=\"newStatus\"\n                value={newStatus}\n                onChange={(e) => setNewStatus(e.target.value)}\n                className=\"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500\"\n              >\n                <option value=\"draft\">Draft</option>\n                <option value=\"submitted\">Submitted</option>\n                <option value=\"approved\">Approved</option>\n                <option value=\"rejected\">Ditolak Admin Wilayah</option>\n                <option value=\"resubmitted\">Resubmitted</option>\n                <option value=\"admin_wilayah_approved\">Admin Wilayah Approved</option>\n                <option value=\"admin_wilayah_rejected\">Ditolak Superadmin</option>\n                <option value=\"admin_wilayah_submitted\">Admin Wilayah Submitted</option>\n                <option value=\"final_approved\">Final Approved</option>\n                <option value=\"final_rejected\">Final Rejected</option>\n              </select>\n            </div>\n            <div>\n              <Label htmlFor=\"reason\">Alasan Perubahan (Opsional)</Label>\n              <Textarea\n                id=\"reason\"\n                value={statusChangeReason}\n                onChange={(e) => setStatusChangeReason(e.target.value)}\n                placeholder=\"Masukkan alasan perubahan status...\"\n                className=\"mt-1\"\n                rows={3}\n              />\n            </div>\n          </div>\n          <div className=\"flex justify-end gap-2 mt-4\">\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setShowUpdateStatusDialog(false);\n                setSelectedPengajuan(null);\n                setNewStatus('');\n                setStatusChangeReason('');\n              }}\n            >\n              Batal\n            </Button>\n            <Button\n              onClick={handleUpdateStatus}\n              disabled={updatingStatus || !newStatus || (selectedPengajuan && newStatus === selectedPengajuan.status)}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              {updatingStatus ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                  Memproses...\n                </>\n              ) : (\n                'Ubah Status'\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Hapus Pengajuan</AlertDialogTitle>\n            <AlertDialogDescription>\n              Apakah Anda yakin ingin menghapus pengajuan ini? Tindakan ini tidak dapat dibatalkan.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel disabled={deleting}>Batal</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleDelete}\n              disabled={deleting}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              {deleting ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin text-green-600\" />\n                  Menghapus...\n                </>\n              ) : (\n                'Hapus'\n              )}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Generate Download Dialog */}\n      <Dialog open={showGenerateDownloadDialog} onOpenChange={setShowGenerateDownloadDialog}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Generate Download ZIP</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"filterType\">Filter By</Label>\n              <Select\n                value={generateDownloadFilterType}\n                onValueChange={(value: 'jabatan' | 'kabupaten' | 'pegawai') => {\n                  setGenerateDownloadFilterType(value);\n                  setGenerateDownloadFilterValue(value === 'pegawai' ? [] : '');\n                  setSelectedGeneratePegawai([]);\n                  setGeneratePegawaiSearch('');\n                }}\n              >\n                <SelectTrigger className=\"mt-1\">\n                  <SelectValue placeholder=\"Pilih filter\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"jabatan\">By Jabatan</SelectItem>\n                  <SelectItem value=\"kabupaten\">By Kabupaten</SelectItem>\n                  <SelectItem value=\"pegawai\">By Pegawai</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <Label htmlFor=\"filterValue\">\n                {generateDownloadFilterType === 'jabatan'\n                  ? 'Pilih Jabatan'\n                  : generateDownloadFilterType === 'kabupaten'\n                    ? 'Pilih Kabupaten'\n                    : 'Pilih Pegawai'}\n              </Label>\n              {generateDownloadFilterType === 'jabatan' ? (\n                <Select\n                  value={typeof generateDownloadFilterValue === 'string' ? generateDownloadFilterValue : ''}\n                  onValueChange={setGenerateDownloadFilterValue}\n                >\n                  <SelectTrigger className=\"mt-1\">\n                    <SelectValue placeholder=\"Pilih jabatan\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {generateOptionsLoading && (\n                      <SelectItem value=\"__loading_jabatan\" disabled>Memuat data...</SelectItem>\n                    )}\n                    {!generateOptionsLoading && generateFilterOptions.jenisJabatan.length === 0 && (\n                      <SelectItem value=\"__empty_jabatan\" disabled>Data tidak tersedia</SelectItem>\n                    )}\n                    {!generateOptionsLoading && generateFilterOptions.jenisJabatan.length > 0 && (\n                      generateFilterOptions.jenisJabatan\n                        .filter(jabatan => jabatan.count > 0)\n                        .map((jabatan) => (\n                          <SelectItem key={jabatan.value} value={jabatan.value}>\n                            {jabatan.label} ({jabatan.count})\n                          </SelectItem>\n                        ))\n                    )}\n                  </SelectContent>\n                </Select>\n              ) : generateDownloadFilterType === 'kabupaten' ? (\n                <Select\n                  value={typeof generateDownloadFilterValue === 'string' ? generateDownloadFilterValue : ''}\n                  onValueChange={setGenerateDownloadFilterValue}\n                >\n                  <SelectTrigger className=\"mt-1\">\n                    <SelectValue placeholder=\"Pilih kabupaten\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {generateOptionsLoading && (\n                      <SelectItem value=\"__loading_kabupaten\" disabled>Memuat data...</SelectItem>\n                    )}\n                    {!generateOptionsLoading && (!generateFilterOptions.kabupatenGroups || generateFilterOptions.kabupatenGroups.length === 0) && (\n                      <SelectItem value=\"__empty_kabupaten\" disabled>Data tidak tersedia</SelectItem>\n                    )}\n                    {!generateOptionsLoading && generateFilterOptions.kabupatenGroups && generateFilterOptions.kabupatenGroups.length > 0 && (\n                      (() => {\n                        const allKabupaten = generateFilterOptions.kabupatenGroups\n                          .filter(group => group.count > 0 && group.kabupaten && group.kabupaten.length > 0)\n                          .flatMap(group => group.kabupaten)\n                          .filter((kab, index, self) => self.indexOf(kab) === index)\n                          .sort();\n                        return allKabupaten.length > 0 ? (\n                          allKabupaten.map((kab) => (\n                            <SelectItem key={kab} value={kab}>\n                              {kab}\n                            </SelectItem>\n                          ))\n                        ) : (\n                          <SelectItem value=\"\" disabled>Tidak ada data kabupaten</SelectItem>\n                        );\n                      })()\n                    )}\n                  </SelectContent>\n                </Select>\n              ) : (\n                <div className=\"space-y-2 relative\">\n                  <Input\n                    placeholder=\"Cari pegawai (nama/NIP)...\"\n                    value={generatePegawaiSearch}\n                    onChange={(e) => {\n                      setGeneratePegawaiSearch(e.target.value);\n                      setShowPegawaiSuggestions(true);\n                    }}\n                    onFocus={() => setShowPegawaiSuggestions(true)}\n                  />\n                  <div className=\"text-xs text-gray-500 flex items-center justify-between\">\n                    <span>Ketik untuk tambah pegawai lain (maks 20).</span>\n                    <span>{selectedGeneratePegawai.length}/20</span>\n                  </div>\n                  {selectedGeneratePegawai.length > 0 && (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {selectedGeneratePegawai.map((p) => (\n                        <Badge\n                          key={p.id}\n                          variant=\"secondary\"\n                          className=\"flex items-center gap-1\"\n                        >\n                          {p.label}\n                          <button\n                            type=\"button\"\n                            className=\"text-gray-600 hover:text-red-600\"\n                            onClick={() => handleRemoveGeneratePegawai(p.id)}\n                          >\n                            ×\n                          </button>\n                        </Badge>\n                      ))}\n                    </div>\n                  )}\n                  {generateOptionsLoading && (\n                    <div className=\"text-sm text-gray-500\">Memuat data...</div>\n                  )}\n                  {!generateOptionsLoading && showPegawaiSuggestions && (\n                    <div className=\"absolute z-20 mt-1 w-full max-h-56 overflow-auto rounded-md border bg-white shadow\">\n                      {filteredGeneratePegawaiOptions.length === 0 ? (\n                        <div className=\"px-3 py-2 text-sm text-gray-500\">Tidak ada hasil</div>\n                      ) : (\n                        filteredGeneratePegawaiOptions.slice(0, 20).map((pegawai) => {\n                          const label = `${pegawai.nama}${pegawai.nip ? ` • ${pegawai.nip}` : ''}`;\n                          return (\n                            <button\n                              type=\"button\"\n                              key={pegawai.id || pegawai.nip}\n                              className=\"w-full px-3 py-2 text-left hover:bg-green-50 text-sm\"\n                              onMouseDown={(e) => e.preventDefault()}\n                              onClick={() => handleSelectGeneratePegawai(pegawai.id || pegawai.nip || '', label)}\n                            >\n                              {label}\n                            </button>\n                          );\n                        })\n                      )}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n            {generateDownloadProgress && (\n              <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-md\">\n                <div className=\"flex items-center gap-2\">\n                  <Loader2 className=\"h-4 w-4 animate-spin text-blue-600\" />\n                  <p className=\"text-sm text-blue-800\">{generateDownloadProgress}</p>\n                </div>\n              </div>\n            )}\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-md p-3\">\n              <p className=\"text-sm text-yellow-800\">\n                <strong>Catatan:</strong>{' '}\n                {isReadOnlyUser ? (\n                  <>\n                    Proses generate download mungkin memakan waktu beberapa menit jika data banyak. File ZIP{' '}\n                    <strong>khusus berisi pengajuan dengan status final_approved</strong> sesuai filter yang dipilih untuk\n                    role user (read-only).\n                  </>\n                ) : (\n                  <>\n                    Proses generate download mungkin memakan waktu beberapa menit jika data banyak. File ZIP akan berisi\n                    semua berkas dari pengajuan dengan status <strong>final_approved</strong> sesuai filter yang dipilih.\n                  </>\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex justify-end gap-2 mt-4\">\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setShowGenerateDownloadDialog(false);\n                setGenerateDownloadFilterValue('');\n                setGenerateDownloadProgress('');\n                setGeneratePegawaiSearch('');\n                setShowPegawaiSuggestions(false);\n                setSelectedGeneratePegawai([]);\n              }}\n              disabled={generatingDownload}\n            >\n              Batal\n            </Button>\n            <Button\n              onClick={handleGenerateDownload}\n              disabled={\n                generatingDownload || \n                (generateDownloadFilterType === 'pegawai'\n                  ? selectedGeneratePegawai.length === 0\n                  : !generateDownloadFilterValue)\n              }\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n              onMouseEnter={() => setShowPegawaiSuggestions(false)}\n            >\n              {generatingDownload ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                  Generating...\n                </>\n              ) : (\n                <>\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  Generate ZIP\n                </>\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default PengajuanIndex;\n"],"names":["PengajuanIndex","navigate","useNavigate","searchParams","setSearchParams","useSearchParams","user","token","isAuthenticated","useAuth","toast","useToast","pengajuanList","setPengajuanList","useState","loading","setLoading","error","setError","getInitialFilter","key","defaultValue","urlValue","stored","searchTerm","setSearchTerm","statusFilter","setStatusFilter","createdByFilter","setCreatedByFilter","jenisJabatanFilter","setJenisJabatanFilter","currentPage","setCurrentPage","page","totalPages","setTotalPages","totalItems","setTotalItems","deleteDialogOpen","setDeleteDialogOpen","pengajuanToDelete","setPengajuanToDelete","deleting","setDeleting","showUpdateStatusDialog","setShowUpdateStatusDialog","selectedPengajuan","setSelectedPengajuan","newStatus","setNewStatus","statusChangeReason","setStatusChangeReason","updatingStatus","setUpdatingStatus","filterOptions","setFilterOptions","kabupatenGroupFilter","setKabupatenGroupFilter","groupedByKabkota","setGroupedByKabkota","pengajuanTourRef","useRef","showGenerateDownloadDialog","setShowGenerateDownloadDialog","generateDownloadFilterType","setGenerateDownloadFilterType","generateDownloadFilterValue","setGenerateDownloadFilterValue","generatingDownload","setGeneratingDownload","generateDownloadProgress","setGenerateDownloadProgress","generateFilterOptions","setGenerateFilterOptions","generateOptionsLoading","setGenerateOptionsLoading","generatePegawaiSearch","setGeneratePegawaiSearch","showPegawaiSuggestions","setShowPegawaiSuggestions","selectedGeneratePegawai","setSelectedGeneratePegawai","itemsPerPage","isAdmin","isReadOnlyUser","isBimas","isKanwil","isAdminWilayah","isReadOnlyRole","isGroupingRole","clientGroupedByKabkota","React","clientGrouped","acc","item","kab","_a","startPengajuanTour","useCallback","list","firstAccordionTrigger","tour","Shepherd","buildButtons","options","buttons","useEffect","params","fetchPengajuanData","fetchFilterOptions","fetchGenerateFilterOptions","response","apiGet","jenisJabatan","kabupatenGroups","pegawai","grouped","totalPagesValue","_b","totalItemsValue","_c","errorMsg","formatError","queryString","url","handleSearch","value","handleStatusFilter","handleCreatedByFilter","handleJenisJabatanFilter","handleKabupatenGroupFilter","filteredGeneratePegawaiOptions","useMemo","q","p","handleSelectGeneratePegawai","pegawaiId","label","next","handleRemoveGeneratePegawai","navigateToDetail","pengajuanId","handleDelete","apiDelete","handleUpdateStatus","apiPut","getStatusBadge","status","pengajuan","isSubmittedAfterAdminWilayah","f","config","Clock","FileText","CheckCircle","XCircle","Icon","Badge","jsx","getJabatanDisplayName","formatDate","dateString","buildRekapPerKabkota","source","items","downloadBlob","blob","filename","a","exportExcel","rows","today","tableHtml","r","exportPDF","b","total","max","kabCount","now","dateStr","createdBy","top5","win","i","idx","pct","rel","barWidth","filled","handleGenerateDownload","abortController","timeoutId","baseUrl","__vite_import_meta_env__","generateUrl","fetchResponse","errorData","responseData","fileDownloadUrl","downloadResponse","jsxs","Card","CardHeader","CardTitle","Button","HelpCircle","Fragment","Download","Plus","CardContent","Search","Input","e","Filter","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","jabatan","group","Accordion","AccordionItem","AccordionTrigger","AccordionContent","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","u","DropdownMenu","DropdownMenuTrigger","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","Eye","Settings","Trash2","ChevronLeft","_","ChevronRight","Loader2","Edit","Dialog","DialogContent","DialogHeader","DialogTitle","Label","Textarea","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","allKabupaten","index","self"],"mappings":"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"}