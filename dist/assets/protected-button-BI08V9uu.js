import{r as l,c as d}from"./react-vendor-B0B9C2fS.js";import{j as f,aa as v}from"./ui-vendor-C6CR1JGj.js";import{B,x as D}from"./index-Bl8eCSPV.js";function k(a={}){const{delay:e=1e3,showWarning:i=!0,warningMessage:c="Tunggu sebentar, proses sedang berjalan..."}=a,[t,s]=l.useState(!1),n=l.useRef(0),r=l.useRef(null),o=l.useCallback(()=>{s(!1),n.current=0,r.current&&(clearTimeout(r.current),r.current=null)},[]),p=l.useCallback(async w=>{const m=Date.now(),u=m-n.current;if(!(t||u<e&&u>0)){s(!0),n.current=m;try{await w()}catch(g){throw o(),g}finally{r.current=setTimeout(()=>{s(!1)},e)}}},[t,e,i,c,o]),x=l.useCallback(w=>{const m=Date.now(),u=m-n.current;if(!(t||u<e&&u>0)){s(!0),n.current=m;try{w()}catch(g){throw o(),g}finally{r.current=setTimeout(()=>{s(!1)},e)}}},[t,e,i,c,o]);return{isProcessing:t,execute:p,executeSync:x,reset:o}}function S(a={}){const e=k({delay:2e3,showWarning:!0,warningMessage:"Form sedang diproses, tunggu sebentar...",...a}),i=l.useCallback(async(c,t,s)=>{try{await e.execute(c),t==null||t()}catch(n){s==null||s(n)}},[e]);return{isSubmitting:e.isProcessing,submitForm:i,resetSubmission:e.reset}}function W(a={}){const e=k({delay:1e3,showWarning:!0,warningMessage:"Penyimpanan sedang diproses, tunggu sebentar...",...a}),i=l.useCallback(async(c,t,s)=>{try{await e.execute(c),t==null||t()}catch(n){s==null||s(n)}},[e]);return{isSaving:e.isProcessing,saveData:i,resetSave:e.reset}}const P=({onClick:a,isProcessing:e=!1,processingText:i="Memproses...",processingIcon:c,protectionDelay:t=1e3,showProcessingState:s=!0,onSuccess:n,onError:r,children:o,className:p,disabled:x,...w})=>{const[m,u]=d.useState(!1),[g,T]=d.useState(0),y=d.useRef(null),b=e||m,j=d.useCallback(async()=>{if(!a)return;const h=Date.now(),C=h-g;if(!(b||C<t&&C>0)){u(!0),T(h);try{await a(),n==null||n()}catch(M){r==null||r(M)}finally{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{u(!1)},t)}}},[a,b,g,t,n,r]);d.useEffect(()=>()=>{y.current&&clearTimeout(y.current)},[]);const R=f.jsx(v,{className:"h-4 w-4 animate-spin text-green-600"});return f.jsx(B,{...w,onClick:j,disabled:x||b,className:D("transition-all duration-200",b&&"cursor-not-allowed",p),children:b&&s?f.jsxs(f.Fragment,{children:[c||R,i]}):o})},N=a=>f.jsx(P,{...a,processingText:"Menyimpan...",protectionDelay:2e3}),A=a=>f.jsx(P,{...a,processingText:"Menyimpan...",protectionDelay:1e3});export{N as S,W as a,A as b,S as u};
