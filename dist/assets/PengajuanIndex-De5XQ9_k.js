import{j as e,a0 as E,ao as he,V as Ve,aO as me,aP as xe,aD as ge,_ as M,aE as R,aq as ue,aM as q,k as Y,W as je,ap as pe,ad as be}from"./ui-vendor-BCnv6AUJ.js";import{d as Ge,r as o,c as We}from"./react-vendor-C8WR5ETM.js";import{C as qe,a as Ye,b as Xe,c as Qe}from"./card-BdJnS6vC.js";import{u as Ze,a as fe,B as m,I as ea,b as K,q as ye,r as ve,s as we,v,m as aa}from"./index-C-x3Fahl.js";import{S as ke,a as Ne,b as De,c as Se,d as w}from"./select-eHwm0208.js";import{T as X,a as Q,b as _,c as r,d as Z,e as x}from"./table-oFnwtDne.js";import{A as ta,a as sa,b as na,c as la}from"./accordion-CJOy55u7.js";import{A as ia,a as ra,b as da,c as ca,d as oa,e as ha,g as ma,f as xa}from"./alert-dialog-B909EuPy.js";const wa=()=>{const j=Ge(),{user:n,token:O,isAuthenticated:I}=Ze(),[p,Pe]=o.useState([]),[Ce,ee]=o.useState(!0),[ae,L]=o.useState(null),[P,Te]=o.useState(""),[k,te]=o.useState("all"),[$,_e]=o.useState("all"),[l,b]=o.useState(1),[y,$e]=o.useState(1),[f,Ae]=o.useState(0),[Fe,z]=o.useState(!1),[se,H]=o.useState(null),[J,ne]=o.useState(!1),[V,Me]=o.useState({users:[]}),[G,le]=o.useState({}),g=10,c=(n==null?void 0:n.role)==="admin",C=(n==null?void 0:n.role)==="user",W=c||C,U=We.useMemo(()=>W?Object.keys(G).length>0?G:!p||p.length===0?{}:p.reduce((a,s)=>{var i;const t=s.office&&(s.office.kabkota||s.office.name)||s.pegawai&&s.pegawai.induk_unit||((i=s.pegawai)==null?void 0:i.unit_kerja)||"Lainnya";return a[t]||(a[t]=[]),a[t].push(s),a},{}):{},[W,G,p]);o.useEffect(()=>{if(!I){j("/");return}C&&k!=="final_approved"&&te("final_approved"),ie()},[I,j,l,k,$,C]),o.useEffect(()=>{I&&c&&Re()},[I,c]),o.useEffect(()=>{console.log("🔍 Debug State Change - Pagination values updated:",{totalPages:y,totalItems:f,currentPage:l,itemsPerPage:g,pengajuanListLength:p.length})},[y,f,l,g,p.length]);const ie=async()=>{var a,s,t,i,h,N;try{ee(!0);const D=new URLSearchParams({page:l.toString(),limit:g.toString(),...k!=="all"&&{status:k},...P&&{search:P},...c&&$!=="all"&&{created_by:$}});console.log("🔍 Debug fetchPengajuanData - Request params (for debugging pagination issue):",{page:l,limit:g,statusFilter:k,searchTerm:P,createdByFilter:$});const d=await fe(`/api/pengajuan?${D}`,O);if(console.log("🔍 Debug fetchPengajuanData - Full response:",d),console.log("🔍 Debug fetchPengajuanData - Response data:",d.data),console.log("🔍 Debug fetchPengajuanData - Pagination data:",(a=d.data)==null?void 0:a.pagination),console.log("🔍 Debug fetchPengajuanData - Response structure check:",{hasData:!!d.data,hasDataData:!!((s=d.data)!=null&&s.data),hasPagination:!!((t=d.data)!=null&&t.pagination),dataType:typeof d.data,dataKeys:d.data?Object.keys(d.data):"no data"}),d.success){if(Pe(d.data),c){const T=d.grouped_by_kabkota;le(T||{})}const A=((i=d.pagination)==null?void 0:i.totalPages)||1,F=((h=d.pagination)==null?void 0:h.total)||0;console.log("🔍 Debug fetchPengajuanData - Setting pagination:",{totalPages:A,totalItems:F,currentPage:l,itemsPerPage:g}),$e(A),Ae(F),console.log("🔍 Debug fetchPengajuanData - After setting state:",{pengajuanListLength:(N=d.data)==null?void 0:N.length,totalPagesSet:A,totalItemsSet:F})}else L(d.message||"Gagal mengambil data pengajuan")}catch(D){console.error("Error fetching pengajuan data:",D),L("Terjadi kesalahan saat mengambil data pengajuan")}finally{ee(!1)}},Re=async()=>{try{const a=await fe("/api/pengajuan/filter-options",O);a.success&&(console.log("🔍 Debug fetchFilterOptions - Response:",a.data),Me(a.data))}catch(a){console.error("Error fetching filter options:",a)}},Ie=a=>{Te(a),b(1)},Le=a=>{C||(te(a),b(1))},ze=a=>{_e(a),b(1)},Ue=async()=>{if(se)try{ne(!0);const a=await aa(`/api/pengajuan/${se}`,O);a.success?(ie(),z(!1),H(null)):L(a.message||"Gagal menghapus pengajuan")}catch(a){console.error("Error deleting pengajuan:",a),L("Terjadi kesalahan saat menghapus pengajuan")}finally{ne(!1)}},re=a=>{const t={draft:{label:"Draft",className:"bg-gray-100 text-gray-800 hover:bg-gray-200",icon:be},submitted:{label:"Diajukan",className:"bg-blue-100 text-blue-800 hover:bg-blue-200",icon:E},approved:{label:"Disetujui",className:"bg-green-100 text-green-800 hover:bg-green-200",icon:M},rejected:{label:"Ditolak",className:"bg-red-100 text-red-800 hover:bg-red-200",icon:R},resubmitted:{label:"Diajukan Ulang",className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",icon:be},admin_wilayah_approved:{label:"Disetujui Admin Wilayah",className:"bg-green-200 text-green-800 hover:bg-green-300",icon:M},admin_wilayah_rejected:{label:"Ditolak Admin Wilayah",className:"bg-red-200 text-red-800 hover:bg-red-300",icon:R},final_approved:{label:"Final Approved",className:"bg-green-600 text-white",icon:M},final_rejected:{label:"Final Rejected",className:"bg-red-600 text-white",icon:R}}[a]||{label:a,className:"bg-gray-100 text-gray-800",icon:E},i=t.icon;return e.jsxs(K,{className:t.className,children:[e.jsx(i,{className:"h-3 w-3 mr-1"}),t.label]})},de=a=>({guru:"Guru",eselon_iv:"Eselon IV",fungsional:"Fungsional",pelaksana:"Pelaksana"})[a]||a,ce=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),oe=()=>{const a=Object.keys(U).length>0?U:p.reduce((s,t)=>{var h;const i=t.office&&(t.office.kabkota||t.office.name)||t.pegawai&&t.pegawai.induk_unit||((h=t.pegawai)==null?void 0:h.unit_kerja)||"Lainnya";return s[i]||(s[i]=[]),s[i].push(t),s},{});return Object.entries(a).map(([s,t])=>({kabkota:s,total:t.length}))},Be=(a,s)=>{const t=URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download=s,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(t)},Ee=()=>{const a=oe(),s=new Date,i=`Rekap-final_approved-per-kabkota-${`${s.getFullYear()}${String(s.getMonth()+1).padStart(2,"0")}${String(s.getDate()).padStart(2,"0")}`}.xls`,h=`
      <html>
      <head><meta charset="UTF-8" /></head>
      <body>
        <table border="1">
          <thead>
            <tr><th>Kab/Kota</th><th>Jumlah Pengajuan Final Approved</th></tr>
          </thead>
          <tbody>
            ${a.map(D=>`<tr><td>${D.kabkota}</td><td>${D.total}</td></tr>`).join("")}
          </tbody>
        </table>
      </body>
      </html>`,N=new Blob([h],{type:"application/vnd.ms-excel"});Be(N,i)},Ke=()=>{const a=oe().sort((u,S)=>S.total-u.total),s=a.reduce((u,S)=>u+S.total,0),t=Math.max(1,...a.map(u=>u.total)),i=a.length,h=new Date,N=h.toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),d=`Rekap-disetujui-kanwil-per-kabkota-${`${h.getFullYear()}${String(h.getMonth()+1).padStart(2,"0")}${String(h.getDate()).padStart(2,"0")}`}.pdf`,A=(n==null?void 0:n.full_name)||(n==null?void 0:n.email)||"Admin Pusat",F=a.slice(0,5),T=window.open("","_blank");T&&(T.document.write(`
      <html>
        <head>
          <meta charset="UTF-8" />
          <title>${d}</title>
          <style>
            @page { size: A4; margin: 18mm 14mm; }
            * { box-sizing: border-box; }
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color: #111827; }
            .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
            .title { font-size: 18px; font-weight: 700; }
            .meta { font-size: 12px; color: #4b5563; }
            .summary { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 8px; margin: 12px 0 16px; }
            .card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; }
            .card h3 { font-size: 12px; color: #6b7280; margin: 0 0 4px; font-weight: 600; }
            .card .value { font-size: 20px; font-weight: 700; color: #111827; }
            table { border-collapse: collapse; width: 100%; margin-top: 4px; }
            th, td { border: 1px solid #e5e7eb; padding: 8px 10px; font-size: 12px; }
            th { background: #f9fafb; text-align: left; }
            tfoot td { font-weight: 700; background: #f3f4f6; }
            .row { display: flex; align-items: center; gap: 10px; }
            .bar { height: 8px; background: #d1fae5; border-radius: 4px; overflow: hidden; }
            .bar > span { display: block; height: 100%; background: #10b981; }
            .note { margin-top: 12px; font-size: 11px; color: #6b7280; }
            .section-title { margin-top: 16px; font-size: 14px; font-weight: 700; }
          </style>
        </head>
        <body>
          <div class="header">
            <div>
              <div class="title">Rekap Pengajuan Telah Disetujui Kanwil per Kab/Kota</div>
              <div class="meta">Dihasilkan: ${N} • Dibuat oleh: ${A}</div>
            </div>
          </div>

          <div class="summary">
            <div class="card">
              <h3>Total Telah Disetujui Kanwil</h3>
              <div class="value">${s}</div>
            </div>
            <div class="card">
              <h3>Jumlah Kab/Kota</h3>
              <div class="value">${i}</div>
            </div>
            <div class="card">
              <h3>Top Kab/Kota</h3>
              <div style="font-size:12px; color:#111827; line-height:1.4;">
                ${F.map((u,S)=>`${S+1}. ${u.kabkota} (${u.total})`).join("<br/>")||"-"}
              </div>
            </div>
          </div>

          <div class="section-title">Tabel Rekap</div>
          <table>
            <thead>
              <tr>
                <th style="width:36px;">No</th>
                <th>Kab/Kota</th>
                <th style="width:110px;">Jumlah</th>
                <th style="width:80px;">Persen</th>
                <th>Visual</th>
              </tr>
            </thead>
            <tbody>
              ${a.map((u,S)=>{const Oe=s>0?Math.round(u.total/s*1e3)/10:0,He=Math.round(u.total/t*100),B=140,Je=Math.max(1,Math.round(He/100*B));return`
                  <tr>
                    <td>${S+1}</td>
                    <td>${u.kabkota}</td>
                    <td style="text-align:right; font-variant-numeric: tabular-nums;">${u.total}</td>
                    <td style="text-align:right; font-variant-numeric: tabular-nums;">${Oe.toFixed(1)}%</td>
                    <td>
                      <svg width="${B}" height="10" viewBox="0 0 ${B} 10" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0" y="0" width="${B}" height="10" fill="#E5F6F1" stroke="#D1D5DB" />
                        <rect x="0" y="0" width="${Je}" height="10" fill="#10B981" />
                      </svg>
                    </td>
                  </tr>
                `}).join("")}
            </tbody>
            <tfoot>
              <tr>
                <td colspan="2">Total</td>
                <td style="text-align:right; font-variant-numeric: tabular-nums;">${s}</td>
                <td></td>
                <td></td>
              </tr>
            </tfoot>
          </table>

          <div class="note">Catatan: Laporan ini menampilkan pengajuan yang <strong>telah disetujui Kanwil</strong>.</div>

          <script>
            window.onload = function() { window.print(); };
          <\/script>
        </body>
      </html>
    `),T.document.close())};return console.log("🔍 Debug PengajuanIndex:",{userRole:n==null?void 0:n.role,isAdmin:c,userEmail:n==null?void 0:n.email}),e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs(qe,{children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Daftar Pengajuan Mutasi PNS"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c?"Semua pengajuan mutasi PNS":C?"Semua pengajuan berstatus final_approved (read-only)":"Pengajuan mutasi PNS Anda"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[C&&e.jsxs(e.Fragment,{children:[e.jsx(m,{onClick:Ee,className:"bg-green-600 hover:bg-green-700 text-white",children:"Export Excel"}),e.jsx(m,{onClick:Ke,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Export PDF"})]}),(n==null?void 0:n.role)!=="user"&&e.jsxs(m,{onClick:()=>j("/pengajuan/select"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Tambah Pengajuan"]})]})]})}),e.jsxs(Qe,{children:[ae&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600",children:ae})}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ea,{placeholder:"Cari berdasarkan nama pegawai, jabatan, atau jenis jabatan...",value:P,onChange:a=>Ie(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-gray-400"}),e.jsxs(ke,{value:k,onValueChange:Le,children:[e.jsx(Ne,{className:"w-48",children:e.jsx(De,{placeholder:"Filter Status"})}),e.jsxs(Se,{children:[e.jsx(w,{value:"all",children:"Semua Status"}),e.jsx(w,{value:"draft",children:"Draft"}),e.jsx(w,{value:"submitted",children:"Diajukan"}),e.jsx(w,{value:"approved",children:"Disetujui"}),e.jsx(w,{value:"rejected",children:"Ditolak"}),e.jsx(w,{value:"resubmitted",children:"Diajukan Ulang"}),e.jsx(w,{value:"admin_wilayah_approved",children:"Disetujui Admin Wilayah"}),e.jsx(w,{value:"admin_wilayah_rejected",children:"Ditolak Admin Wilayah"})]})]})]}),c&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-gray-400"}),e.jsxs(ke,{value:$,onValueChange:ze,children:[e.jsx(Ne,{className:"w-48",children:e.jsx(De,{placeholder:"Filter Pembuat"})}),e.jsxs(Se,{children:[e.jsx(w,{value:"all",children:"Semua Pembuat"}),V.users.map(a=>e.jsx(w,{value:a.id,children:a.full_name||a.email||"Unknown User"},a.id))]})]})]})]})]}),W&&Object.keys(U).length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Tergabung berdasarkan kabupaten/kota"}),e.jsx(ta,{type:"multiple",className:"w-full",children:Object.entries(U).map(([a,s])=>e.jsxs(sa,{value:a,className:"border rounded-lg",children:[e.jsx(na,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"font-medium",children:a}),e.jsx(K,{variant:"secondary",className:"ml-2",children:s.length})]})}),e.jsx(la,{className:"px-0",children:e.jsx("div",{className:"border-t",children:e.jsxs(X,{children:[e.jsx(Q,{children:e.jsxs(_,{children:[e.jsx(r,{children:"Pegawai"}),e.jsx(r,{children:"Jenis Jabatan"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Dokumen"}),c&&e.jsx(r,{children:"Pembuat"}),e.jsx(r,{children:"Tanggal Dibuat"}),e.jsx(r,{className:"text-right",children:"Aksi"})]})}),e.jsx(Z,{children:s.map(t=>e.jsxs(_,{className:"hover:bg-gray-50",children:[e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.pegawai.nama}),e.jsx("div",{className:"text-sm text-gray-500",children:t.pegawai.jabatan})]})}),e.jsx(x,{children:e.jsx(K,{variant:"outline",children:de(t.jenis_jabatan)})}),e.jsx(x,{children:re(t.status)}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:t.files.length}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-sm",children:t.total_dokumen})]})}),c&&e.jsx(x,{children:e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{var h;const i=V.users.find(N=>N.id===t.created_by);return i?i.full_name||i.email||"Unknown User":(h=t.created_by)!=null&&h.includes("@")?t.created_by:"Unknown User"})()})}),e.jsx(x,{children:e.jsx("div",{className:"text-sm text-gray-600",children:ce(t.created_at)})}),e.jsx(x,{className:"text-right",children:e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsxs(we,{align:"end",children:[e.jsxs(v,{onClick:()=>j(`/pengajuan/${t.id}`),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Lihat Detail"]}),c&&t.status==="submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{onClick:()=>j(`/pengajuan/${t.id}`),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Setujui"]}),e.jsxs(v,{onClick:()=>j(`/pengajuan/${t.id}`),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Tolak"]})]}),c&&e.jsxs(v,{onClick:()=>{H(t.id),z(!0)},className:"text-red-600",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Hapus"]})]})]})})]},t.id))})]})})})]},a))}),y>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(l-1)*g+1," sampai ",Math.min(l*g,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l-1),disabled:l===1,children:[e.jsx(q,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:y},(a,s)=>s+1).map(a=>e.jsx(m,{variant:l===a?"default":"outline",size:"sm",onClick:()=>b(a),className:"w-8 h-8 p-0",children:a},a))}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l+1),disabled:l===y,children:["Selanjutnya",e.jsx(Y,{className:"h-4 w-4"})]})]})]})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:Ce?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(je,{className:"h-8 w-8 animate-spin mr-2"}),e.jsx("span",{children:"Memuat data pengajuan..."})]}):p.length===0&&f===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:P||k!=="all"?"Tidak ada pengajuan yang sesuai dengan filter":"Belum ada pengajuan"}),!P&&k==="all"&&(n==null?void 0:n.role)!=="user"&&e.jsxs(m,{onClick:()=>j("/pengajuan/select"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Buat Pengajuan Pertama"]})]}):p.length===0&&f>0?e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(Q,{children:e.jsxs(_,{children:[e.jsx(r,{children:"Pegawai"}),e.jsx(r,{children:"Jenis Jabatan"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Dokumen"}),e.jsx(r,{children:"Tanggal Dibuat"}),e.jsx(r,{children:"Aksi"})]})}),e.jsx(Z,{children:e.jsx(_,{children:e.jsx(x,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Tidak ada data di halaman ini"})})})]}),e.jsxs("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-200 text-xs text-yellow-800",children:["🔍 Debug Info: Total Items: ",f," | Total Pages: ",y," | Current Page: ",l," | Items Per Page: ",g," | Data Length: ",p.length]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(l-1)*g+1," sampai ",Math.min(l*g,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l-1),disabled:l===1,children:[e.jsx(q,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:y},(a,s)=>s+1).map(a=>e.jsx(m,{variant:l===a?"default":"outline",size:"sm",onClick:()=>b(a),className:"w-8 h-8 p-0",children:a},a))}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l+1),disabled:l===y,children:["Selanjutnya",e.jsx(Y,{className:"h-4 w-4"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(Q,{children:e.jsxs(_,{children:[e.jsx(r,{children:"Pegawai"}),e.jsx(r,{children:"Jenis Jabatan"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Dokumen"}),c&&e.jsx(r,{children:"Pembuat"}),e.jsx(r,{children:"Tanggal Dibuat"}),e.jsx(r,{className:"text-right",children:"Aksi"})]})}),e.jsx(Z,{children:p.map(a=>e.jsxs(_,{className:"hover:bg-gray-50",children:[e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.pegawai.nama}),e.jsx("div",{className:"text-sm text-gray-500",children:a.pegawai.jabatan})]})}),e.jsx(x,{children:e.jsx(K,{variant:"outline",children:de(a.jenis_jabatan)})}),e.jsx(x,{children:re(a.status)}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:a.files.length}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-sm",children:a.total_dokumen})]})}),c&&e.jsx(x,{children:e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{var t;const s=V.users.find(i=>i.id===a.created_by);return s?s.full_name||s.email||"Unknown User":(t=a.created_by)!=null&&t.includes("@")?a.created_by:"Unknown User"})()})}),e.jsx(x,{children:e.jsx("div",{className:"text-sm text-gray-600",children:ce(a.created_at)})}),e.jsx(x,{className:"text-right",children:e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsxs(we,{align:"end",children:[e.jsxs(v,{onClick:()=>j(`/pengajuan/${a.id}`),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Lihat Detail"]}),(n==null?void 0:n.role)!=="user"&&e.jsxs(e.Fragment,{children:[a.status==="draft"&&e.jsxs(v,{onClick:()=>j(`/pengajuan/${a.id}/upload`),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Upload Dokumen"]}),a.status==="rejected"&&e.jsxs(v,{onClick:()=>j(`/pengajuan/${a.id}/edit`),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Perbaiki Dokumen"]})]}),c&&a.status==="submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{onClick:()=>j(`/pengajuan/${a.id}`),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Setujui"]}),e.jsxs(v,{onClick:()=>j(`/pengajuan/${a.id}`),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Tolak"]})]}),(c||a.status==="draft"&&(n==null?void 0:n.role)!=="user")&&e.jsxs(v,{onClick:()=>{console.log("🔍 Debug: Klik hapus untuk pengajuan:",{id:a.id,status:a.status,isAdmin:c,userRole:n==null?void 0:n.role}),H(a.id),z(!0)},className:"text-red-600",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Hapus"]})]})]})})]},a.id))})]}),e.jsxs("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-200 text-xs text-yellow-800",children:["🔍 Debug Info: Total Items: ",f," | Total Pages: ",y," | Current Page: ",l," | Items Per Page: ",g," | Data Length: ",p.length]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(l-1)*g+1," sampai ",Math.min(l*g,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l-1),disabled:l===1,children:[e.jsx(q,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:y},(a,s)=>s+1).map(a=>e.jsx(m,{variant:l===a?"default":"outline",size:"sm",onClick:()=>b(a),className:"w-8 h-8 p-0",children:a},a))}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b(l+1),disabled:l===y,children:["Selanjutnya",e.jsx(Y,{className:"h-4 w-4"})]})]})]})]})})]})]}),e.jsx(ia,{open:Fe,onOpenChange:z,children:e.jsxs(ra,{children:[e.jsxs(da,{children:[e.jsx(ca,{children:"Hapus Pengajuan"}),e.jsx(oa,{children:"Apakah Anda yakin ingin menghapus pengajuan ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(ha,{children:[e.jsx(ma,{disabled:J,children:"Batal"}),e.jsx(xa,{onClick:Ue,disabled:J,className:"bg-red-600 hover:bg-red-700",children:J?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-4 w-4 mr-2 animate-spin"}),"Menghapus..."]}):"Hapus"})]})]})})]})};export{wa as default};
//# sourceMappingURL=PengajuanIndex-De5XQ9_k.js.map
