{"version":3,"file":"PegawaiSearchInput-CFPYVDSH.js","sources":["../../src/hooks/usePegawaiSearch.ts","../../src/components/PegawaiSearchInput.tsx"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { Pegawai } from '@/types/template';\r\nimport { apiGet } from '@/lib/api';\r\n\r\nexport const usePegawaiSearch = () => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [results, setResults] = useState<Pegawai[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!searchTerm.trim()) {\r\n      setResults([]);\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    setError(null);\r\n    const timeoutId = setTimeout(() => {\r\n      const token = localStorage.getItem('token');\r\n      apiGet(`/api/employees/search?q=${encodeURIComponent(searchTerm)}`, token)\r\n        .then(data => setResults(data.pegawai || data.employees || []))\r\n        .catch(() => setError('Gagal mencari pegawai'))\r\n        .finally(() => setIsLoading(false));\r\n    }, 300);\r\n    return () => clearTimeout(timeoutId);\r\n  }, [searchTerm]);\r\n\r\n  return {\r\n    searchTerm,\r\n    setSearchTerm,\r\n    results,\r\n    isLoading,\r\n    error\r\n  };\r\n};\r\n","\r\nimport React, { useState } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Search, User, Check, X } from 'lucide-react';\r\nimport { usePegawaiSearch } from '@/hooks/usePegawaiSearch';\r\nimport { Pegawai } from '@/types/template';\r\n\r\ninterface PegawaiSearchInputProps {\r\n  label: string;\r\n  placeholder: string;\r\n  onSelect: (pegawai: Pegawai | undefined) => void;\r\n  selectedPegawai?: Pegawai;\r\n}\r\n\r\nexport const PegawaiSearchInput: React.FC<PegawaiSearchInputProps> = ({\r\n  label,\r\n  placeholder,\r\n  onSelect,\r\n  selectedPegawai\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const { searchTerm, setSearchTerm, results, isLoading } = usePegawaiSearch();\r\n\r\n  // Jika user mengetik, hapus pilihan pegawai\r\n  const handleInputChange = (value: string) => {\r\n    setSearchTerm(value);\r\n    if (selectedPegawai) onSelect(undefined);\r\n    setIsOpen(value.length > 0);\r\n  };\r\n\r\n  const handleSelect = (pegawai: Pegawai) => {\r\n    onSelect(pegawai);\r\n    setSearchTerm('');\r\n    setIsOpen(false);\r\n    // Hilangkan fokus dari input setelah memilih\r\n    document.activeElement instanceof HTMLElement && document.activeElement.blur();\r\n  };\r\n\r\n  const handleReset = () => {\r\n    onSelect(undefined);\r\n    setSearchTerm('');\r\n    setIsOpen(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <Label>{label}</Label>\r\n      <div className=\"relative\">\r\n        <div className=\"relative\">\r\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4\" />\r\n          <Input\r\n            placeholder={placeholder}\r\n            value={searchTerm}\r\n            onChange={(e) => handleInputChange(e.target.value)}\r\n            className=\"pl-10\"\r\n            onFocus={() => setIsOpen(searchTerm.length > 0)}\r\n            disabled={false}\r\n          />\r\n          {selectedPegawai && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleReset}\r\n              className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-red-500 hover:text-red-700 transition-colors\"\r\n              tabIndex={-1}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n        {isOpen && !selectedPegawai && results.length > 0 && (\r\n          <Card className=\"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto\">\r\n            <CardContent className=\"p-0\">\r\n              {isLoading ? (\r\n                <div className=\"p-4 text-center text-muted-foreground\">\r\n                  <div className=\"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mx-auto\"></div>\r\n                </div>\r\n              ) : results.length > 0 ? (\r\n                <div className=\"divide-y\">\r\n                  {results.map((pegawai) => (\r\n                    <div\r\n                      key={pegawai.id || pegawai.nip}\r\n                      className=\"p-3 hover:bg-muted cursor-pointer transition-colors\"\r\n                      onClick={() => handleSelect(pegawai)}\r\n                    >\r\n                      <div className=\"flex items-start space-x-3\">\r\n                        <div className=\"p-2 bg-muted rounded-lg\">\r\n                          <User className=\"w-4 h-4\" />\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"font-medium text-sm\">{pegawai.nama}</div>\r\n                          <div className=\"text-xs text-muted-foreground\">{pegawai.nip}</div>\r\n                          <div className=\"flex items-center space-x-2 mt-1\">\r\n                            <Badge variant=\"outline\" className=\"text-xs\">{pegawai.pangkat_gol || (pegawai as any).golongan}</Badge>\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground mt-1\">{pegawai.jabatan}</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : searchTerm.length > 0 ? (\r\n                <div className=\"p-4 text-center text-muted-foreground text-sm\">\r\n                  Tidak ada hasil ditemukan\r\n                </div>\r\n              ) : null}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n      {selectedPegawai && (\r\n        <div className=\"flex items-center space-x-2 mt-2 bg-muted rounded p-2\">\r\n          <User className=\"w-4 h-4 text-muted-foreground\" />\r\n          <span className=\"font-medium text-sm\">{selectedPegawai.nama}</span>\r\n          <span className=\"text-xs text-muted-foreground\">{selectedPegawai.nip}</span>\r\n          <Badge variant=\"outline\" className=\"text-xs\">{selectedPegawai.pangkat_gol || (selectedPegawai as any).golongan}</Badge>\r\n          <span className=\"text-xs text-muted-foreground\">{selectedPegawai.jabatan}</span>\r\n          <button type=\"button\" onClick={handleReset} className=\"ml-auto text-red-500 hover:text-red-700\">\r\n            <X className=\"h-4 w-4\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"names":["usePegawaiSearch","searchTerm","setSearchTerm","useState","results","setResults","isLoading","setIsLoading","error","setError","useEffect","timeoutId","token","apiGet","data","PegawaiSearchInput","label","placeholder","onSelect","selectedPegawai","isOpen","setIsOpen","handleInputChange","value","handleSelect","pegawai","handleReset","jsxs","jsx","Label","Search","Input","e","X","Card","CardContent","User","Badge"],"mappings":"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"}