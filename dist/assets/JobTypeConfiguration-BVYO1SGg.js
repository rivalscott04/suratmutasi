import{j as a,as as M,at as E,au as I,X as R,ar as H}from"./ui-vendor-DQXcJUOU.js";import{r as o}from"./react-vendor-DheTkQGW.js";import{C as L,a as $,b as z,c as G}from"./card-9uXC-pKf.js";import{u as O,d as Y,a as X,B as m,b as Q,D as U,e as V,f as W,g as Z,I as f,j as aa,c as ea,l as na}from"./index-VzW38db3.js";import{L as d}from"./label-DhP_vQTE.js";import{C as ta}from"./checkbox-CjhFZU6u.js";import{S as sa}from"./switch-JbzynozL.js";const ca=()=>{const{token:k}=O(),{toast:i}=Y(),[N,v]=o.useState([]),[K,S]=o.useState(!0),[A,c]=o.useState(!1),[h,P]=o.useState(null),[j,y]=o.useState(!1),[s,u]=o.useState({jenis_jabatan:"",total_dokumen:0,required_files:[],is_active:!0}),b=[{id:"surat_pengantar",name:"Surat Pengantar",category:"Dokumen Pengantar"},{id:"surat_permohonan_dari_yang_bersangkutan",name:"Surat Permohonan Dari Yang Bersangkutan",category:"Dokumen Pengantar"},{id:"surat_keputusan_cpns",name:"Surat Keputusan CPNS",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_pns",name:"Surat Keputusan PNS",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_kenaikan_pangkat_terakhir",name:"Surat Keputusan Kenaikan Pangkat Terakhir",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_jabatan_terakhir",name:"Surat Keputusan Jabatan Terakhir",category:"Dokumen Kepegawaian"},{id:"skp_2_tahun_terakhir",name:"SKP 2 Tahun Terakhir",category:"Dokumen Kepegawaian"},{id:"surat_keterangan_anjab_abk_instansi_asal",name:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",category:"Dokumen Keterangan"},{id:"surat_keterangan_anjab_abk_instansi_penerima",name:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",category:"Dokumen Keterangan"},{id:"surat_pernyataan_tidak_hukuman_disiplin",name:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",category:"Dokumen Pernyataan"},{id:"surat_persetujuan_mutasi_asal",name:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",category:"Dokumen Persetujuan"},{id:"surat_lolos_butuh_ppk",name:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",category:"Dokumen Persetujuan"},{id:"peta_jabatan",name:"Peta Jabatan",category:"Dokumen Pendukung"},{id:"hasil_evaluasi_pertimbangan_baperjakat",name:"Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)",category:"Dokumen Pendukung"},{id:"anjab_abk_instansi_asal",name:"Anjab/Abk Instansi Asal",category:"Dokumen Pendukung"},{id:"anjab_abk_instansi_penerima",name:"Anjab/Abk Instansi Penerima",category:"Dokumen Pendukung"},{id:"surat_keterangan_tidak_tugas_belajar",name:"Surat Keterangan Tidak Sedang Tugas Belajar",category:"Dokumen Keterangan"},{id:"sptjm_pimpinan_satker_asal",name:"SPTJM Pimpinan Satker dari Asal",category:"Dokumen Pernyataan"},{id:"sptjm_pimpinan_satker_penerima",name:"SPTJM Pimpinan Satker dari Penerima",category:"Dokumen Pernyataan"},{id:"surat_rekomendasi_instansi_pembina",name:"Surat Rekomendasi Instansi Pembina",category:"Dokumen Rekomendasi"}];o.useEffect(()=>{x()},[]);const x=async()=>{try{S(!0);const e=await X("/api/job-type-configurations",k);e.success&&v(e.data)}catch(e){console.error("Error fetching configs:",e),i({title:"Error",description:"Gagal mengambil data konfigurasi",variant:"destructive"})}finally{S(!1)}},T=()=>{u({jenis_jabatan:"",total_dokumen:0,required_files:[],is_active:!0}),P(null),c(!0)},D=e=>{const t=(l=>{const g={"Surat Pengantar":"surat_pengantar","Surat Permohonan Dari Yang Bersangkutan":"surat_permohonan_dari_yang_bersangkutan","Surat Keputusan CPNS":"surat_keputusan_cpns","Surat Keputusan PNS":"surat_keputusan_pns","Surat Keputusan Kenaikan Pangkat Terakhir":"surat_keputusan_kenaikan_pangkat_terakhir","Surat Keputusan Jabatan Terakhir":"surat_keputusan_jabatan_terakhir","SKP 2 Tahun Terakhir":"skp_2_tahun_terakhir","Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal":"surat_keterangan_anjab_abk_instansi_asal","Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima":"surat_keterangan_anjab_abk_instansi_penerima","Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK":"surat_pernyataan_tidak_hukuman_disiplin","Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki":"surat_persetujuan_mutasi_asal","Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju":"surat_lolos_butuh_ppk","Peta Jabatan":"peta_jabatan","Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)":"hasil_evaluasi_pertimbangan_baperjakat","Anjab/Abk Instansi Asal":"anjab_abk_instansi_asal","Anjab/Abk Instansi Penerima":"anjab_abk_instansi_penerima","Surat Keterangan Tidak Sedang Tugas Belajar":"surat_keterangan_tidak_tugas_belajar","SPTJM Pimpinan Satker dari Asal":"sptjm_pimpinan_satker_asal","SPTJM Pimpinan Satker dari Penerima":"sptjm_pimpinan_satker_penerima","Surat Rekomendasi Instansi Pembina":"surat_rekomendasi_instansi_pembina","SK Pangkat Terakhir":"surat_keputusan_kenaikan_pangkat_terakhir","SK Jabatan Terakhir":"surat_keputusan_jabatan_terakhir","Ijazah Terakhir":"surat_keputusan_pns","Sertifikat Diklat":"surat_keputusan_cpns","Surat Pernyataan":"surat_pernyataan_tidak_hukuman_disiplin",Foto:"surat_pengantar"};console.log("Original required_files from database:",e.required_files);const _=l.map(r=>{const p=g[r];return console.log(`Mapping "${r}" to "${p}"`),p}).filter(r=>r!==void 0);return console.log("Mapped required_files:",_),_})(e.required_files);u({jenis_jabatan:e.jenis_jabatan,total_dokumen:e.max_dokumen,required_files:t,is_active:e.is_active}),P(e),c(!0)},C=async()=>{try{y(!0);const n=(l=>{const g={surat_pengantar:"Surat Pengantar",surat_permohonan_dari_yang_bersangkutan:"Surat Permohonan Dari Yang Bersangkutan",surat_keputusan_cpns:"Surat Keputusan CPNS",surat_keputusan_pns:"Surat Keputusan PNS",surat_keputusan_kenaikan_pangkat_terakhir:"Surat Keputusan Kenaikan Pangkat Terakhir",surat_keputusan_jabatan_terakhir:"Surat Keputusan Jabatan Terakhir",skp_2_tahun_terakhir:"SKP 2 Tahun Terakhir",surat_keterangan_anjab_abk_instansi_asal:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",surat_keterangan_anjab_abk_instansi_penerima:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",surat_pernyataan_tidak_hukuman_disiplin:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",surat_persetujuan_mutasi_asal:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",surat_lolos_butuh_ppk:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",peta_jabatan:"Peta Jabatan",hasil_evaluasi_pertimbangan_baperjakat:"Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)",anjab_abk_instansi_asal:"Anjab/Abk Instansi Asal",anjab_abk_instansi_penerima:"Anjab/Abk Instansi Penerima",surat_keterangan_tidak_tugas_belajar:"Surat Keterangan Tidak Sedang Tugas Belajar",sptjm_pimpinan_satker_asal:"SPTJM Pimpinan Satker dari Asal",sptjm_pimpinan_satker_penerima:"SPTJM Pimpinan Satker dari Penerima",surat_rekomendasi_instansi_pembina:"Surat Rekomendasi Instansi Pembina"};console.log("Frontend file type IDs:",l);const _=l.map(r=>{const p=g[r];return console.log(`Mapping "${r}" to "${p}"`),p}).filter(r=>r!==void 0);return console.log("Mapped file names for database:",_),_})(s.required_files),t={...s,required_files:n,is_active:s.is_active};h?(await aa(`/api/job-type-configurations/${h.id}`,t,k),i({title:"Berhasil",description:"Konfigurasi berhasil diperbarui"})):(await ea("/api/job-type-configurations",t,k),i({title:"Berhasil",description:"Konfigurasi berhasil ditambahkan"})),c(!1),x()}catch(e){console.error("Error saving config:",e),i({title:"Error",description:(e==null?void 0:e.message)||"Gagal menyimpan konfigurasi",variant:"destructive"})}finally{y(!1)}},w=async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus konfigurasi ini?"))try{await na(`/api/job-type-configurations/${e}`,k),i({title:"Berhasil",description:"Konfigurasi berhasil dihapus"}),x()}catch(n){console.error("Error deleting config:",n),i({title:"Error",description:(n==null?void 0:n.message)||"Gagal menghapus konfigurasi",variant:"destructive"})}},B=e=>{u(n=>{if(n.required_files.includes(e)){const l=n.required_files.filter(g=>g!==e);return{...n,required_files:l,total_dokumen:l.length}}if(n.required_files.length>=22)return i({title:"Batas Maksimum",description:"Maksimum 22 dokumen yang dapat dipilih untuk mutasi PNS",variant:"destructive"}),n;const t=[...n.required_files,e];return{...n,required_files:t,total_dokumen:t.length}})},q=()=>{const e=b.map(n=>n.id);u(n=>({...n,required_files:e,total_dokumen:e.length})),i({title:"Berhasil",description:"Semua dokumen telah dipilih"})},F=()=>{u(e=>({...e,required_files:[],total_dokumen:0})),i({title:"Berhasil",description:"Semua dokumen telah dihapus dari pilihan"})},J=b.reduce((e,n)=>(e[n.category]||(e[n.category]=[]),e[n.category].push(n),e),{});return K?a.jsx("div",{className:"container mx-auto p-6",children:a.jsx("div",{className:"text-center",children:"Loading..."})}):a.jsxs("div",{className:"container mx-auto p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Konfigurasi Jenis Jabatan"}),a.jsxs(m,{onClick:T,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white",children:[a.jsx(M,{className:"h-4 w-4"}),"Tambah Konfigurasi"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(e=>a.jsxs(L,{children:[a.jsx($,{children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx(z,{className:"text-lg",children:e.jenis_jabatan}),a.jsx(Q,{variant:"secondary",className:e.is_active?"bg-green-100 text-green-800 border-green-200":"bg-red-100 text-red-800 border-red-200",children:e.is_active?"Aktif":"Nonaktif"})]})}),a.jsx(G,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(d,{className:"text-sm font-medium",children:"Total Dokumen"}),a.jsx("p",{className:"text-lg font-semibold",children:e.max_dokumen})]}),a.jsxs("div",{children:[a.jsx(d,{className:"text-sm font-medium",children:"Min Dokumen"}),a.jsx("p",{className:"text-sm text-gray-600",children:e.min_dokumen})]}),a.jsxs("div",{children:[a.jsx(d,{className:"text-sm font-medium",children:"File Types"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.required_files.length," file types"]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs(m,{size:"sm",variant:"outline",onClick:()=>D(e),className:"flex items-center gap-1 border-green-600 text-green-600 hover:bg-green-50",children:[a.jsx(E,{className:"h-3 w-3"}),"Edit"]}),a.jsxs(m,{size:"sm",variant:"outline",onClick:()=>w(e.id),className:"flex items-center gap-1 border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(I,{className:"h-3 w-3"}),"Hapus"]})]})]})})]},e.id))}),a.jsx(U,{open:A,onOpenChange:c,children:a.jsxs(V,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsx(W,{children:a.jsx(Z,{children:h?"Edit Konfigurasi":"Tambah Konfigurasi Baru"})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(d,{htmlFor:"jenis_jabatan",children:"Jenis Jabatan"}),a.jsx(f,{id:"jenis_jabatan",value:s.jenis_jabatan,onChange:e=>u(n=>({...n,jenis_jabatan:e.target.value})),placeholder:"Contoh: Guru, Penghulu, dll"})]}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"total_dokumen",children:"Total Dokumen"}),a.jsx(f,{id:"total_dokumen",type:"number",value:s.total_dokumen,onChange:e=>u(n=>({...n,total_dokumen:parseInt(e.target.value)||0})),min:"1",max:"20",disabled:!0,className:"bg-gray-50"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Otomatis mengikuti jumlah file types yang dipilih"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(sa,{id:"is_active",checked:s.is_active,onCheckedChange:e=>u(n=>({...n,is_active:e})),className:"data-[state=checked]:bg-green-600"}),a.jsx(d,{htmlFor:"is_active",className:"text-sm font-medium",children:s.is_active?"Aktif":"Nonaktif"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{children:[a.jsx(d,{className:"text-base font-medium",children:"Pilih File Types yang Diperlukan"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Centang file types yang diperlukan untuk jenis jabatan ini"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:q,className:"border-green-600 text-green-600 hover:bg-green-50",children:["Pilih Semua (",b.length,")"]}),a.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:F,className:"border-gray-600 text-gray-600 hover:bg-gray-50",children:"Hapus Semua"})]})]}),a.jsx("div",{className:"space-y-4",children:Object.entries(J).map(([e,n])=>a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium mb-3 text-gray-800",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:n.map(t=>a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ta,{id:t.id,checked:s.required_files.includes(t.id),onCheckedChange:()=>B(t.id),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),a.jsx(d,{htmlFor:t.id,className:"text-sm cursor-pointer",children:t.name})]},t.id))})]},e))})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Ringkasan"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total file types yang dipilih: ",a.jsx("strong",{children:s.required_files.length})," / 22"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total dokumen: ",a.jsx("strong",{children:s.total_dokumen})]}),s.required_files.length>=22&&a.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"⚠️ Maksimum 22 dokumen untuk mutasi PNS"})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsxs(m,{variant:"outline",onClick:()=>c(!1),disabled:j,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[a.jsx(R,{className:"h-4 w-4 mr-2"}),"Batal"]}),a.jsxs(m,{onClick:C,disabled:j||!s.jenis_jabatan||s.required_files.length===0,className:"bg-green-600 hover:bg-green-700 text-white",children:[a.jsx(H,{className:"h-4 w-4 mr-2"}),j?"Menyimpan...":"Simpan"]})]})]})]})})]})};export{ca as default};
//# sourceMappingURL=JobTypeConfiguration-BVYO1SGg.js.map
