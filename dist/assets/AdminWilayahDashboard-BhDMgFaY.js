import{j as e,au as K,aF as _,aY as $,K as z,ad as B,_ as L,a0 as g,af as q,ac as I}from"./ui-vendor-DiY4nm-6.js";import{r as o,L as u}from"./react-vendor-C8WR5ETM.js";import{C as n,a as d,b as c,c as x}from"./card-Cu65o8DU.js";import{u as M,B as m,b as k,a as V,k as W}from"./index-9P-lsB0e.js";import{P as C}from"./progress-CdUd4Mvr.js";const Y=()=>{const{token:h}=M(),[l,U]=o.useState({totalPengajuan:0,pendingUpload:0,completedUpload:0,totalFiles:0,verifiedFiles:0,rejectedFiles:0}),[f,A]=o.useState([]),[S,N]=o.useState(!0),[y,p]=o.useState(null),[b,D]=o.useState([]),[v,w]=o.useState(null),j=async()=>{var s,i,r;try{N(!0),p(null);const a=await V("/api/admin-wilayah/dashboard",h),t=((s=a==null?void 0:a.data)==null?void 0:s.stats)||(a==null?void 0:a.stats),F=((i=a==null?void 0:a.data)==null?void 0:i.recentUploads)||(a==null?void 0:a.recentUploads)||[],P=((r=a==null?void 0:a.data)==null?void 0:r.pengajuan)||(a==null?void 0:a.pengajuan)||[];t?(U({totalPengajuan:Number(t.total_pengajuan||t.totalPengajuan||0),pendingUpload:Number(t.pending_upload||t.pendingUpload||0),completedUpload:Number(t.completed_upload||t.completedUpload||0),totalFiles:Number(t.total_files||t.totalFiles||0),verifiedFiles:Number(t.verified_files||t.verifiedFiles||0),rejectedFiles:Number(t.rejected_files||t.rejectedFiles||0)}),A(Array.isArray(F)?F:[]),D(Array.isArray(P)?P:[])):p("Failed to fetch dashboard data")}catch(a){console.error("Error fetching dashboard data:",a),p("Error connecting to server")}finally{N(!1)}},R=async s=>{if(h){w(s);try{const i=await W(`/api/admin-wilayah/pengajuan/${s}/submit-to-superadmin`,{},h);(i==null?void 0:i.success)!==!1&&await j()}finally{w(null)}}};o.useEffect(()=>{j()},[h]);const T=()=>l.totalFiles===0?0:l.verifiedFiles/l.totalFiles*100,E=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return S?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[...Array(4)].map((s,i)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},i))})]})})}):y?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:y}),e.jsxs(m,{onClick:j,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(_,{className:"h-4 w-4"}),"Retry"]})]})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Admin Wilayah"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Monitoring aktivitas upload file dan progress pengajuan"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{onClick:j,variant:"outline",size:"sm",className:"border-green-200 text-green-700 hover:bg-green-50",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsx($,{className:"h-6 w-6 text-green-600"}),e.jsx(k,{className:"bg-green-100 text-green-800",children:"Admin Wilayah"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(n,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Pengajuan"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.totalPengajuan}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pengajuan yang sudah approved"})]})]}),e.jsxs(n,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Pending Upload"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l.pendingUpload}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Menunggu upload file admin wilayah"})]})]}),e.jsxs(n,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Completed Upload"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.completedUpload}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"File admin wilayah sudah lengkap"})]})]}),e.jsxs(n,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Files"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.totalFiles}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"File yang sudah diupload"})]})]})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(c,{children:"Progress Overview"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"File Verification Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[l.verifiedFiles," of ",l.totalFiles," files verified"]})]}),e.jsx(C,{value:T(),className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Pending: ",l.totalFiles-l.verifiedFiles-l.rejectedFiles]}),e.jsxs("span",{children:["Verified: ",l.verifiedFiles]}),e.jsxs("span",{children:["Rejected: ",l.rejectedFiles]})]})]})})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(c,{children:"Pengajuan dari Kab/Kota (Approved)"})}),e.jsx(x,{children:b.length===0?e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Tidak ada data"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"py-2 pr-4",children:"Pegawai"}),e.jsx("th",{className:"py-2 pr-4",children:"NIP"}),e.jsx("th",{className:"py-2 pr-4",children:"Jenis Jabatan"}),e.jsx("th",{className:"py-2 pr-4",children:"Berkas Kab/Kota"}),e.jsx("th",{className:"py-2 pr-4",children:"Progress Kanwil"}),e.jsx("th",{className:"py-2 pr-4",children:"Aksi"})]})}),e.jsx("tbody",{children:b.map(s=>{const i=s.pegawai||{},r=s.progress_admin_wilayah||{required:0,approved:0},a=`${r.approved}/${r.required}`,t=s.status==="admin_wilayah_approved";return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pr-4",children:i.nama||"-"}),e.jsx("td",{className:"py-2 pr-4",children:i.nip||"-"}),e.jsx("td",{className:"py-2 pr-4",children:s.jenis_jabatan}),e.jsx("td",{className:"py-2 pr-4",children:s.kabupaten_files_count}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a}),e.jsx(C,{value:r.required?r.approved/r.required*100:0,className:"h-2 w-32"})]})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{asChild:!0,variant:"outline",size:"sm",className:"border-green-200 text-green-700 hover:bg-green-50",children:e.jsx(u,{to:`/pengajuan/${s.id}`,children:"Detail"})}),e.jsx(m,{asChild:!0,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:e.jsx(u,{to:`/admin-wilayah/upload/${s.id}`,children:"Upload Kanwil"})}),e.jsx(m,{size:"sm",disabled:!t||v===s.id,onClick:()=>R(s.id),className:"bg-blue-600 hover:bg-blue-700 text-white",children:v===s.id?"Mengajukan...":"Ajukan ke Superadmin"})]})})]},s.id)})})]})})})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(c,{children:"Recent Uploads"})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(g,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Belum ada file yang diupload"})]}):f.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.pengajuan.pegawai.nama}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.pengajuan.jenis_jabatan," â€¢ ",s.file_type]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:s.status==="approved"?"default":"secondary",children:s.status}),e.jsx(m,{size:"sm",variant:"outline",asChild:!0,children:e.jsx(u,{to:`/admin-wilayah/upload/${s.pengajuan.id}`,children:e.jsx(q,{className:"h-4 w-4"})})})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:["Uploaded by: ",e.jsx("strong",{children:s.uploaded_by_name}),"(",s.uploaded_by_office,") - ",E(s.uploaded_at)]})]},s.id))})})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(c,{children:"Quick Actions"})}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{asChild:!0,className:"flex-1",children:e.jsxs(u,{to:"/admin-wilayah/pengajuan",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"View All Pengajuan"]})}),e.jsxs(m,{variant:"outline",className:"flex-1",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]})})]})]})})};export{Y as default};
//# sourceMappingURL=AdminWilayahDashboard-BhDMgFaY.js.map
