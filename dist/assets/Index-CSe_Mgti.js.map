{"version":3,"file":"Index-CSe_Mgti.js","sources":["../../src/pages/Index.tsx"],"sourcesContent":["\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Eye, EyeOff, Loader2, CheckCircle, XCircle } from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\n\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\n  const [showErrorModal, setShowErrorModal] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const { login, isAuthenticated } = useAuth();\n  const navigate = useNavigate();\n\n  // Redirect if already authenticated\n  React.useEffect(() => {\n    if (isAuthenticated) {\n      navigate('/dashboard');\n    }\n  }, [isAuthenticated, navigate]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Prevent multiple submissions\n    if (isLoading) return;\n    \n    // Reset states before submission\n    setIsLoading(true);\n    setShowErrorModal(false);\n    setShowSuccessModal(false);\n\n    try {\n      await login(email, password);\n      setShowSuccessModal(true);\n    } catch (error: any) {\n      console.error('Login error:', error);\n      \n      // Handle different types of errors\n      let errorMsg = 'Email atau password yang Anda masukkan tidak sesuai. Silakan periksa kembali kredensial Anda.';\n      \n      if (error.message) {\n        if (error.message.includes('Terlalu banyak percobaan login')) {\n          errorMsg = error.message; // Use the specific rate limit message\n        } else if (error.message.includes('Email atau password salah')) {\n          errorMsg = 'Email atau password salah. Silakan periksa kembali kredensial Anda.';\n        } else {\n          errorMsg = error.message;\n        }\n      }\n      \n      setErrorMessage(errorMsg);\n      // Use setTimeout to ensure state update happens after current execution\n      setTimeout(() => {\n        setShowErrorModal(true);\n      }, 0);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md shadow-xl relative z-10\">\n        <CardHeader className=\"text-center space-y-4\">\n          <div className=\"flex justify-center\">\n            <img\n              src={import.meta.env.BASE_URL + 'logo-kemenag.png'}\n              alt=\"Logo Kementerian Agama\"\n              className=\"w-16 h-16 object-contain\"\n            />\n          </div>\n          <CardTitle className=\"text-2xl font-bold text-gray-900\">\n            Si Imut â€” Sistem Informasi Mutasi\n          </CardTitle>\n          <CardDescription className=\"text-base text-gray-600\">\n            Kanwil Kemenag Provinsi NTB\n          </CardDescription>\n        </CardHeader>\n        \n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4 relative\" onKeyDown={(e) => {\n            // Prevent any default browser behavior that might interfere\n            if (e.key === 'Enter' && isLoading) {\n              e.preventDefault();\n            }\n          }}>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder=\"nama@kemenag.go.id\"\n                required\n                className=\"h-11 relative z-20\"\n                autoComplete=\"email\"\n                autoFocus\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <div className=\"relative\">\n                <Input\n                  id=\"password\"\n                  type={showPassword ? 'text' : 'password'}\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  placeholder=\"Masukkan password\"\n                  required\n                  className=\"h-11 pr-10 relative z-20\"\n                  autoComplete=\"current-password\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors z-30\"\n                  tabIndex={-1}\n                >\n                  {showPassword ? (\n                    <EyeOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            <Button\n              type=\"submit\"\n              className=\"w-full h-11 text-base font-medium bg-green-600 hover:bg-green-700 text-white relative z-20 disabled:opacity-50 disabled:cursor-not-allowed\"\n              disabled={isLoading || !email || !password}\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin text-green-600\" />\n                  Sedang masuk...\n                </>\n              ) : (\n                'Masuk'\n              )}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n\n      {/* Success Modal */}\n      <Dialog open={showSuccessModal} onOpenChange={setShowSuccessModal}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <CheckCircle className=\"w-5 h-5 text-green-500\" />\n              Login Berhasil\n            </DialogTitle>\n            <DialogDescription>\n              Selamat datang kembali! Anda akan dialihkan ke dashboard.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-end\">\n            <Button \n              onClick={() => {\n                setShowSuccessModal(false);\n                navigate('/dashboard');\n              }}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              Lanjutkan\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Error Modal */}\n      <Dialog open={showErrorModal} onOpenChange={(open) => {\n        // Only allow closing via buttons, not by clicking outside\n        if (!open) {\n          setShowErrorModal(false);\n        }\n      }}>\n        <DialogContent className=\"sm:max-w-md\" onPointerDownOutside={(e) => e.preventDefault()}>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2 text-red-600\">\n              <XCircle className=\"w-6 h-6 text-red-500\" />\n              Login Gagal\n            </DialogTitle>\n            <DialogDescription className=\"text-left space-y-3\">\n              <p className=\"text-red-600 font-medium\">\n                {errorMessage}\n              </p>\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 space-y-2\">\n                <p className=\"text-sm text-red-700 font-medium\">Saran untuk mengatasi masalah:</p>\n                <ul className=\"text-sm text-red-600 space-y-1 list-disc list-inside\">\n                  <li>Pastikan email yang dimasukkan sudah benar</li>\n                  <li>Periksa kembali password Anda</li>\n                  <li>Pastikan Caps Lock tidak aktif</li>\n                  <li>Hubungi admin jika masalah berlanjut</li>\n                </ul>\n              </div>\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-end space-x-2\">\n            <Button \n              onClick={() => {\n                setShowErrorModal(false);\n                setPassword(''); // Clear password field\n              }}\n              variant=\"outline\"\n              className=\"border-red-200 text-red-600 hover:bg-red-50\"\n            >\n              Coba Lagi\n            </Button>\n            <Button \n              onClick={() => setShowErrorModal(false)}\n              className=\"bg-red-600 hover:bg-red-700 text-white\"\n            >\n              Tutup\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default Login;\n"],"names":["Login","email","setEmail","useState","password","setPassword","showPassword","setShowPassword","isLoading","setIsLoading","showSuccessModal","setShowSuccessModal","showErrorModal","setShowErrorModal","errorMessage","setErrorMessage","login","isAuthenticated","useAuth","navigate","useNavigate","React","handleSubmit","e","error","errorMsg","jsxs","Card","CardHeader","jsx","CardTitle","CardDescription","CardContent","Label","Input","EyeOff","Eye","Button","Fragment","Loader2","Dialog","DialogContent","DialogHeader","DialogTitle","CheckCircle","DialogDescription","open","XCircle"],"mappings":"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"}