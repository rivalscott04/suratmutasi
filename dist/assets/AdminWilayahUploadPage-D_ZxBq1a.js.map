{"version":3,"file":"AdminWilayahUploadPage-D_ZxBq1a.js","sources":["../../src/components/AdminWilayahFileUpload.tsx","../../src/components/UploadProgressTracker.tsx","../../src/pages/AdminWilayahUploadPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Upload, FileText, CheckCircle, XCircle, AlertCircle, Send, RefreshCw, Eye, Download, Edit, Loader2 } from 'lucide-react';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport FileUploadProgress from '@/components/FileUploadProgress';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { apiGet, apiPost } from '@/lib/api';\nimport { useToast } from '@/hooks/use-toast';\nimport { useFormSubmissionProtection } from '@/hooks/useDoubleClickProtection';\nimport { SubmitButton } from '@/components/ui/protected-button';\nimport { showSuccess, showError, showUploadSuccess, showUploadError, showDownloadError } from '@/lib/messageUtils';\n\n// Normalize any text to a safe DOM id segment\nconst toSafeId = (raw: string): string => {\n  return String(raw)\n    .toLowerCase()\n    .replace(/[^a-z0-9_-]+/gi, '_')\n    .replace(/^_+|_+$/g, '');\n};\n\ninterface AdminWilayahFileConfig {\n  id: number;\n  jenis_jabatan_id: number;\n  file_type: string;\n  display_name: string;\n  is_required: boolean;\n  description?: string;\n  is_active: boolean;\n}\n\ninterface PengajuanFile {\n  id: string;\n  pengajuan_id: string;\n  file_type: string;\n  file_name: string;\n  file_path: string;\n  file_size: number;\n  verification_status: string;\n  verification_notes?: string;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface AdminWilayahFileUploadProps {\n  pengajuanId: string;\n  jenisJabatanId: string;\n  onFilesUploaded: (files: PengajuanFile[]) => void;\n  onProgressChange?: (uploaded: number, total: number) => void;\n  pengajuanStatus?: string;\n  pengajuanData?: any; // Data pengajuan untuk validasi jabatan\n}\n\nconst AdminWilayahFileUpload: React.FC<AdminWilayahFileUploadProps> = ({\n  pengajuanId,\n  jenisJabatanId,\n  onFilesUploaded,\n  onProgressChange,\n  pengajuanStatus,\n  pengajuanData\n}) => {\n  const { token, user } = useAuth();\n  const { toast } = useToast();\n  const [requiredFiles, setRequiredFiles] = useState<AdminWilayahFileConfig[]>([]);\n  const [uploadedFiles, setUploadedFiles] = useState<PengajuanFile[]>([]);\n  const [availableJobTypes, setAvailableJobTypes] = useState<string[]>([]);\n  const [selectedVariant, setSelectedVariant] = useState<string>('');\n  const [uploading, setUploading] = useState<{ [key: string]: boolean }>({});\n  const [uploadProgress, setUploadProgress] = useState<{ [key: string]: number }>({});\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const { submitForm, isSubmitting } = useFormSubmissionProtection();\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Drag and drop state\n  const [dragOver, setDragOver] = useState<string | null>(null);\n  const [isDragActive, setIsDragActive] = useState(false);\n  \n  // Error modal state\n  const [showErrorModal, setShowErrorModal] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [errorTitle, setErrorTitle] = useState<string>('Error');\n\n  // Fetch admin wilayah file configuration\n  const fetchFileConfigs = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // jenisJabatanId bisa berupa nama jabatan atau ID\n      let jobTypeId: number;\n      \n      if (isNaN(Number(jenisJabatanId))) {\n        // Jika berupa nama jabatan, cari ID-nya\n        try {\n          const jobTypeRes = await apiGet('/api/job-type-configurations', token);\n          if (jobTypeRes?.success && Array.isArray(jobTypeRes.data)) {\n            const jobType = jobTypeRes.data.find((jt: any) => jt.jenis_jabatan === jenisJabatanId);\n            if (jobType) {\n              jobTypeId = jobType.id;\n            } else {\n              setError('Jenis jabatan tidak ditemukan');\n              return;\n            }\n          } else {\n            setError('Gagal mengambil data jenis jabatan');\n            return;\n          }\n        } catch (error) {\n          setError('Gagal mencari jenis jabatan');\n          return;\n        }\n      } else {\n        jobTypeId = parseInt(String(jenisJabatanId));\n      }\n      \n      const response = await apiGet(`/api/admin-wilayah-file-config/job-type/${jobTypeId}`, token);\n      \n      console.log('🔍 API Response:', response);\n      console.log('🔍 Job Type ID:', jobTypeId);\n      console.log('🔍 Jenis Jabatan ID:', jenisJabatanId);\n      \n      if (response.success) {\n        console.log('✅ Setting required files:', response.data);\n        setRequiredFiles(response.data);\n        // Notify parent about total required files (uploaded may be known later)\n        if (onProgressChange) {\n          const uploadedCount = uploadedFiles.filter(f => response.data.some((c: any) => c.file_type === f.file_type)).length;\n          onProgressChange(uploadedCount, response.data.length || 0);\n        }\n      } else {\n        setError('Failed to fetch file configurations');\n      }\n    } catch (error) {\n      console.error('Error fetching file configs:', error);\n      setError('Error connecting to server');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fetch list of job types that have admin wilayah configs (for guidance)\n  const fetchAvailableJobTypes = async () => {\n    try {\n      const res = await apiGet('/api/admin-wilayah-file-config', token);\n      if (res?.success && Array.isArray(res.data)) {\n        const names = Array.from(new Set(res.data.map((c: any) => {\n          const jobType = c.jenis_jabatan_id || c.jenis_jabatan?.jenis_jabatan;\n          return typeof jobType === 'string' ? jobType : String(jobType);\n        }).filter(Boolean))) as string[];\n        setAvailableJobTypes(names);\n      } else {\n        setAvailableJobTypes([]);\n      }\n    } catch {\n      setAvailableJobTypes([]);\n    }\n  };\n\n  // Fetch existing uploaded files (admin wilayah category) untuk pengajuan ini\n  const fetchUploadedFiles = async () => {\n    try {\n      const res = await apiGet(`/api/admin-wilayah/pengajuan/${pengajuanId}`, token);\n      if (res?.success) {\n        const awFiles = (res.uploadedAdminWilayahFiles || res.data?.uploadedAdminWilayahFiles || []) as any[];\n        const mapped: PengajuanFile[] = awFiles.map((f: any) => ({\n          id: f.id,\n          pengajuan_id: pengajuanId,\n          file_type: f.file_type,\n          file_name: f.file_name,\n          file_path: f.file_path,\n          file_size: f.file_size,\n          verification_status: f.verification_status || 'pending',\n          created_at: f.created_at,\n          updated_at: f.updated_at\n        }));\n        setUploadedFiles(mapped);\n      } else {\n      setUploadedFiles([]);\n      }\n    } catch (error) {\n      console.error('Error fetching uploaded files:', error);\n      setUploadedFiles([]);\n    }\n  };\n\n  useEffect(() => {\n    if (jenisJabatanId) {\n      fetchFileConfigs();\n      fetchUploadedFiles();\n    }\n  }, [jenisJabatanId, token]);\n\n  // Keep parent informed when lists change (must be before any early return)\n  useEffect(() => {\n    if (onProgressChange) {\n      const totalRequired = requiredFiles.length;\n      const uploadedCount = uploadedFiles.filter(f => requiredFiles.some(r => r.file_type === f.file_type)).length;\n      onProgressChange(uploadedCount, totalRequired);\n    }\n  }, [requiredFiles, uploadedFiles]);\n\n  const handleFileUpload = async (fileType: string, file: File) => {\n    console.log('🚀 START UPLOAD - fileType:', fileType, 'fileName:', file.name);\n    setUploading(prev => ({ ...prev, [fileType]: true }));\n    setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\n    \n    try {\n      // Block upload if jabatan mismatch\n      if (!guardJabatanMatch()) {\n        setUploading(prev => ({ ...prev, [fileType]: false }));\n        setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\n        return;\n      }\n      // Debug logging\n      console.log('🔍 Uploading file:', {\n        fileType,\n        fileName: file.name,\n        pengajuanId,\n        jenisJabatanId,\n        requiredFiles: requiredFiles.map(f => ({ file_type: f.file_type, display_name: f.display_name }))\n      });\n      \n      // Create FormData for file upload\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('pengajuan_id', pengajuanId);\n      formData.append('file_type', fileType);\n      formData.append('file_category', 'admin_wilayah');\n      formData.append('uploaded_by_role', 'admin_wilayah');\n      formData.append('uploaded_by_name', user?.full_name || 'Admin Wilayah');\n      formData.append('uploaded_by_office', 'Kanwil Provinsi');\n      \n      // Debug FormData\n      console.log('📦 FormData created:', {\n        file: file.name,\n        pengajuan_id: pengajuanId,\n        file_type: fileType,\n        file_category: 'admin_wilayah'\n      });\n      \n      // Check if FormData is properly created\n      for (let [key, value] of formData.entries()) {\n        console.log('📋 FormData entry:', key, value);\n      }\n\n      // Simulate upload progress\n      const progressInterval = setInterval(() => {\n        setUploadProgress(prev => {\n          const current = prev[fileType] || 0;\n          if (current < 90) {\n            return { ...prev, [fileType]: current + Math.random() * 20 };\n          }\n          return prev;\n        });\n      }, 200);\n\n      // Upload file to backend\n      const response = await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/upload`, formData, token);\n      \n      // Complete progress\n      clearInterval(progressInterval);\n      setUploadProgress(prev => ({ ...prev, [fileType]: 100 }));\n      \n      if (response.success) {\n        const newFile: PengajuanFile = {\n          id: response.data.id,\n          pengajuan_id: pengajuanId,\n          file_type: fileType,\n          file_name: file.name,\n          file_path: response.data.file_path,\n          file_size: file.size,\n          verification_status: 'pending',\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        };\n        \n        const nextFiles = [...uploadedFiles, newFile];\n        setUploadedFiles(nextFiles);\n        onFilesUploaded(nextFiles);\n        if (onProgressChange) {\n          const totalRequired = requiredFiles.length;\n          const uploadedCount = nextFiles.filter(f => requiredFiles.some(r => r.file_type === f.file_type)).length;\n          onProgressChange(uploadedCount, totalRequired);\n        }\n        \n        toast({\n          title: \"Success\",\n          description: `Upload berhasil: ${file.name}`,\n          variant: \"default\",\n          duration: 3000\n        });\n      } else {\n        const errorMsg = response.message || \"Terjadi kesalahan saat mengupload file. Silakan coba lagi.\";\n        showErrorModalHandler('Upload Gagal', errorMsg);\n      }\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      showErrorModalHandler('Upload Gagal', 'Terjadi kesalahan saat mengupload file. Periksa koneksi internet Anda dan coba lagi.');\n    } finally {\n      setUploading(prev => ({ ...prev, [fileType]: false }));\n      setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\n    }\n  };\n\n  const handleSubmitForReview = async () => {\n    submitForm(\n      async () => {\n        // Submit logic here\n        showSuccess('SUBMIT_SUCCESS', 'File berhasil diajukan ke Superadmin');\n        setShowSubmitDialog(false);\n      },\n      () => {\n        // onSuccess - already handled above\n      },\n      (error) => {\n        // onError\n        showError('OPERATION_FAILED', 'Gagal mengajukan file ke Superadmin');\n      }\n    );\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  const formatRelativeTime = (isoString: string) => {\n    const now = Date.now();\n    const then = new Date(isoString).getTime();\n    const diff = Math.max(0, Math.floor((now - then) / 1000));\n    if (diff < 5) return 'baru saja';\n    if (diff < 60) return `${diff} detik lalu`;\n    const minutes = Math.floor(diff / 60);\n    if (minutes < 60) return `${minutes} menit lalu`;\n    const hours = Math.floor(minutes / 60);\n    if (hours < 24) return `${hours} jam lalu`;\n    const days = Math.floor(hours / 24);\n    return `${days} hari lalu`;\n  };\n\n  const getFileStatus = (fileType: string) => {\n    const file = uploadedFiles.find(f => f.file_type === fileType);\n    return file ? 'uploaded' : 'pending';\n  };\n\n  const getUploadedFile = (fileType: string) => {\n    return uploadedFiles.find(f => f.file_type === fileType);\n  };\n\n  // Function to get job type specific descriptions\n  const getJobTypeSpecificDescription = (jobType: string, fileType: string) => {\n    const jobTypeDescriptions: { [key: string]: { [key: string]: string } } = {\n      'Guru': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Kepala Madrasah': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Wakil Kepala Madrasah': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Kepala TU': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Kepala Seksi': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Kepala Sub Bagian': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Kepala Urusan': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Staff': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      },\n      'Pelaksana': {\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\n      }\n    };\n\n    return jobTypeDescriptions[jobType]?.[fileType] || null;\n  };\n\n  // Function to get descriptive label for file types based on job type\n  const getDescriptiveLabel = (fileConfig: AdminWilayahFileConfig) => {\n    const { file_type, display_name } = fileConfig;\n    \n    // Special handling for Surat Rekomendasi dari Instansi Pembina variants\n    if (file_type === 'surat_rekomendasi_kanwil') {\n      // Get job type specific description\n      const jobTypeSpecificDescription = getJobTypeSpecificDescription(jenisJabatanId, file_type);\n      return jobTypeSpecificDescription || 'Surat Rekomendasi dari Instansi Pembina - Varian 6.1-6.9';\n    }\n    \n    // Get job type specific description for other file types\n    const jobTypeSpecificDescription = getJobTypeSpecificDescription(jenisJabatanId, file_type);\n    if (jobTypeSpecificDescription) {\n      return jobTypeSpecificDescription;\n    }\n    \n    // Default fallback\n    return display_name;\n  };\n\n  // Preview file in new tab using auth token\n  const handlePreview = async (file: PengajuanFile) => {\n    try {\n      const res = await fetch(`/api/pengajuan/files/${file.id}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      if (!res.ok) throw new Error('Gagal mengambil file');\n      const blob = await res.blob();\n      const url = URL.createObjectURL(blob);\n      window.open(url, '_blank');\n      // Revoke later to avoid memory leak\n      setTimeout(() => URL.revokeObjectURL(url), 5000);\n    } catch (e) {\n      showError('OPERATION_FAILED', 'Gagal membuka preview file');\n    }\n  };\n\n  const handleDownload = async (file: PengajuanFile) => {\n    try {\n      const res = await fetch(`/api/pengajuan/files/${file.id}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      if (!res.ok) throw new Error('Gagal mengambil file');\n      const blob = await res.blob();\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = file.file_name || 'file.pdf';\n      document.body.appendChild(a);\n      a.click();\n      a.remove();\n      setTimeout(() => URL.revokeObjectURL(url), 5000);\n    } catch (e) {\n      showDownloadError('Gagal mengunduh file');\n    }\n  };\n\n  const triggerReplace = (fileType: string) => {\n    const input = document.getElementById(`replace-${toSafeId(fileType)}`) as HTMLInputElement | null;\n    if (input) input.click();\n  };\n\n  // Guard: ensure selected job type matches operator's submitted job\n  const guardJabatanMatch = (): boolean => {\n    if (!pengajuanData?.jabatan_name || !jenisJabatanId) return true;\n    const operatorJabatan = String(pengajuanData.jabatan_name).toLowerCase();\n    const adminSelectedJabatan = String(jenisJabatanId).toLowerCase();\n    if (operatorJabatan !== adminSelectedJabatan) {\n      showErrorModalHandler(\n        'Jabatan Tidak Sesuai',\n        `Jenis jabatan yang Anda pilih tidak sama dengan yang diajukan oleh operator.\\n\\n` +\n          `• Diajukan operator: ${pengajuanData.jabatan_name}\\n` +\n          `• Dipilih admin wilayah: ${jenisJabatanId}\\n\\n` +\n          `Silakan pilih jenis jabatan yang sesuai terlebih dahulu, lalu ulangi upload.`\n      );\n      return false;\n    }\n    return true;\n  };\n\n  // Function to show error modal\n  const showErrorModalHandler = (title: string, message: string) => {\n    setErrorTitle(title);\n    setErrorMessage(message);\n    setShowErrorModal(true);\n  };\n\n  // Drag and drop handlers\n  const handleDragEnter = (fileType: string, event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setDragOver(fileType);\n    setIsDragActive(true);\n  };\n\n  const handleDragLeave = (fileType: string, event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    // Only clear drag state if leaving the drop zone entirely\n    if (!event.currentTarget.contains(event.relatedTarget as Node)) {\n      setDragOver(null);\n      setIsDragActive(false);\n    }\n  };\n\n  const handleDragOver = (event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  const handleDrop = (fileType: string, event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    \n    // Block upload if jabatan mismatch\n    if (!guardJabatanMatch()) {\n      setDragOver(null);\n      setIsDragActive(false);\n      return;\n    }\n\n    const files = event.dataTransfer.files;\n    if (files && files.length > 0) {\n      const file = files[0];\n      \n      // Validate file type\n      const allowedTypes = ['.pdf', '.doc', '.docx'];\n      const fileExtension = '.' + file.name.split('.').pop()?.toLowerCase();\n      \n      if (!allowedTypes.includes(fileExtension)) {\n        showErrorModalHandler('Format File Tidak Didukung', 'Hanya file PDF, DOC, dan DOCX yang diizinkan untuk diupload.');\n        setDragOver(null);\n        setIsDragActive(false);\n        return;\n      }\n      \n      // Validate file size\n      const maxSize = fileType === 'skp_2_tahun_terakhir' ? 1.6 * 1024 * 1024 : 500 * 1024; // 1.6MB or 500KB\n      if (file.size > maxSize) {\n        const maxSizeText = fileType === 'skp_2_tahun_terakhir' ? '1.6MB' : '500KB';\n        showErrorModalHandler('Ukuran File Terlalu Besar', `Ukuran file maksimal ${maxSizeText}. Silakan kompres file atau pilih file yang lebih kecil.`);\n        setDragOver(null);\n        setIsDragActive(false);\n        return;\n      }\n      \n      // Upload the file\n      handleFileUpload(fileType, file);\n    }\n    \n    setDragOver(null);\n    setIsDragActive(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"animate-pulse space-y-4\">\n          <div className=\"h-6 bg-gray-200 rounded w-1/3\"></div>\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"h-20 bg-gray-200 rounded\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"text-center py-8\">\n          <AlertCircle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Error Loading Files</h3>\n          <p className=\"text-gray-600 mb-4\">{error}</p>\n          <Button onClick={fetchFileConfigs} className=\"flex items-center gap-2\">\n            <RefreshCw className=\"h-4 w-4\" />\n            Retry\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-semibold\">Upload File Admin Wilayah</h2>\n        <Button onClick={() => { fetchFileConfigs(); fetchUploadedFiles(); }} variant=\"outline\" size=\"sm\">\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          Refresh\n        </Button>\n      </div>\n\n      {/* Semua Dokumen Wajib Admin Wilayah */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Dokumen Wajib Admin Wilayah</h3>\n          <div className=\"text-sm text-gray-600\">\n            {(() => {\n              const uploadedCount = requiredFiles.filter(fileConfig => \n                uploadedFiles.some(uploadedFile => uploadedFile.file_type === fileConfig.file_type)\n              ).length;\n              return `${uploadedCount}/${requiredFiles.length} berkas sudah diupload`;\n            })()}\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3\">\n          {requiredFiles.map((fileConfig) => {\n            console.log('🔧 Rendering fileConfig:', fileConfig);\n            const status = getFileStatus(fileConfig.file_type);\n            const uploadedFile = getUploadedFile(fileConfig.file_type);\n            \n            return (\n              <Card key={fileConfig.id} className=\"border border-gray-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex flex-col gap-3\">\n                    {/* Title and Status */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <h4 className=\"font-medium text-gray-900 text-sm leading-tight\" title={getDescriptiveLabel(fileConfig)}>\n                          {getDescriptiveLabel(fileConfig)}\n                        </h4>\n                        {fileConfig.is_required && (\n                          <Badge variant=\"destructive\" className=\"text-[10px] py-0 px-1.5\">Wajib</Badge>\n                        )}\n                      </div>\n                      \n                      {/* Status Badge */}\n                      {status === 'uploaded' ? (\n                        <Badge className=\"bg-green-600 text-white flex items-center gap-1 text-xs\">\n                          <CheckCircle className=\"h-3 w-3\" />\n                          Uploaded\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"secondary\" className=\"flex items-center gap-1 text-xs\">\n                          <FileText className=\"h-3 w-3\" />\n                          Pending\n                        </Badge>\n                      )}\n                    </div>\n                    \n                    {/* File info and upload area */}\n                    <div className=\"space-y-2\">\n                      {/* File requirements */}\n                      <p className=\"text-xs text-gray-500\">\n                        PDF (maks. {fileConfig.file_type === 'skp_2_tahun_terakhir' ? '1.6MB' : '500KB'})\n                      </p>\n                      \n                      {/* Upload Progress */}\n                      {uploading[fileConfig.file_type] && (\n                        <div className=\"flex items-center gap-2 text-xs\">\n                          <div className=\"animate-spin h-3 w-3 border border-green-600 border-t-transparent rounded-full\" />\n                          <span className=\"text-green-600\">Uploading... {uploadProgress[fileConfig.file_type] || 0}%</span>\n                        </div>\n                      )}\n                      \n                      {/* Uploaded File Info */}\n                      {status === 'uploaded' && uploadedFile && (\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center gap-1 text-green-600 text-xs\">\n                            <CheckCircle className=\"h-3 w-3\" />\n                            <span className=\"truncate\">{uploadedFile.file_name}</span>\n                            <span className=\"text-gray-500\">({formatFileSize(uploadedFile.file_size)})</span>\n                          </div>\n                          <div className=\"flex gap-1\">\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handlePreview(uploadedFile)} className=\"h-6 px-2 text-xs\">\n                              <Eye className=\"h-3 w-3\" />\n                            </Button>\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownload(uploadedFile)} className=\"h-6 px-2 text-xs\">\n                              <Download className=\"h-3 w-3\" />\n                            </Button>\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => triggerReplace(fileConfig.file_type)} className=\"h-6 px-2 text-xs\">\n                              <Edit className=\"h-3 w-3\" />\n                            </Button>\n                            <input\n                              id={`replace-${toSafeId(fileConfig.file_type)}`}\n                              type=\"file\"\n                              className=\"hidden\"\n                              accept=\".pdf,.doc,.docx\"\n                              onChange={(e) => {\n                                const file = e.target.files?.[0];\n                                if (file) {\n                                  handleFileUpload(fileConfig.file_type, file);\n                                  e.target.value = '';\n                                }\n                              }}\n                            />\n                          </div>\n                        </div>\n                      )}\n                      \n                      {/* Drag and Drop Zone */}\n                      {status !== 'uploaded' && (\n                        <div\n                          className={`relative border-2 border-dashed rounded-lg p-6 transition-all duration-200 cursor-pointer w-full h-32 ${\n                            dragOver === fileConfig.file_type\n                              ? 'border-green-500 bg-green-50'\n                              : 'border-gray-300 hover:border-green-400 hover:bg-gray-50'\n                          } ${uploading[fileConfig.file_type] ? 'pointer-events-none opacity-50' : ''}`}\n                          onDragEnter={(e) => handleDragEnter(fileConfig.file_type, e)}\n                          onDragLeave={(e) => handleDragLeave(fileConfig.file_type, e)}\n                          onDragOver={handleDragOver}\n                          onDrop={(e) => handleDrop(fileConfig.file_type, e)}\n                          onClick={() => {\n                            const input = document.getElementById(`file-${toSafeId(fileConfig.file_type)}`) as HTMLInputElement | null;\n                            if (input && !input.disabled && !uploading[fileConfig.file_type]) input.click();\n                          }}\n                        >\n                          <div className=\"flex flex-col items-center justify-center h-full text-center\">\n                            {uploading[fileConfig.file_type] ? (\n                              <>\n                                <div className=\"animate-spin h-6 w-6 border-2 border-green-600 border-t-transparent rounded-full mb-2\" />\n                                <p className=\"text-sm text-green-600 font-medium\">Uploading...</p>\n                              </>\n                            ) : dragOver === fileConfig.file_type ? (\n                              <>\n                                <Upload className=\"h-8 w-8 text-green-500 mb-2\" />\n                                <p className=\"text-sm text-green-600 font-medium\">Lepaskan file di sini</p>\n                              </>\n                            ) : (\n                              <>\n                                <Upload className=\"h-6 w-6 text-gray-400 mb-2\" />\n                                <p className=\"text-xs text-gray-600 leading-tight\">Drag & drop file di sini atau klik untuk memilih</p>\n                              </>\n                            )}\n                          </div>\n                          \n                          {/* Hidden file input */}\n                          <input\n                            type=\"file\"\n                            accept=\".pdf,.doc,.docx\"\n                            onChange={(e) => {\n                              console.log('📁 File input changed:', e.target.files);\n                              const file = e.target.files?.[0];\n                              if (file) {\n                                console.log('📄 File selected:', file.name, 'fileConfig.file_type:', fileConfig.file_type);\n                                handleFileUpload(fileConfig.file_type, file);\n                                e.target.value = '';\n                              } else {\n                                console.log('❌ No file selected');\n                              }\n                            }}\n                            className=\"hidden\"\n                            id={`file-${toSafeId(fileConfig.file_type)}`}\n                          />\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      </div>\n\n\n\n      {/* Submit Button */}\n      {(() => {\n        const allRequiredUploaded = requiredFiles.every(fileConfig => \n          uploadedFiles.some(uploadedFile => uploadedFile.file_type === fileConfig.file_type)\n        );\n        const isAlreadySubmitted = pengajuanStatus === 'submitted';\n        \n        return (\n          <div className=\"flex justify-end\">\n            {allRequiredUploaded ? (\n              <Button \n                onClick={() => !isAlreadySubmitted && setShowSubmitDialog(true)} \n                className=\"bg-green-600 hover:bg-green-700\"\n                disabled={submitting || isAlreadySubmitted}\n              >\n                <Send className=\"h-4 w-4 mr-2\" />\n                {isAlreadySubmitted ? 'Sudah Dikirim' : 'Ajukan ke Superadmin'}\n              </Button>\n            ) : (\n              <div className=\"text-sm text-gray-500 text-center\">\n                Tombol ajukan akan muncul setelah semua berkas wajib diupload\n              </div>\n            )}\n          </div>\n        );\n      })()}\n\n      {/* Submit Confirmation Dialog - Menggunakan AlertDialog sesuai tema */}\n      <AlertDialog open={showSubmitDialog} onOpenChange={setShowSubmitDialog}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Ajukan ke Superadmin</AlertDialogTitle>\n            <AlertDialogDescription>\n              Apakah Anda yakin ingin mengajukan semua file yang telah diupload ke Superadmin? Tindakan ini tidak dapat dibatalkan.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel disabled={submitting}>Batal</AlertDialogCancel>\n            <AlertDialogAction asChild>\n              <SubmitButton\n                onClick={handleSubmitForReview}\n                className=\"bg-green-600 hover:bg-green-700\"\n                isProcessing={isSubmitting}\n                processingText=\"Mengajukan...\"\n              >\n                Ajukan\n              </SubmitButton>\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Error Modal */}\n      <AlertDialog open={showErrorModal} onOpenChange={setShowErrorModal}>\n        <AlertDialogContent className=\"max-w-md\">\n          <AlertDialogHeader>\n            <AlertDialogTitle className=\"flex items-center gap-2 text-red-600 text-lg\">\n              <XCircle className=\"h-5 w-5\" />\n              {errorTitle}\n            </AlertDialogTitle>\n            <AlertDialogDescription className=\"text-gray-700 whitespace-pre-line leading-relaxed\">\n              {errorMessage}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogAction \n              onClick={() => setShowErrorModal(false)}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              Tutup\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n};\n\nexport default AdminWilayahFileUpload;\n","import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, Upload, Clock } from 'lucide-react';\r\n\r\ninterface UploadProgressTrackerProps {\r\n  uploaded: number;\r\n  total: number;\r\n  isComplete: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst UploadProgressTracker: React.FC<UploadProgressTrackerProps> = ({\r\n  uploaded,\r\n  total,\r\n  isComplete,\r\n  className = ''\r\n}) => {\r\n  const percentage = total > 0 ? Math.round((uploaded / total) * 100) : 0;\r\n\r\n  return (\r\n    <div className={`bg-white border border-gray-200 rounded-lg p-4 ${className}`}>\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Progress Upload Dokumen</h3>\r\n        <div className=\"text-right\">\r\n          <div className=\"text-sm text-gray-600\">\r\n            {uploaded} dari {total} dokumen\r\n          </div>\r\n          <div className=\"text-lg font-bold text-green-600\">\r\n            {percentage}%\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Progress Bar */}\r\n      <div className=\"mb-4\">\r\n        <Progress \r\n          value={percentage} \r\n          className=\"h-3 bg-gray-200\"\r\n        />\r\n      </div>\r\n      \r\n      {/* Status Breakdown */}\r\n      <div className=\"flex items-center gap-6 text-sm\">\r\n        <div className=\"flex items-center gap-2 text-green-600\">\r\n          <CheckCircle className=\"h-4 w-4\" />\r\n          <span>{uploaded} Terupload</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-2 text-gray-500\">\r\n          <Clock className=\"h-4 w-4\" />\r\n          <span>{total - uploaded} Belum</span>\r\n        </div>\r\n        {isComplete && (\r\n          <div className=\"flex items-center gap-2 text-green-600 font-medium\">\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            <span>Upload Selesai</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadProgressTracker;\r\n","import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { ArrowLeft, FileText, User, Calendar, MapPin, CheckCircle, XCircle, Send, ChevronDown, Loader2 } from 'lucide-react';\nimport { useFormSubmissionProtection } from '@/hooks/useDoubleClickProtection';\nimport { SubmitButton } from '@/components/ui/protected-button';\nimport { PageHeader } from '@/components/PageHeader';\nimport AdminWilayahFileUpload from '@/components/AdminWilayahFileUpload';\nimport UploadProgressTracker from '@/components/UploadProgressTracker';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { apiGet, apiPost } from '@/lib/api';\n\ninterface PengajuanDetail {\n  id: string;\n  jenis_jabatan: number;\n  status: string;\n  created_at: string;\n  updated_at: string;\n  pegawai?: { nama: string; nip: string };\n  office?: { id: string; name: string; kabkota: string };\n}\n\nconst AdminWilayahUploadPage: React.FC = () => {\n  const { pengajuanId } = useParams<{ pengajuanId: string }>();\n  const navigate = useNavigate();\n  const { token } = useAuth();\n  const [pengajuan, setPengajuan] = useState<PengajuanDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const { submitForm, isSubmitting } = useFormSubmissionProtection();\n  const [availableJobTypes, setAvailableJobTypes] = useState<string[]>([]);\n  const [selectedJobType, setSelectedJobType] = useState<string>('');\n  const [uploadProgress, setUploadProgress] = useState<{ required: number; total: number; isComplete: boolean }>({ required: 0, total: 0, isComplete: false });\n\n  const fetchDetail = async () => {\n    if (!token || !pengajuanId) return;\n    setLoading(true);\n    try {\n      const res = await apiGet(`/api/admin-wilayah/pengajuan/${pengajuanId}`, token);\n      if (res && res.success !== false) {\n        // backend returns { success, pengajuan, adminWilayahFileConfig, uploadProgress, ... }\n        setPengajuan(res.pengajuan || res.data?.pengajuan || res);\n        const progress = res.uploadProgress || res.data?.uploadProgress;\n        if (progress) {\n          const uploadedCount = Number(progress.required ?? 0); // backend uses 'required' as uploaded count\n          const totalRequired = Number(progress.total ?? 0);\n          const complete = typeof progress.isComplete === 'boolean' ? progress.isComplete : uploadedCount >= totalRequired;\n          setUploadProgress({\n            required: uploadedCount,\n            total: totalRequired,\n            isComplete: complete\n          });\n        } else {\n          setUploadProgress({ required: 0, total: 0, isComplete: false });\n        }\n      } else {\n        setPengajuan(null);\n        setUploadProgress({ required: 0, total: 0, isComplete: false });\n      }\n    } catch (e) {\n      console.error('Failed to fetch pengajuan detail', e);\n      setPengajuan(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fetch available job types from admin wilayah config\n  const fetchAvailableJobTypes = async () => {\n    try {\n      const res = await apiGet('/api/admin-wilayah-file-config', token);\n      if (res?.success && Array.isArray(res.data)) {\n        // Extract unique job type names with their IDs\n        const jobTypeMap = new Map();\n        res.data.forEach((c: any) => {\n          const jobTypeId = c.jenis_jabatan_id;\n          const jobTypeName = c.jenis_jabatan?.jenis_jabatan || `Jabatan ${jobTypeId}`;\n          if (jobTypeId && !jobTypeMap.has(jobTypeId)) {\n            jobTypeMap.set(jobTypeId, jobTypeName);\n          }\n        });\n        \n        const names = Array.from(jobTypeMap.values());\n        setAvailableJobTypes(names);\n        \n        // Set default selection if available\n        if (names.length > 0 && !selectedJobType) {\n          setSelectedJobType(names[0]);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to fetch job types:', error);\n    }\n  };\n\n  useEffect(() => {\n    fetchDetail();\n    fetchAvailableJobTypes();\n  }, [pengajuanId, token]);\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('id-ID', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getStatusBadge = (status: string, pengajuan?: any) => {\n    // Helper function to determine if this is submitted after admin wilayah approval\n    const isSubmittedAfterAdminWilayah = (status: string, pengajuan?: any) => {\n      if (status !== 'submitted' || !pengajuan) return false;\n      // Only show \"Diajukan Admin Wilayah\" if there are actual admin wilayah files\n      return pengajuan.files?.some((f: any) => f.file_category === 'admin_wilayah') || false;\n    };\n\n    switch (status) {\n      case 'approved':\n        return <Badge className=\"bg-green-600 text-white\">Disetujui Kab/Kota</Badge>;\n      case 'admin_wilayah_approved':\n        return <Badge className=\"bg-green-700 text-white\">Disetujui Admin Wilayah</Badge>;\n      case 'admin_wilayah_rejected':\n        return <Badge className=\"bg-red-600 text-white\">Ditolak Admin Wilayah</Badge>;\n      case 'submitted':\n        return <Badge className=\"bg-blue-600 text-white\">\n          {isSubmittedAfterAdminWilayah(status, pengajuan) ? 'Diajukan Admin Wilayah' : 'Dikirim ke Superadmin'}\n        </Badge>;\n      default:\n        return <Badge className=\"bg-gray-600 text-white\">{status}</Badge>;\n    }\n  };\n\n  const approve = async () => {\n    if (!token || !pengajuanId) return;\n    setSubmitting(true);\n    try {\n      await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/approve`, {}, token);\n      await fetchDetail();\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const reject = async () => {\n    if (!token || !pengajuanId) return;\n    setSubmitting(true);\n    try {\n      await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/reject`, { rejection_reason: 'Ditolak oleh Admin Wilayah' }, token);\n      await fetchDetail();\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const submitToSuperadmin = async () => {\n    if (!token || !pengajuanId) return;\n    \n    submitForm(\n      async () => {\n        await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/submit-to-superadmin`, {}, token);\n        await fetchDetail();\n      },\n      () => {\n        // onSuccess - already handled above\n      },\n      (error) => {\n        // onError - you can add error handling here if needed\n        console.error('Error submitting to superadmin:', error);\n      }\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background p-6\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"animate-pulse space-y-6\">\n            <div className=\"h-8 bg-gray-200 rounded w-1/3\"></div>\n            <div className=\"h-64 bg-gray-200 rounded\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!pengajuan) {\n    return (\n      <div className=\"min-h-screen bg-background p-6\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"text-center py-12\">\n            <FileText className=\"h-16 w-16 mx-auto text-gray-300 mb-4\" />\n            <h2 className=\"text-2xl font-semibold text-gray-900 mb-2\">Pengajuan Tidak Ditemukan</h2>\n            <p className=\"text-gray-600 mb-6\">Pengajuan yang Anda cari tidak ditemukan atau tidak memiliki akses.</p>\n            <Button\n              onClick={() => navigate('/admin-wilayah/dashboard')}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Kembali ke Dashboard\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background p-6\">\n      <div className=\"max-w-6xl mx-auto space-y-6\">\n        {/* Header with Breadcrumb */}\n        <PageHeader\n          title=\"Upload File Admin Wilayah\"\n          subtitle=\"Upload file tambahan untuk pengajuan mutasi pegawai\"\n          actions={\n            <div className=\"flex items-center gap-2\">\n              <Badge className=\"bg-green-100 text-green-800\">Admin Wilayah</Badge>\n              {getStatusBadge(pengajuan.status, pengajuan)}\n              <Button\n                variant=\"outline\"\n                onClick={() => navigate('/admin-wilayah/dashboard')}\n                className=\"border-green-200 text-green-700 hover:bg-green-50\"\n              >\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Kembali\n              </Button>\n            </div>\n          }\n        />\n\n        {/* Pengajuan Info */}\n        <Card className=\"border-green-200 bg-green-50\">\n          <CardHeader>\n            <CardTitle className=\"text-green-800 flex items-center gap-2\">\n              <FileText className=\"h-5 w-5\" />\n              Informasi Pengajuan\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-3\">\n                  <User className=\"h-5 w-5 text-green-600\" />\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">{pengajuan.pegawai?.nama || '-'}</h3>\n                    <p className=\"text-sm text-gray-600\">NIP: {pengajuan.pegawai?.nip || '-'}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <MapPin className=\"h-5 w-5 text-green-600\" />\n                  <div>\n                    <p className=\"font-medium text-gray-900\">{pengajuan.office?.kabkota || '-'}</p>\n                    <p className=\"text-sm text-gray-600\">{pengajuan.office?.name || '-'}</p>\n                  </div>\n                </div>\n              </div>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-3\">\n                  <FileText className=\"h-5 w-5 text-green-600\" />\n                  <div>\n                    <p className=\"font-medium text-gray-900\">Jenis Jabatan</p>\n                    <p className=\"text-sm text-gray-600\">{pengajuan.jenis_jabatan}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <Calendar className=\"h-5 w-5 text-green-600\" />\n                  <div>\n                    <p className=\"font-medium text-gray-900\">Tanggal Pengajuan</p>\n                    <p className=\"text-sm text-gray-600\">{formatDate(pengajuan.created_at)}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Upload Section */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-green-800\">Upload File Admin Wilayah</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {/* Job Type Selection */}\n            <div className=\"mb-6\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Pilih Jenis Berkas Admin Wilayah\n              </label>\n              <Select value={selectedJobType} onValueChange={setSelectedJobType}>\n                <SelectTrigger className=\"w-full max-w-md\">\n                  <SelectValue placeholder=\"Pilih jenis berkas...\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {availableJobTypes.map((jobType) => (\n                    <SelectItem key={jobType} value={jobType}>\n                      {jobType}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n              <p className=\"text-xs text-gray-500 mt-1\">\n                Pilih jenis berkas yang sudah dikonfigurasi oleh superadmin\n              </p>\n            </div>\n\n            {/* Upload Progress Tracker */}\n            {selectedJobType && uploadProgress.total > 0 && (\n              <UploadProgressTracker\n                uploaded={uploadProgress.required}\n                total={uploadProgress.total}\n                isComplete={uploadProgress.isComplete}\n                className=\"mb-6\"\n              />\n            )}\n\n            {/* File Upload Component */}\n            {selectedJobType && (\n              <AdminWilayahFileUpload\n                pengajuanId={pengajuan.id}\n                jenisJabatanId={selectedJobType}\n                onFilesUploaded={() => fetchDetail()}\n                onProgressChange={(uploaded, total) => setUploadProgress({ required: uploaded, total, isComplete: uploaded >= total && total > 0 })}\n                pengajuanStatus={pengajuan.status}\n                pengajuanData={pengajuan}\n              />\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-end gap-3\">\n          {(pengajuan.status === 'approved' || pengajuan.status === 'submitted') && (\n            <>\n              <span className=\"text-sm text-gray-600 mr-2\">{uploadProgress.required}/{uploadProgress.total} berkas wajib</span>\n              <SubmitButton \n                onClick={submitToSuperadmin} \n                className=\"bg-green-600 hover:bg-green-700 text-white\"\n                isProcessing={isSubmitting || pengajuan.status === 'submitted' || (uploadProgress.required < uploadProgress.total)}\n                processingText=\"Mengirim...\"\n              >\n                <Send className=\"h-4 w-4 mr-2\" />\n                {pengajuan.status === 'submitted' ? 'Sudah Dikirim' : 'Submit ke Superadmin'}\n              </SubmitButton>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminWilayahUploadPage;\n"],"names":["toSafeId","raw","AdminWilayahFileUpload","pengajuanId","jenisJabatanId","onFilesUploaded","onProgressChange","pengajuanStatus","pengajuanData","token","user","useAuth","toast","useToast","requiredFiles","setRequiredFiles","useState","uploadedFiles","setUploadedFiles","uploading","setUploading","uploadProgress","setUploadProgress","showSubmitDialog","setShowSubmitDialog","submitting","setSubmitting","submitForm","isSubmitting","useFormSubmissionProtection","loading","setLoading","error","setError","dragOver","setDragOver","isDragActive","setIsDragActive","showErrorModal","setShowErrorModal","errorMessage","setErrorMessage","errorTitle","setErrorTitle","fetchFileConfigs","jobTypeId","jobTypeRes","apiGet","jobType","jt","response","uploadedCount","f","c","fetchUploadedFiles","res","mapped","_a","useEffect","totalRequired","r","handleFileUpload","fileType","file","prev","guardJabatanMatch","formData","key","value","progressInterval","current","apiPost","newFile","nextFiles","errorMsg","showErrorModalHandler","handleSubmitForReview","showSuccess","showError","formatFileSize","bytes","k","sizes","i","getFileStatus","getUploadedFile","getJobTypeSpecificDescription","getDescriptiveLabel","fileConfig","file_type","display_name","jobTypeSpecificDescription","handlePreview","blob","url","handleDownload","a","showDownloadError","triggerReplace","input","operatorJabatan","adminSelectedJabatan","title","message","handleDragEnter","event","handleDragLeave","handleDragOver","handleDrop","files","allowedTypes","fileExtension","maxSize","jsxs","jsx","_","AlertCircle","Button","RefreshCw","uploadedFile","status","Card","CardContent","Badge","CheckCircle","FileText","Eye","Download","Edit","e","Fragment","Upload","allRequiredUploaded","isAlreadySubmitted","Send","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","SubmitButton","XCircle","UploadProgressTracker","uploaded","total","isComplete","className","percentage","Progress","Clock","AdminWilayahUploadPage","useParams","navigate","useNavigate","pengajuan","setPengajuan","availableJobTypes","setAvailableJobTypes","selectedJobType","setSelectedJobType","fetchDetail","progress","_b","complete","fetchAvailableJobTypes","jobTypeMap","jobTypeName","names","formatDate","dateString","getStatusBadge","isSubmittedAfterAdminWilayah","submitToSuperadmin","PageHeader","ArrowLeft","CardHeader","CardTitle","User","MapPin","_c","_d","Calendar","Select","SelectTrigger","SelectValue","SelectContent","SelectItem"],"mappings":"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"}