import{j as a,x as Ga,ab as ma,az as Va,aA as Ra,aB as qa,F as ga}from"./ui-vendor-DipkbOWo.js";import{d as Pa,e as Ya,r as c,c as za}from"./react-vendor-DheTkQGW.js";import{I as l,u as Qa,d as Wa,a as pa,B as E,m as ja,D as Xa,e as Za,c as ae,s as ee}from"./index-CdtzrYeU.js";import{L as s}from"./label-DVEGU6v3.js";import{S as Z,a as aa,b as ea,c as ta,d as na}from"./select-BWAY2yuv.js";import{P as ka}from"./PegawaiSearchInput-r1M-AOLJ.js";import{S as te}from"./separator-Bswy3p59.js";import{T as xa,a as ba,b as va,c as fa,d as Sa,e as Na,f as Ta,g as ya,h as Ca}from"./Template9-Bw9WqEvF.js";import{u as ne,S as se}from"./protected-button-DNb1wi_f.js";import{P as le}from"./PageHeader-BLqX87jf.js";import{F as re,u as ie,a as oe}from"./form-status-indicator-C6DnGUyR.js";import{S as Fa}from"./SuratPreviewContainer-C77N0icb.js";import"./card-DCLRESb7.js";const U=({title:m,description:n,children:v,className:o=""})=>a.jsxs("div",{className:`space-y-4 ${o}`,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-lg font-semibold",children:m}),n&&a.jsx("p",{className:"text-sm text-muted-foreground",children:n})]}),a.jsx(te,{}),a.jsx("div",{className:"space-y-4",children:v})]}),S=({label:m,value:n,placeholder:v=""})=>a.jsxs("div",{className:"space-y-2",children:[a.jsx(s,{className:"text-sm font-medium",children:m}),a.jsxs("div",{className:"relative",children:[a.jsx(l,{value:n??"",placeholder:v,readOnly:!0,className:"bg-muted/50 text-muted-foreground pr-10"}),n&&a.jsx(Ga,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-500 w-4 h-4"})]})]}),sa=["Kota Mataram","Kabupaten Lombok Barat","Kabupaten Lombok Tengah","Kabupaten Lombok Timur","Kabupaten Lombok Utara","Kabupaten Sumbawa Barat","Kabupaten Sumbawa","Kabupaten Dompu","Kabupaten Bima","Kota Bima"],de=[{id:"1",title:"Surat Pernyataan Tidak Sedang Tugas Belajar",description:"Surat pernyataan bahwa pegawai tidak sedang menjalani tugas belajar atau ikatan dinas",category:"Pernyataan"},{id:"2",title:"Surat Keterangan Analisis Jabatan",description:"Surat keterangan mengenai analisis jabatan dan analisis beban kerja pegawai",category:"Keterangan"},{id:"3",title:"Surat Keterangan Pengalaman Mengajar",description:"Surat keterangan mengenai pengalaman mengajar seorang guru",category:"Keterangan"},{id:"4",title:"Surat Permohonan Bebas Temuan",description:"Surat permohonan penerbitan surat keterangan bebas temuan",category:"Permohonan"},{id:"5",title:"Surat Pernyataan Tidak Sedang Hukuman Disiplin",description:"Surat pernyataan tidak sedang dalam proses atau menjalani hukuman disiplin",category:"Pernyataan"},{id:"6",title:"Surat Pernyataan Tidak Sedang Proses Pidana",description:"Surat pernyataan tidak sedang menjalani proses pidana atau pernah dipidana",category:"Pernyataan"},{id:"7",title:"Surat Persetujuan Pelepasan",description:"Surat persetujuan untuk melepas pegawai pindah tugas",category:"Persetujuan"},{id:"8",title:"Surat Persetujuan Penerimaan",description:"Surat persetujuan untuk menerima pegawai pindah tugas",category:"Persetujuan"},{id:"9",title:"Surat Pernyataan Tanggung Jawab Mutlak",description:"Surat pernyataan tanggung jawab mutlak atas dokumen dan data",category:"Pernyataan"}];function ue(m){if(!m)return"";const n=["","Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];let v,o,A;return/\d{4}-\d{2}-\d{2}/.test(m)?([A,o,v]=m.split("-"),`${parseInt(v,10)} ${n[parseInt(o,10)]} ${A}`):/\d{2}-\d{2}-\d{4}/.test(m)?([v,o,A]=m.split("-"),`${parseInt(v,10)} ${n[parseInt(o,10)]} ${A}`):m}const ce=()=>{const m=ie(),{templateId:n}=Pa(),v=Ya(),[o,A]=c.useState(),[i,wa]=c.useState(),[h,_a]=c.useState(null),y=new Date().getFullYear().toString(),[r,H]=c.useState({kabkota:"LOMBOK BARAT",jln:"Jl. Gajah Mada No. 1 Gerung, Lombok Barat 83511",telfon:"Telp. (0370) 681557",fax:"Fax. (0370) 681557",email:"kemenag.lombokbarat@gmail.com",website:"lombokbarat.kemenag.go.id",namapejabat:"",nippejabat:"",pangkatgolpejabat:"",jabatanpejabat:"",namapegawai:"",nippegawai:"",pangkatgolpegawai:"",jabatanpegawai:"",ibukota:"",tanggal:"",kode_kabko:"",pejabatStatus:"tetap",isPltPlh:!1,pltPlhType:"plt"}),[w,R]=c.useState({nosrt:"",blnno:"",thnno:y,ukerpejabat:"",ukerpegawai:""}),[u,Da]=c.useState({nosurat:"",blnnomor:"",tahunskrg:y,unitkerja:"",namajabatan:"",bbnkerja:"",eksisting:"",kelebihan:"",kekurangan:""}),[j,la]=c.useState({nosrt:"",blnno:"",thnno:y,tempattugas:"",sekolah:"",kabkota2:"",tglmulai:""}),[N,ra]=c.useState({nosrt:"",blnsrt:"",thnskrg:y,unitkerja:"",keperluan:""}),[T,q]=c.useState({nosrt:"",blnno:"",thnno:y,ukerpejabat:"",tempattugas:""}),[_,Y]=c.useState({nosrt:"",blnno:"",thnno:y,ukerpejabat:"",ukerpegawai:""}),[k,$a]=c.useState({nosurat:"",blnnomor:"",tahunskrg:y,tempattugas:"",kabkota2:"",jabatanpegawai2:"",tempattugas2:"",kabataukotatujuan:""}),[f,Ka]=c.useState({nosrt:"",blnno:"",thnno:y,tempattugas:"",jabatanbaru:"",tempattugasbaru:""}),[D,ia]=c.useState({nosrt:"",blnno:"",thnno:y,ukerpejabat:""}),{token:K,user:b}=Qa(),{toast:Ba}=Wa();c.useState(!1);const{submitForm:Aa,isSubmitting:Ma}=ne();c.useState(!1);const[M,Ia]=c.useState(null),[he,oa]=c.useState(null),[da,C]=c.useState(null),[La,z]=c.useState(!1),[J,ua]=c.useState(null);c.useEffect(()=>{!M||!K||pa(`/api/letters/${M}`,K).then(e=>ua(e.letter)).catch(()=>ua(null))},[M,K]),za.useEffect(()=>{if(!K)return;(async()=>{try{let t=null;b!=null&&b.office_id?t=(await pa(`/api/offices/${b.office_id}`,K)).office:t=null,t&&(_a(t),H(d=>({...d,kabkota:t.kabkota||"",jln:t.address||"",telfon:t.phone||"",fax:t.fax||"",email:t.email||"",website:t.website||"",kode_kabko:t.kode_kabko||"",office_name:t.name||""})))}catch{}})()},[K,b]);const Ea=e=>{A(e),H(t=>({...t,namapejabat:(e==null?void 0:e.nama)||"",nippejabat:(e==null?void 0:e.nip)||"",pangkatgolpejabat:(e==null?void 0:e.pangkat_gol)||(e==null?void 0:e.golongan)||"",jabatanpejabat:(e==null?void 0:e.jabatan)||""})),n==="1"&&R(t=>({...t,ukerpejabat:(e==null?void 0:e.unit_kerja)||""})),n==="5"&&q(t=>({...t,ukerpejabat:(e==null?void 0:e.unit_kerja)||""})),n==="6"&&Y(t=>({...t,ukerpejabat:(e==null?void 0:e.unit_kerja)||""})),n==="9"&&ia(t=>({...t,ukerpejabat:(e==null?void 0:e.unit_kerja)||""}))},Ja=e=>{wa(e),H(t=>({...t,namapegawai:(e==null?void 0:e.nama)||"",nippegawai:(e==null?void 0:e.nip)||"",pangkatgolpegawai:(e==null?void 0:e.pangkat_gol)||(e==null?void 0:e.golongan)||"",jabatanpegawai:(e==null?void 0:e.jabatan)||""})),n==="1"&&R(t=>({...t,ukerpegawai:(e==null?void 0:e.unit_kerja)||""})),n==="3"&&la(t=>({...t,tempattugas:(e==null?void 0:e.tempat_tugas)||""})),n==="4"&&ra(t=>({...t,unitkerja:(e==null?void 0:e.unit_kerja)||""})),n==="5"&&q(t=>({...t,tempattugas:(e==null?void 0:e.tempat_tugas)||""})),n==="6"&&Y(t=>({...t,ukerpegawai:(e==null?void 0:e.unit_kerja)||""}))},I=(e,t)=>{H(d=>({...d,[e]:t}))},Q=(e,t)=>{R(d=>({...d,[e]:t}))},F=(e,t)=>{Da(d=>({...d,[e]:t}))},B=(e,t)=>{la(d=>({...d,[e]:t}))},O=(e,t)=>{ra(d=>({...d,[e]:t}))},G=(e,t)=>{q(d=>({...d,[e]:t}))},W=(e,t)=>{Y(d=>({...d,[e]:t}))},$=(e,t)=>{$a(d=>({...d,[e]:t}))},L=(e,t)=>{Ka(d=>({...d,[e]:t}))},X=(e,t)=>{ia(d=>({...d,[e]:t}))},Oa=async e=>{e.preventDefault(),m.startSubmission(),m.clearFeedback(),Aa(async()=>{var ha;if(C(null),oa(null),!(h!=null&&h.id))throw C("Data kantor tidak ditemukan. Silakan atur kantor di Settings."),new Error("Data kantor tidak ditemukan");if(!(b!=null&&b.id))throw C("User tidak valid. Silakan login ulang."),new Error("User tidak valid");if(n!=="2"&&n!=="9"&&!(i!=null&&i.nip))throw C("Pilih pegawai yang akan dinyatakan dalam surat."),new Error("Pegawai belum dipilih");if(!(o!=null&&o.nip))throw C("Pilih pejabat penandatangan surat."),new Error("Pejabat belum dipilih");const t=(h==null?void 0:h.kode_kabko)||r.kode_kabko||"-",g=(b==null?void 0:b.role)==="kanwil"?"kw.18.01":`Kk.18.${t}`;let p="";if(n==="1"?p=`B-${w.nosrt}/${g}/1/Kp.07.6/${w.blnno}/${w.thnno}`:n==="2"?p=`B-${u.nosurat}/${g}/1/KP.07.6/${u.blnnomor}/${u.tahunskrg}`:n==="3"?p=`B-${j.nosrt}/${g}/1/KP.07.6/${j.blnno}/${j.thnno}`:n==="4"?p=`B-${N.nosrt}/${g}/1/Kp.01.2/${N.blnsrt}/${N.thnskrg}`:n==="5"?p=`B-${T.nosrt}/${g}/1/Kp.07.6/${T.blnno}/${T.thnno}`:n==="6"?p=`B-${_.nosrt}/${g}/1/Kh.04.1/${_.blnno}/${_.thnno}`:n==="7"?p=`B-${k.nosurat}/${g}/1/Kp.07.6/${k.blnnomor}/${k.tahunskrg}`:n==="8"?p=`B-${f.nosrt}/${g}/1/Kp.07.6/${f.blnno}/${f.thnno}`:n==="9"&&(p=`B-${D.nosrt}/${g}/1/Kp.01.2/${D.blnno}/${D.thnno}`),!p)throw C("Nomor surat wajib diisi."),new Error("Nomor surat wajib diisi");let x="";r.tanggal&&(x=ue(r.tanggal));const V={office_id:h.id,created_by:b.id,template_id:Number(n),template_name:(P==null?void 0:P.title)||"",letter_number:p,subject:P==null?void 0:P.title,recipient_employee_nip:(i==null?void 0:i.nip)||null,signing_official_nip:o.nip,form_data:{...n==="2"?{kabkota:r.kabkota,jln:r.jln,telfon:r.telfon,fax:r.fax,email:r.email,website:r.website,namapejabat:o.nama,nippejabat:o.nip,pangkatgolpejabat:r.pangkatgolpejabat||o.pangkat_gol||(o==null?void 0:o.golongan)||"",jabatanpejabat:o.jabatan,unitkerja:u.unitkerja||"",nosurat:u.nosurat,blnnomor:u.blnnomor,tahunskrg:u.tahunskrg,namajabatan:u.namajabatan,bbnkerja:u.bbnkerja,eksisting:u.eksisting,kelebihan:u.kelebihan,kekurangan:u.kekurangan,ibukota:r.ibukota,tanggal:x,kode_kabko:(h==null?void 0:h.kode_kabko)||r.kode_kabko||"",office_name:(h==null?void 0:h.name)||r.office_name||"",office:h}:{...r,...n!=="2"&&{namapegawai:(i==null?void 0:i.nama)||"",nippegawai:(i==null?void 0:i.nip)||"",pangkatgolpegawai:r.pangkatgolpegawai||(i==null?void 0:i.pangkat_gol)||(i==null?void 0:i.golongan)||"",jabatanpegawai:(i==null?void 0:i.jabatan)||"",ukerpegawai:(i==null?void 0:i.unit_kerja)||""},...n==="1"&&w,...n==="3"&&j,...n==="4"&&N,...n==="5"&&T,...n==="6"&&_,...n==="7"&&k,...n==="8"&&f,...n==="9"&&D,tanggal:x,kode_kabko:(h==null?void 0:h.kode_kabko)||r.kode_kabko||"",office_name:(h==null?void 0:h.name)||r.office_name||"",unitkerja:(i==null?void 0:i.unit_kerja)||(o==null?void 0:o.unit_kerja)||"",namapejabat:o.nama,nippejabat:o.nip,jabatanpejabat:o.jabatan,unitkerjapejabat:o.unit_kerja,ukerpejabat:o.unit_kerja,ibukota:r.ibukota,...n!=="2"&&n!=="9"&&{pangkatgolpejabat:r.pangkatgolpejabat||(o==null?void 0:o.pangkat_gol)||(o==null?void 0:o.golongan)||"",pangkatgolpegawai:r.pangkatgolpegawai||(i==null?void 0:i.pangkat_gol)||(i==null?void 0:i.golongan)||""}}}},ca=await ae("/api/letters",V,K);Ia(((ha=ca.letter)==null?void 0:ha.id)||ca.id),z(!0),ee("SAVE_SUCCESS","Surat berhasil disimpan dan siap digenerate PDF."),m.endSubmission(!0,"Surat berhasil disimpan dan siap digenerate PDF.")},()=>{},t=>{t.message&&t.message.includes("Nomor surat sudah ada")?C("Nomor surat sudah ada. Silakan gunakan nomor surat yang berbeda."):t.message&&t.message.includes("Internal server error")?C("Terjadi kesalahan server. Silakan coba lagi."):C(t.message||"Terjadi kesalahan saat menyimpan surat"),oa(null),m.endSubmission(!1,t.message||"Terjadi kesalahan saat menyimpan surat")})},Ua=()=>{switch(n){case"1":return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt",value:w.nosrt||"",onChange:e=>Q("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno",value:w.blnno||"",onChange:e=>Q("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno",children:"Tahun"}),a.jsx(l,{id:"thnno",value:w.thnno||"",onChange:e=>Q("thnno",e.target.value),placeholder:"e.g., 2024"})]})]});case"2":return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosurat",children:"Nomor Surat"}),a.jsx(l,{id:"nosurat",value:u.nosurat||"",onChange:e=>F("nosurat",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnnomor",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnnomor",value:u.blnnomor||"",onChange:e=>F("blnnomor",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tahunskrg",children:"Tahun"}),a.jsx(l,{id:"tahunskrg",value:u.tahunskrg||"",onChange:e=>F("tahunskrg",e.target.value),placeholder:"e.g., 2024"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"namajabatan",children:"Nama Jabatan"}),a.jsx(l,{id:"namajabatan",value:u.namajabatan||"",onChange:e=>F("namajabatan",e.target.value),placeholder:"Nama jabatan"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"bbnkerja",children:"Beban Kerja"}),a.jsx(l,{id:"bbnkerja",value:u.bbnkerja||"",onChange:e=>F("bbnkerja",e.target.value),placeholder:"Beban kerja"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"eksisting",children:"Eksisting"}),a.jsx(l,{id:"eksisting",value:u.eksisting||"",onChange:e=>F("eksisting",e.target.value),placeholder:"Jumlah eksisting"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"kelebihan",children:"Kelebihan"}),a.jsx(l,{id:"kelebihan",value:u.kelebihan||"",onChange:e=>F("kelebihan",e.target.value),placeholder:"Jumlah kelebihan"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"kekurangan",children:"Kekurangan"}),a.jsx(l,{id:"kekurangan",value:u.kekurangan||"",onChange:e=>F("kekurangan",e.target.value),placeholder:"Jumlah kekurangan"})]})]});case"3":return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt3",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt3",value:j.nosrt||"",onChange:e=>B("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno3",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno3",value:j.blnno||"",onChange:e=>B("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno3",children:"Tahun"}),a.jsx(l,{id:"thnno3",value:j.thnno||"",onChange:e=>B("thnno",e.target.value),placeholder:"e.g., 2024"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tempattugas",children:"Tempat Tugas"}),a.jsx(l,{id:"tempattugas",value:j.tempattugas||"",onChange:e=>B("tempattugas",e.target.value),placeholder:"Akan terisi otomatis dari data pegawai (atau isi manual)",className:j.tempattugas?"bg-gray-50":""})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"sekolah",children:"Sekolah"}),a.jsxs("select",{id:"sekolah",className:"border rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white",value:j.sekolah||"",onChange:e=>B("sekolah",e.target.value),children:[a.jsx("option",{value:"",children:"Pilih sekolah"}),a.jsx("option",{value:"MAN",children:"MAN"}),a.jsx("option",{value:"MTs",children:"MTs"}),a.jsx("option",{value:"MIN",children:"MIN"})]})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"kabkota2",children:"Kabupaten/Kota"}),a.jsxs(Z,{onValueChange:e=>B("kabkota2",e),value:j.kabkota2||"",children:[a.jsx(aa,{className:"w-full",children:a.jsx(ea,{placeholder:"Pilih kabupaten/kota"})}),a.jsx(ta,{children:sa.map(e=>a.jsx(na,{value:e,children:e},e))})]})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tglmulai",children:"Tanggal Mulai"}),a.jsx(l,{id:"tglmulai",type:"date",value:j.tglmulai||"",onChange:e=>B("tglmulai",e.target.value)})]})]});case"4":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt4",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt4",value:N.nosrt||"",onChange:e=>O("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnsrt",children:"Bulan Surat"}),a.jsx(l,{id:"blnsrt",value:N.blnsrt||"",onChange:e=>O("blnsrt",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnskrg",children:"Tahun"}),a.jsx(l,{id:"thnskrg",value:N.thnskrg||"",onChange:e=>O("thnskrg",e.target.value),placeholder:"e.g., 2024"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"unitkerja4",children:"Unit Kerja"}),a.jsx(l,{id:"unitkerja4",value:N.unitkerja||"",onChange:e=>O("unitkerja",e.target.value),placeholder:"Unit kerja pegawai"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"keperluan",children:"Keperluan"}),a.jsx(l,{id:"keperluan",value:N.keperluan||"",onChange:e=>O("keperluan",e.target.value),placeholder:"Keperluan SKBT"})]})]})]});case"5":return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt5",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt5",value:T.nosrt||"",onChange:e=>G("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno5",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno5",value:T.blnno||"",onChange:e=>G("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno5",children:"Tahun"}),a.jsx(l,{id:"thnno5",value:T.thnno||"",onChange:e=>G("thnno",e.target.value),placeholder:"e.g., 2024"})]}),a.jsxs("div",{className:"md:col-span-3",children:[a.jsx(s,{htmlFor:"tempattugas5",children:"Satuan Kerja"}),a.jsx(l,{id:"tempattugas5",value:T.tempattugas||"",onChange:e=>G("tempattugas",e.target.value),placeholder:"Akan terisi otomatis dari data pegawai (atau isi manual)",className:T.tempattugas?"bg-gray-50":""})]})]});case"6":return a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt6",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt6",value:_.nosrt||"",onChange:e=>W("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno6",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno6",value:_.blnno||"",onChange:e=>W("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno6",children:"Tahun"}),a.jsx(l,{id:"thnno6",value:_.thnno||"",onChange:e=>W("thnno",e.target.value),placeholder:"e.g., 2024"})]})]})});case"7":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosurat7",children:"Nomor Surat"}),a.jsx(l,{id:"nosurat7",value:k.nosurat||"",onChange:e=>$("nosurat",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnnomor7",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnnomor7",value:k.blnnomor||"",onChange:e=>$("blnnomor",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tahunskrg7",children:"Tahun"}),a.jsx(l,{id:"tahunskrg7",value:k.tahunskrg||"",onChange:e=>$("tahunskrg",e.target.value),placeholder:"e.g., 2024"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tempattugas7",children:"Tempat Tugas Asal"}),a.jsx(l,{id:"tempattugas7",value:k.tempattugas||"",onChange:e=>$("tempattugas",e.target.value),placeholder:"Masukkan tempat tugas asal (contoh: Bagian Tata Usaha)"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"kabkota27",children:"Kabupaten/Kota Asal"}),a.jsxs(Z,{onValueChange:e=>$("kabkota2",e),value:k.kabkota2||"",children:[a.jsx(aa,{className:"w-full",children:a.jsx(ea,{placeholder:"Pilih kabupaten/kota"})}),a.jsx(ta,{children:sa.map(e=>a.jsx(na,{value:e,children:e},e))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"jabatanpegawai2",children:"Jabatan Baru"}),a.jsx(l,{id:"jabatanpegawai2",value:k.jabatanpegawai2||"",onChange:e=>$("jabatanpegawai2",e.target.value),placeholder:"Jabatan yang akan dituju"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tempattugas2",children:"Tempat Tugas Baru"}),a.jsx(l,{id:"tempattugas2",value:k.tempattugas2||"",onChange:e=>$("tempattugas2",e.target.value),placeholder:"Tempat tugas tujuan"})]})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"kabataukotatujuan",children:"Kabupaten/Kota Tujuan"}),a.jsxs(Z,{onValueChange:e=>$("kabataukotatujuan",e),value:k.kabataukotatujuan||"",children:[a.jsx(aa,{className:"w-full",children:a.jsx(ea,{placeholder:"Pilih kabupaten/kota"})}),a.jsx(ta,{children:sa.map(e=>a.jsx(na,{value:e,children:e},e))})]})]})]});case"8":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt8",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt8",value:f.nosrt||"",onChange:e=>L("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno8",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno8",value:f.blnno||"",onChange:e=>L("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno8",children:"Tahun"}),a.jsx(l,{id:"thnno8",value:f.thnno||"",onChange:e=>L("thnno",e.target.value),placeholder:"e.g., 2024"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tempattugas8",children:"Tempat Tugas Asal"}),a.jsx(l,{id:"tempattugas8",value:f.tempattugas||"",onChange:e=>L("tempattugas",e.target.value),placeholder:"Masukkan tempat tugas asal (contoh: Bagian Tata Usaha)"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"jabatanbaru",children:"Jabatan Baru"}),a.jsx(l,{id:"jabatanbaru",value:f.jabatanbaru||"",onChange:e=>L("jabatanbaru",e.target.value),placeholder:"Jabatan yang akan dituju"})]})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tempattugasbaru",children:"Tempat Tugas Baru"}),a.jsx(l,{id:"tempattugasbaru",value:f.tempattugasbaru||"",onChange:e=>L("tempattugasbaru",e.target.value),placeholder:"Tempat tugas tujuan"})]})]});case"9":return a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"nosrt9",children:"Nomor Surat"}),a.jsx(l,{id:"nosrt9",value:D.nosrt||"",onChange:e=>X("nosrt",e.target.value),placeholder:"e.g., 123"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"blnno9",children:"Bulan (Angka)"}),a.jsx(l,{id:"blnno9",value:D.blnno||"",onChange:e=>X("blnno",e.target.value),placeholder:"e.g., 12"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"thnno9",children:"Tahun"}),a.jsx(l,{id:"thnno9",value:D.thnno||"",onChange:e=>X("thnno",e.target.value),placeholder:"e.g., 2024"})]})]})});default:return a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(ga,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Template tidak ditemukan"})]})}},Ha=()=>{switch(n){case"1":return a.jsx(xa,{data:{...r,...w}});case"2":return a.jsx(ba,{data:{...r,...u}});case"3":return a.jsx(va,{data:{...r,...j,isPltPlh:r.isPltPlh,pltPlhType:r.pltPlhType}});case"4":return a.jsx(fa,{data:{...r,...N}});case"5":return a.jsx(Sa,{data:{...r,...T}});case"6":return a.jsx(Na,{data:{...r,..._}});case"7":return a.jsx(Ta,{data:{...r,...k}});case"8":return a.jsx(ya,{data:{...r,...f}});case"9":return a.jsx(Ca,{data:{...r,...D}});default:return a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(ga,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Template tidak ditemukan"})]})}},P=de.find(e=>e.id===n);return P?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsx(le,{title:P.title,subtitle:`${P.description} â€¢ Template ${n}`,actions:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(oe,{feedback:m.feedback,compact:!0}),a.jsxs(E,{variant:"outline",onClick:()=>v("/generator"),className:"flex items-center gap-2",children:[a.jsx(ma,{className:"w-4 h-4"}),"Kembali ke Pilihan Template"]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[a.jsx(U,{title:"Data Pejabat Penandatangan",description:"Pilih pejabat yang akan menandatangani surat",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsx(ka,{label:"Cari Pejabat",placeholder:"Masukkan nama atau NIP pejabat...",onSelect:Ea,selectedPegawai:o})}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(S,{label:"Nama Pejabat",value:r.namapejabat||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"NIP",value:r.nippejabat||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Pangkat/Golongan",value:r.pangkatgolpejabat||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Jabatan",value:r.jabatanpejabat||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Unit Kerja Pejabat",value:(o==null?void 0:o.unit_kerja)??"",placeholder:"Akan terisi otomatis"})]})]})}),n==="2"&&a.jsx(U,{title:"Data Pegawai",description:"Masukkan unit kerja yang akan dianalisis",children:a.jsxs("div",{children:[a.jsx(s,{htmlFor:"unitkerja",children:"Unit Kerja Pegawai"}),a.jsx(l,{id:"unitkerja",value:u.unitkerja||"",onChange:e=>F("unitkerja",e.target.value),placeholder:"Masukkan unit kerja pegawai"})]})}),n!=="9"&&n!=="2"&&a.jsx(U,{title:"Data Pegawai",description:"Pilih pegawai yang akan dinyatakan dalam surat",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsx(ka,{label:"Cari Pegawai",placeholder:"Masukkan nama atau NIP pegawai...",onSelect:Ja,selectedPegawai:i})}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(S,{label:"Nama Pegawai",value:r.namapegawai||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"NIP",value:r.nippegawai||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Pangkat/Golongan",value:r.pangkatgolpegawai||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Jabatan",value:r.jabatanpegawai||"",placeholder:"Akan terisi otomatis"}),a.jsx(S,{label:"Unit Kerja Pegawai",value:(i==null?void 0:i.unit_kerja)??"",placeholder:"Akan terisi otomatis"}),n==="3"&&a.jsx(S,{label:"Tempat Tugas",value:(i==null?void 0:i.tempat_tugas)??"",placeholder:"Akan terisi otomatis"})]})]})}),a.jsx(U,{title:"Detail Template",description:"Lengkapi informasi khusus untuk template yang dipilih",children:a.jsxs("form",{onSubmit:Oa,className:"space-y-8",children:[Ua(),a.jsxs(U,{title:"Tanda Tangan",description:"Atur tempat dan tanggal penandatanganan",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(s,{htmlFor:"ibukota",children:"Tempat"}),a.jsx(l,{id:"ibukota",value:r.ibukota||"",onChange:e=>I("ibukota",e.target.value),placeholder:"Mataram"})]}),a.jsxs("div",{children:[a.jsx(s,{htmlFor:"tanggal",children:"Tanggal"}),a.jsx(l,{id:"tanggal",type:"date",value:r.tanggal||"",onChange:e=>I("tanggal",e.target.value)})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx(s,{htmlFor:"pejabatStatus",children:"Status Pejabat"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:r.isPltPlh,onChange:e=>{I("isPltPlh",e.target.checked),e.target.checked&&I("pltPlhType","plt")},className:"mr-2"}),"PLT/PLH (Pelaksana Tugas/Pelaksana Harian)"]}),r.isPltPlh&&a.jsxs("div",{className:"ml-6 space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"plt",checked:r.pltPlhType==="plt",onChange:e=>I("pltPlhType",e.target.value),className:"mr-2"}),"PLT (Pelaksana Tugas)"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"plh",checked:r.pltPlhType==="plh",onChange:e=>I("pltPlhType",e.target.value),className:"mr-2"}),"PLH (Pelaksana Harian)"]})]})]})]})]}),a.jsx("div",{className:"pt-6",children:a.jsx(se,{type:"submit",className:"w-full bg-teal-700 hover:bg-teal-800 text-white",isProcessing:Ma,processingText:"Menyimpan...",children:"Simpan & Generate Surat"})}),da&&a.jsx("div",{className:"text-error mb-2",children:da})]})})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"sticky top-8",children:[a.jsx("div",{className:"mb-4 font-semibold",children:"Lihat hasil surat yang akan dicetak"}),a.jsx(Fa,{children:Ha()}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsxs(E,{className:"bg-teal-700 hover:bg-teal-800 text-white flex items-center gap-2",onClick:()=>{M?window.open(ja(`/letters/${M}/preview`),"_blank"):Ba({title:"Info",description:"Surat belum disimpan. Simpan dulu untuk membuka preview.",duration:3e3})},type:"button",children:[a.jsx(Va,{className:"w-4 h-4"}),"Open in New Tab"]}),a.jsxs(E,{className:"bg-teal-700 hover:bg-teal-800 text-white flex items-center gap-2",onClick:()=>{var t;const e=window.open("","","width=900,height=600");if(e){const d=Array.from(document.head.querySelectorAll('link[rel="stylesheet"], style'));e.document.write("<html><head>"),d.forEach(p=>{e.document.write(p.outerHTML)}),e.document.write('</head><body style="background:#f8fafc;">');const g=((t=document.querySelector(".preview-container"))==null?void 0:t.outerHTML)||"";e.document.write(g),e.document.write("</body></html>"),e.document.close(),e.focus(),setTimeout(()=>e.print(),500)}},type:"button",children:[a.jsx(Ra,{className:"w-4 h-4"}),"Cetak"]})]})]})})]})]}),a.jsx(Xa,{open:La,onOpenChange:z,children:a.jsxs(Za,{className:"max-w-4xl w-full",children:[a.jsx(qa,{children:"Preview Surat"}),a.jsx("div",{className:"mb-4",children:"Surat berhasil disimpan. Berikut preview surat dari database:"}),a.jsx("div",{className:"bg-white p-4 rounded shadow max-h-[70vh] overflow-auto",children:a.jsx(Fa,{children:J?(()=>{var V;let e=J.form_data;if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}if(!e)return a.jsx("div",{className:"text-error",children:"Data surat tidak ditemukan"});const t=String(J.template_id),d=(J.letter_number||"").split("/"),g=(V=J.letter_number)==null?void 0:V.match(/^B-([^/]+)/),p={nosrt:e.nosrt||(g?g[1]:""),nosurat:e.nosurat||(g?g[1]:""),blnno:e.blnno||d[5]||"",blnnomor:e.blnnomor||d[5]||"",thnno:e.thnno||d[6]||"",tahunskrg:e.tahunskrg||d[6]||""},x={...e,...p};return t==="1"?a.jsx(xa,{data:x}):t==="2"?a.jsx(ba,{data:x}):t==="3"?a.jsx(va,{data:x}):t==="4"?a.jsx(fa,{data:x}):t==="5"?a.jsx(Sa,{data:x}):t==="6"?a.jsx(Na,{data:x}):t==="7"?a.jsx(Ta,{data:x}):t==="8"?a.jsx(ya,{data:x}):t==="9"?a.jsx(Ca,{data:x}):a.jsx("div",{className:"text-error",children:"Template tidak dikenali"})})():a.jsx("div",{className:"text-center text-muted-foreground",children:"Memuat data surat..."})})}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx(E,{onClick:()=>z(!1),children:"Tutup"}),a.jsx(E,{onClick:()=>window.open(ja(`/letters/${M}/preview`),"_blank"),variant:"outline",children:"Open in New Tab"})]})]})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Template tidak ditemukan"}),a.jsxs(E,{onClick:()=>v("/generator"),children:[a.jsx(ma,{className:"w-4 h-4 mr-2"}),"Kembali ke Pilihan Template"]})]})})},Ce=()=>{const{templateId:m}=Pa(),n={templateId:m||""};return a.jsx(re,{initialData:n,autoSave:!1,showToastOnSave:!0,showToastOnError:!0,showToastOnValidation:!1,children:a.jsx(ce,{})})};export{Ce as default};
//# sourceMappingURL=TemplateForm-BaCLVyfz.js.map
