import{j as a,af as F,ag as J,ah as I,X as M,ae as E}from"./ui-vendor-e65TVV2G.js";import{r as l}from"./react-vendor-C8WR5ETM.js";import{C as L,a as R,b as H,c as Y}from"./card-ozF6mIds.js";import{u as $,d as G,a as O,B as k,b as z,D as X,e as Q,f as U,g as V,I as f,j as W,k as Z,m as aa}from"./index-CAAH4E-w.js";import{L as r}from"./label-Dj8fNAIl.js";import{C as ea}from"./checkbox-CPJGVJGC.js";import{S as na}from"./switch-DKerJ0Jh.js";import"./data-vendor-DtxkLsA5.js";const ma=()=>{const{token:p}=$(),{toast:u}=G(),[y,N]=l.useState([]),[K,x]=l.useState(!0),[v,m]=l.useState(!1),[h,S]=l.useState(null),[j,P]=l.useState(!1),[s,o]=l.useState({jenis_jabatan:"",total_dokumen:0,required_files:[],is_active:!0}),D=[{id:"surat_pengantar",name:"Surat Pengantar",category:"Dokumen Pengantar"},{id:"surat_permohonan_dari_yang_bersangkutan",name:"Surat Permohonan Dari Yang Bersangkutan",category:"Dokumen Pengantar"},{id:"surat_keputusan_cpns",name:"Surat Keputusan CPNS",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_pns",name:"Surat Keputusan PNS",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_kenaikan_pangkat_terakhir",name:"Surat Keputusan Kenaikan Pangkat Terakhir",category:"Dokumen Kepegawaian"},{id:"surat_keputusan_jabatan_terakhir",name:"Surat Keputusan Jabatan Terakhir",category:"Dokumen Kepegawaian"},{id:"skp_2_tahun_terakhir",name:"SKP 2 Tahun Terakhir",category:"Dokumen Kepegawaian"},{id:"surat_keterangan_bebas_temuan_inspektorat",name:"Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama",category:"Dokumen Keterangan"},{id:"surat_keterangan_anjab_abk_instansi_asal",name:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",category:"Dokumen Keterangan"},{id:"surat_keterangan_anjab_abk_instansi_penerima",name:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",category:"Dokumen Keterangan"},{id:"surat_pernyataan_tidak_hukuman_disiplin",name:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",category:"Dokumen Pernyataan"},{id:"surat_persetujuan_mutasi_asal",name:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",category:"Dokumen Persetujuan"},{id:"surat_lolos_butuh_ppk",name:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",category:"Dokumen Persetujuan"},{id:"peta_jabatan",name:"Peta Jabatan",category:"Dokumen Pendukung"},{id:"hasil_assessment",name:"Hasil Assessment",category:"Dokumen Pendukung"},{id:"anjab_abk_instansi_asal",name:"Anjab/Abk Instansi Asal",category:"Dokumen Pendukung"},{id:"anjab_abk_instansi_penerima",name:"Anjab/Abk Instansi Penerima",category:"Dokumen Pendukung"},{id:"surat_keterangan_tidak_tugas_belajar",name:"Surat Keterangan Tidak Sedang Tugas Belajar",category:"Dokumen Keterangan"},{id:"sptjm_pimpinan_satker_asal",name:"SPTJM Pimpinan Satker dari Asal",category:"Dokumen Pernyataan"},{id:"sptjm_pimpinan_satker_penerima",name:"SPTJM Pimpinan Satker dari Penerima",category:"Dokumen Pernyataan"},{id:"surat_rekomendasi_instansi_pembina",name:"Surat Rekomendasi Instansi Pembina",category:"Dokumen Rekomendasi"}];l.useEffect(()=>{b()},[]);const b=async()=>{try{x(!0);const e=await O("/api/job-type-configurations",p);e.success&&N(e.data)}catch(e){console.error("Error fetching configs:",e),u({title:"Error",description:"Gagal mengambil data konfigurasi",variant:"destructive"})}finally{x(!1)}},T=()=>{o({jenis_jabatan:"",total_dokumen:0,required_files:[],is_active:!0}),S(null),m(!0)},A=e=>{const t=(d=>{const _={"Surat Pengantar":"surat_pengantar","Surat Permohonan Dari Yang Bersangkutan":"surat_permohonan_dari_yang_bersangkutan","Surat Keputusan CPNS":"surat_keputusan_cpns","Surat Keputusan PNS":"surat_keputusan_pns","Surat Keputusan Kenaikan Pangkat Terakhir":"surat_keputusan_kenaikan_pangkat_terakhir","Surat Keputusan Jabatan Terakhir":"surat_keputusan_jabatan_terakhir","SKP 2 Tahun Terakhir":"skp_2_tahun_terakhir","Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama":"surat_keterangan_bebas_temuan_inspektorat","Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal":"surat_keterangan_anjab_abk_instansi_asal","Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima":"surat_keterangan_anjab_abk_instansi_penerima","Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK":"surat_pernyataan_tidak_hukuman_disiplin","Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki":"surat_persetujuan_mutasi_asal","Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju":"surat_lolos_butuh_ppk","Peta Jabatan":"peta_jabatan","Hasil Assessment":"hasil_assessment","Anjab/Abk Instansi Asal":"anjab_abk_instansi_asal","Anjab/Abk Instansi Penerima":"anjab_abk_instansi_penerima","Surat Keterangan Tidak Sedang Tugas Belajar":"surat_keterangan_tidak_tugas_belajar","SPTJM Pimpinan Satker dari Asal":"sptjm_pimpinan_satker_asal","SPTJM Pimpinan Satker dari Penerima":"sptjm_pimpinan_satker_penerima","Surat Rekomendasi Instansi Pembina":"surat_rekomendasi_instansi_pembina","SK Pangkat Terakhir":"surat_keputusan_kenaikan_pangkat_terakhir","SK Jabatan Terakhir":"surat_keputusan_jabatan_terakhir","Ijazah Terakhir":"surat_keputusan_pns","Sertifikat Diklat":"surat_keputusan_cpns","Surat Pernyataan":"surat_pernyataan_tidak_hukuman_disiplin",Foto:"surat_pengantar"};console.log("Original required_files from database:",e.required_files);const g=d.map(i=>{const c=_[i];return console.log(`Mapping "${i}" to "${c}"`),c}).filter(i=>i!==void 0);return console.log("Mapped required_files:",g),g})(e.required_files);o({jenis_jabatan:e.jenis_jabatan,total_dokumen:e.max_dokumen,required_files:t,is_active:e.is_active}),S(e),m(!0)},w=async()=>{try{P(!0);const n=(d=>{const _={surat_pengantar:"Surat Pengantar",surat_permohonan_dari_yang_bersangkutan:"Surat Permohonan Dari Yang Bersangkutan",surat_keputusan_cpns:"Surat Keputusan CPNS",surat_keputusan_pns:"Surat Keputusan PNS",surat_keputusan_kenaikan_pangkat_terakhir:"Surat Keputusan Kenaikan Pangkat Terakhir",surat_keputusan_jabatan_terakhir:"Surat Keputusan Jabatan Terakhir",skp_2_tahun_terakhir:"SKP 2 Tahun Terakhir",surat_keterangan_bebas_temuan_inspektorat:"Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama",surat_keterangan_anjab_abk_instansi_asal:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",surat_keterangan_anjab_abk_instansi_penerima:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",surat_pernyataan_tidak_hukuman_disiplin:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",surat_persetujuan_mutasi_asal:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",surat_lolos_butuh_ppk:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",peta_jabatan:"Peta Jabatan",hasil_assessment:"Hasil Assessment",anjab_abk_instansi_asal:"Anjab/Abk Instansi Asal",anjab_abk_instansi_penerima:"Anjab/Abk Instansi Penerima",surat_keterangan_tidak_tugas_belajar:"Surat Keterangan Tidak Sedang Tugas Belajar",sptjm_pimpinan_satker_asal:"SPTJM Pimpinan Satker dari Asal",sptjm_pimpinan_satker_penerima:"SPTJM Pimpinan Satker dari Penerima",surat_rekomendasi_instansi_pembina:"Surat Rekomendasi Instansi Pembina"};console.log("Frontend file type IDs:",d);const g=d.map(i=>{const c=_[i];return console.log(`Mapping "${i}" to "${c}"`),c}).filter(i=>i!==void 0);return console.log("Mapped file names for database:",g),g})(s.required_files),t={...s,required_files:n,is_active:s.is_active};h?(await W(`/api/job-type-configurations/${h.id}`,t,p),u({title:"Berhasil",description:"Konfigurasi berhasil diperbarui"})):(await Z("/api/job-type-configurations",t,p),u({title:"Berhasil",description:"Konfigurasi berhasil ditambahkan"})),m(!1),b()}catch(e){console.error("Error saving config:",e),u({title:"Error",description:(e==null?void 0:e.message)||"Gagal menyimpan konfigurasi",variant:"destructive"})}finally{P(!1)}},C=async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus konfigurasi ini?"))try{await aa(`/api/job-type-configurations/${e}`,p),u({title:"Berhasil",description:"Konfigurasi berhasil dihapus"}),b()}catch(n){console.error("Error deleting config:",n),u({title:"Error",description:(n==null?void 0:n.message)||"Gagal menghapus konfigurasi",variant:"destructive"})}},B=e=>{o(n=>{if(n.required_files.includes(e)){const d=n.required_files.filter(_=>_!==e);return{...n,required_files:d,total_dokumen:d.length}}if(n.required_files.length>=17)return u({title:"Batas Maksimum",description:"Maksimum 17 dokumen yang dapat dipilih untuk mutasi PNS",variant:"destructive"}),n;const t=[...n.required_files,e];return{...n,required_files:t,total_dokumen:t.length}})},q=D.reduce((e,n)=>(e[n.category]||(e[n.category]=[]),e[n.category].push(n),e),{});return K?a.jsx("div",{className:"container mx-auto p-6",children:a.jsx("div",{className:"text-center",children:"Loading..."})}):a.jsxs("div",{className:"container mx-auto p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Konfigurasi Jenis Jabatan"}),a.jsxs(k,{onClick:T,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white",children:[a.jsx(F,{className:"h-4 w-4"}),"Tambah Konfigurasi"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(e=>a.jsxs(L,{children:[a.jsx(R,{children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx(H,{className:"text-lg",children:e.jenis_jabatan}),a.jsx(z,{variant:"secondary",className:e.is_active?"bg-green-100 text-green-800 border-green-200":"bg-red-100 text-red-800 border-red-200",children:e.is_active?"Aktif":"Nonaktif"})]})}),a.jsx(Y,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(r,{className:"text-sm font-medium",children:"Total Dokumen"}),a.jsx("p",{className:"text-lg font-semibold",children:e.max_dokumen})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-sm font-medium",children:"Min Dokumen"}),a.jsx("p",{className:"text-sm text-gray-600",children:e.min_dokumen})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-sm font-medium",children:"File Types"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[e.required_files.length," file types"]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs(k,{size:"sm",variant:"outline",onClick:()=>A(e),className:"flex items-center gap-1 border-green-600 text-green-600 hover:bg-green-50",children:[a.jsx(J,{className:"h-3 w-3"}),"Edit"]}),a.jsxs(k,{size:"sm",variant:"outline",onClick:()=>C(e.id),className:"flex items-center gap-1 border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(I,{className:"h-3 w-3"}),"Hapus"]})]})]})})]},e.id))}),a.jsx(X,{open:v,onOpenChange:m,children:a.jsxs(Q,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsx(U,{children:a.jsx(V,{children:h?"Edit Konfigurasi":"Tambah Konfigurasi Baru"})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(r,{htmlFor:"jenis_jabatan",children:"Jenis Jabatan"}),a.jsx(f,{id:"jenis_jabatan",value:s.jenis_jabatan,onChange:e=>o(n=>({...n,jenis_jabatan:e.target.value})),placeholder:"Contoh: Guru, Penghulu, dll"})]}),a.jsxs("div",{children:[a.jsx(r,{htmlFor:"total_dokumen",children:"Total Dokumen"}),a.jsx(f,{id:"total_dokumen",type:"number",value:s.total_dokumen,onChange:e=>o(n=>({...n,total_dokumen:parseInt(e.target.value)||0})),min:"1",max:"20",disabled:!0,className:"bg-gray-50"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Otomatis mengikuti jumlah file types yang dipilih"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(na,{id:"is_active",checked:s.is_active,onCheckedChange:e=>o(n=>({...n,is_active:e})),className:"data-[state=checked]:bg-green-600"}),a.jsx(r,{htmlFor:"is_active",className:"text-sm font-medium",children:s.is_active?"Aktif":"Nonaktif"})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-base font-medium",children:"Pilih File Types yang Diperlukan"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Centang file types yang diperlukan untuk jenis jabatan ini"}),a.jsx("div",{className:"space-y-4",children:Object.entries(q).map(([e,n])=>a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium mb-3 text-gray-800",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:n.map(t=>a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ea,{id:t.id,checked:s.required_files.includes(t.id),onCheckedChange:()=>B(t.id),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),a.jsx(r,{htmlFor:t.id,className:"text-sm cursor-pointer",children:t.name})]},t.id))})]},e))})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Ringkasan"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total file types yang dipilih: ",a.jsx("strong",{children:s.required_files.length})," / 17"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total dokumen: ",a.jsx("strong",{children:s.total_dokumen})]}),s.required_files.length>=17&&a.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"⚠️ Maksimum 17 dokumen untuk mutasi PNS"})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsxs(k,{variant:"outline",onClick:()=>m(!1),disabled:j,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[a.jsx(M,{className:"h-4 w-4 mr-2"}),"Batal"]}),a.jsxs(k,{onClick:w,disabled:j||!s.jenis_jabatan||s.required_files.length===0,className:"bg-green-600 hover:bg-green-700 text-white",children:[a.jsx(E,{className:"h-4 w-4 mr-2"}),j?"Menyimpan...":"Simpan"]})]})]})]})})]})};export{ma as default};
//# sourceMappingURL=JobTypeConfiguration-Coe6-hhO.js.map
