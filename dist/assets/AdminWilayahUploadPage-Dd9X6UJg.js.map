{"version":3,"file":"AdminWilayahUploadPage-Dd9X6UJg.js","sources":["../../src/components/UploadProgressIndicator.tsx","../../src/components/AdminWilayahFileUpload.tsx","../../src/components/UploadProgressTracker.tsx","../../src/pages/AdminWilayahUploadPage.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\n\r\ninterface UploadProgressIndicatorProps {\r\n  progress: number;\r\n  isUploading: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst UploadProgressIndicator: React.FC<UploadProgressIndicatorProps> = ({\r\n  progress,\r\n  isUploading,\r\n  className = ''\r\n}) => {\r\n  // Cap progress at 100% and limit to 1 decimal place\r\n  const normalizedProgress = Math.min(Math.max(progress, 0), 100);\r\n  const displayProgress = Math.round(normalizedProgress * 10) / 10;\r\n  \r\n  // Determine status text based on progress\r\n  const getStatusText = () => {\r\n    if (!isUploading) return '';\r\n    \r\n    if (displayProgress === 0) return 'Preparing upload...';\r\n    if (displayProgress < 20) return 'Preparing upload...';\r\n    if (displayProgress < 90) return 'Uploading file...';\r\n    if (displayProgress < 100) return 'Processing...';\r\n    return 'Complete!';\r\n  };\r\n\r\n  const getProgressColor = () => {\r\n    if (displayProgress < 20) return 'text-blue-600';\r\n    if (displayProgress < 90) return 'text-green-600';\r\n    if (displayProgress < 100) return 'text-yellow-600';\r\n    return 'text-green-600';\r\n  };\r\n\r\n  const getProgressBarColor = () => {\r\n    if (displayProgress < 20) return 'bg-blue-600';\r\n    if (displayProgress < 90) return 'bg-green-600';\r\n    if (displayProgress < 100) return 'bg-yellow-600';\r\n    return 'bg-green-600';\r\n  };\r\n\r\n  if (!isUploading) return null;\r\n\r\n  return (\r\n    <div className={`space-y-2 ${className}`}>\r\n      {/* Status text and percentage */}\r\n      <div className=\"flex items-center justify-between text-xs\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"animate-spin h-3 w-3 border border-green-600 border-t-transparent rounded-full\" />\r\n          <span className={`font-medium ${getProgressColor()}`}>\r\n            {getStatusText()}\r\n          </span>\r\n        </div>\r\n        <span className={`font-semibold ${getProgressColor()}`}>\r\n          {displayProgress}%\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Progress bar */}\r\n      <div className=\"w-full\">\r\n        <div className=\"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-200\">\r\n          <div \r\n            className={`h-full transition-all duration-300 ${getProgressBarColor()}`}\r\n            style={{ width: `${displayProgress}%` }}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadProgressIndicator;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Upload, FileText, CheckCircle, XCircle, AlertCircle, Send, RefreshCw, Eye, Download, Edit, Loader2 } from 'lucide-react';\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\r\nimport FileUploadProgress from '@/components/FileUploadProgress';\r\nimport UploadProgressIndicator from '@/components/UploadProgressIndicator';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { apiGet, apiPost } from '@/lib/api';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useFormSubmissionProtection } from '@/hooks/useDoubleClickProtection';\r\nimport { showSuccess, showError, showUploadSuccess, showUploadError, showDownloadError } from '@/lib/messageUtils';\r\n\r\n// Normalize any text to a safe DOM id segment\r\nconst toSafeId = (raw: string): string => {\r\n  return String(raw)\r\n    .toLowerCase()\r\n    .replace(/[^a-z0-9_-]+/gi, '_')\r\n    .replace(/^_+|_+$/g, '');\r\n};\r\n\r\ninterface AdminWilayahFileConfig {\r\n  id: number;\r\n  jenis_jabatan_id: number;\r\n  file_type: string;\r\n  display_name: string;\r\n  is_required: boolean;\r\n  description?: string;\r\n  is_active: boolean;\r\n}\r\n\r\ninterface PengajuanFile {\r\n  id: string;\r\n  pengajuan_id: string;\r\n  file_type: string;\r\n  file_name: string;\r\n  file_path: string;\r\n  file_size: number;\r\n  verification_status: string;\r\n  verification_notes?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\ninterface AdminWilayahFileUploadProps {\r\n  pengajuanId: string;\r\n  jenisJabatanId: string;\r\n  onFilesUploaded: (files: PengajuanFile[]) => void;\r\n  onProgressChange?: (uploaded: number, total: number) => void;\r\n  pengajuanStatus?: string;\r\n  pengajuanData?: any; // Data pengajuan untuk validasi jabatan\r\n}\r\n\r\nconst AdminWilayahFileUpload: React.FC<AdminWilayahFileUploadProps> = ({\r\n  pengajuanId,\r\n  jenisJabatanId,\r\n  onFilesUploaded,\r\n  onProgressChange,\r\n  pengajuanStatus,\r\n  pengajuanData\r\n}) => {\r\n  const { token, user } = useAuth();\r\n  const { toast } = useToast();\r\n  const { submitForm, isSubmitting } = useFormSubmissionProtection();\r\n  const [requiredFiles, setRequiredFiles] = useState<AdminWilayahFileConfig[]>([]);\r\n  const [uploadedFiles, setUploadedFiles] = useState<PengajuanFile[]>([]);\r\n  const [availableJobTypes, setAvailableJobTypes] = useState<string[]>([]);\r\n  const [selectedVariant, setSelectedVariant] = useState<string>('');\r\n  const [uploading, setUploading] = useState<{ [key: string]: boolean }>({});\r\n  const [uploadProgress, setUploadProgress] = useState<{ [key: string]: number }>({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Drag and drop state\r\n  const [dragOver, setDragOver] = useState<string | null>(null);\r\n  const [isDragActive, setIsDragActive] = useState(false);\r\n  \r\n  // Error modal state\r\n  const [showErrorModal, setShowErrorModal] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState<string>('');\r\n  const [errorTitle, setErrorTitle] = useState<string>('Error');\r\n  \r\n  // Submit dialog state\r\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\r\n\r\n  // Fetch admin wilayah file configuration\r\n  const fetchFileConfigs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      // jenisJabatanId bisa berupa nama jabatan atau ID\r\n      let jobTypeId: number;\r\n      \r\n      if (isNaN(Number(jenisJabatanId))) {\r\n        // Jika berupa nama jabatan, cari ID-nya\r\n        try {\r\n          const jobTypeRes = await apiGet('/api/job-type-configurations', token);\r\n          if (jobTypeRes?.success && Array.isArray(jobTypeRes.data)) {\r\n            const jobType = jobTypeRes.data.find((jt: any) => jt.jenis_jabatan === jenisJabatanId);\r\n            if (jobType) {\r\n              jobTypeId = jobType.id;\r\n            } else {\r\n              setError('Jenis jabatan tidak ditemukan');\r\n              return;\r\n            }\r\n          } else {\r\n            setError('Gagal mengambil data jenis jabatan');\r\n            return;\r\n          }\r\n        } catch (error) {\r\n          setError('Gagal mencari jenis jabatan');\r\n          return;\r\n        }\r\n      } else {\r\n        jobTypeId = parseInt(String(jenisJabatanId));\r\n      }\r\n      \r\n      const response = await apiGet(`/api/admin-wilayah-file-config/job-type/${jobTypeId}`, token);\r\n      \r\n      console.log('ðŸ” API Response:', response);\r\n      console.log('ðŸ” Job Type ID:', jobTypeId);\r\n      console.log('ðŸ” Jenis Jabatan ID:', jenisJabatanId);\r\n      \r\n      if (response.success) {\r\n        console.log('âœ… Setting required files:', response.data);\r\n        setRequiredFiles(response.data);\r\n        // Notify parent about total required files (uploaded may be known later)\r\n        if (onProgressChange) {\r\n          const uploadedCount = uploadedFiles.filter(f => response.data.some((c: any) => c.file_type === f.file_type)).length;\r\n          onProgressChange(uploadedCount, response.data.length || 0);\r\n        }\r\n      } else {\r\n        setError('Failed to fetch file configurations');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching file configs:', error);\r\n      setError('Error connecting to server');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fetch list of job types that have admin wilayah configs (for guidance)\r\n  const fetchAvailableJobTypes = async () => {\r\n    try {\r\n      const res = await apiGet('/api/admin-wilayah-file-config', token);\r\n      if (res?.success && Array.isArray(res.data)) {\r\n        const names = Array.from(new Set(res.data.map((c: any) => {\r\n          const jobType = c.jenis_jabatan_id || c.jenis_jabatan?.jenis_jabatan;\r\n          return typeof jobType === 'string' ? jobType : String(jobType);\r\n        }).filter(Boolean))) as string[];\r\n        setAvailableJobTypes(names);\r\n      } else {\r\n        setAvailableJobTypes([]);\r\n      }\r\n    } catch {\r\n      setAvailableJobTypes([]);\r\n    }\r\n  };\r\n\r\n  // Fetch existing uploaded files (admin wilayah category) untuk pengajuan ini\r\n  const fetchUploadedFiles = async () => {\r\n    try {\r\n      const res = await apiGet(`/api/admin-wilayah/pengajuan/${pengajuanId}`, token);\r\n      if (res?.success) {\r\n        const awFiles = (res.uploadedAdminWilayahFiles || res.data?.uploadedAdminWilayahFiles || []) as any[];\r\n        const mapped: PengajuanFile[] = awFiles.map((f: any) => ({\r\n          id: f.id,\r\n          pengajuan_id: pengajuanId,\r\n          file_type: f.file_type,\r\n          file_name: f.file_name,\r\n          file_path: f.file_path,\r\n          file_size: f.file_size,\r\n          verification_status: f.verification_status || 'pending',\r\n          created_at: f.created_at,\r\n          updated_at: f.updated_at\r\n        }));\r\n        setUploadedFiles(mapped);\r\n      } else {\r\n      setUploadedFiles([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching uploaded files:', error);\r\n      setUploadedFiles([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (jenisJabatanId) {\r\n      fetchFileConfigs();\r\n      fetchUploadedFiles();\r\n    }\r\n  }, [jenisJabatanId, token]);\r\n\r\n  // Keep parent informed when lists change (must be before any early return)\r\n  useEffect(() => {\r\n    if (onProgressChange) {\r\n      const totalRequired = requiredFiles.length;\r\n      const uploadedCount = uploadedFiles.filter(f => requiredFiles.some(r => r.file_type === f.file_type)).length;\r\n      onProgressChange(uploadedCount, totalRequired);\r\n    }\r\n  }, [requiredFiles, uploadedFiles]);\r\n\r\n  const handleFileUpload = async (fileType: string, file: File) => {\r\n    console.log('ðŸš€ START UPLOAD - fileType:', fileType, 'fileName:', file.name);\r\n    setUploading(prev => ({ ...prev, [fileType]: true }));\r\n    setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\r\n    \r\n    try {\r\n      // Block upload if jabatan mismatch\r\n      if (!guardJabatanMatch()) {\r\n        setUploading(prev => ({ ...prev, [fileType]: false }));\r\n        setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\r\n        return;\r\n      }\r\n      // Debug logging\r\n      console.log('ðŸ” Uploading file:', {\r\n        fileType,\r\n        fileName: file.name,\r\n        pengajuanId,\r\n        jenisJabatanId,\r\n        requiredFiles: requiredFiles.map(f => ({ file_type: f.file_type, display_name: f.display_name }))\r\n      });\r\n      \r\n      // Create FormData for file upload\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('pengajuan_id', pengajuanId);\r\n      formData.append('file_type', fileType);\r\n      formData.append('file_category', 'admin_wilayah');\r\n      formData.append('uploaded_by_role', 'admin_wilayah');\r\n      formData.append('uploaded_by_name', user?.full_name || 'Admin Wilayah');\r\n      formData.append('uploaded_by_office', 'Kanwil Provinsi');\r\n      \r\n      // Debug FormData\r\n      console.log('ðŸ“¦ FormData created:', {\r\n        file: file.name,\r\n        pengajuan_id: pengajuanId,\r\n        file_type: fileType,\r\n        file_category: 'admin_wilayah'\r\n      });\r\n      \r\n      // Check if FormData is properly created\r\n      for (let [key, value] of formData.entries()) {\r\n        console.log('ðŸ“‹ FormData entry:', key, value);\r\n      }\r\n\r\n      // Simulate upload progress\r\n      const progressInterval = setInterval(() => {\r\n        setUploadProgress(prev => {\r\n          const current = prev[fileType] || 0;\r\n          if (current < 90) {\r\n            return { ...prev, [fileType]: current + Math.random() * 20 };\r\n          }\r\n          return prev;\r\n        });\r\n      }, 200);\r\n\r\n      // Upload file to backend\r\n      const response = await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/upload`, formData, token);\r\n      \r\n      // Complete progress\r\n      clearInterval(progressInterval);\r\n      setUploadProgress(prev => ({ ...prev, [fileType]: 100 }));\r\n      \r\n      if (response.success) {\r\n        const newFile: PengajuanFile = {\r\n          id: response.data.id,\r\n          pengajuan_id: pengajuanId,\r\n          file_type: fileType,\r\n          file_name: file.name,\r\n          file_path: response.data.file_path,\r\n          file_size: file.size,\r\n          verification_status: 'pending',\r\n          created_at: new Date().toISOString(),\r\n          updated_at: new Date().toISOString()\r\n        };\r\n        \r\n        const nextFiles = [...uploadedFiles, newFile];\r\n        setUploadedFiles(nextFiles);\r\n        onFilesUploaded(nextFiles);\r\n        if (onProgressChange) {\r\n          const totalRequired = requiredFiles.length;\r\n          const uploadedCount = nextFiles.filter(f => requiredFiles.some(r => r.file_type === f.file_type)).length;\r\n          onProgressChange(uploadedCount, totalRequired);\r\n        }\r\n        \r\n        toast({\r\n          title: \"Success\",\r\n          description: `Upload berhasil: ${file.name}`,\r\n          variant: \"default\",\r\n          duration: 3000\r\n        });\r\n      } else {\r\n        const errorMsg = response.message || \"Terjadi kesalahan saat mengupload file. Silakan coba lagi.\";\r\n        showErrorModalHandler('Upload Gagal', errorMsg);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error uploading file:', error);\r\n      showErrorModalHandler('Upload Gagal', 'Terjadi kesalahan saat mengupload file. Periksa koneksi internet Anda dan coba lagi.');\r\n    } finally {\r\n      setUploading(prev => ({ ...prev, [fileType]: false }));\r\n      setUploadProgress(prev => ({ ...prev, [fileType]: 0 }));\r\n    }\r\n  };\r\n\r\n  const handleSubmitForReview = async () => {\r\n    submitForm(\r\n      async () => {\r\n        // Submit logic here\r\n        showSuccess('SUBMIT_SUCCESS', 'File berhasil diajukan ke Superadmin');\r\n        setShowSubmitDialog(false);\r\n      },\r\n      () => {\r\n        // onSuccess - already handled above\r\n      },\r\n      (error) => {\r\n        // onError\r\n        showError('OPERATION_FAILED', 'Gagal mengajukan file ke Superadmin');\r\n      }\r\n    );\r\n  };\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  };\r\n\r\n  const formatRelativeTime = (isoString: string) => {\r\n    const now = Date.now();\r\n    const then = new Date(isoString).getTime();\r\n    const diff = Math.max(0, Math.floor((now - then) / 1000));\r\n    if (diff < 5) return 'baru saja';\r\n    if (diff < 60) return `${diff} detik lalu`;\r\n    const minutes = Math.floor(diff / 60);\r\n    if (minutes < 60) return `${minutes} menit lalu`;\r\n    const hours = Math.floor(minutes / 60);\r\n    if (hours < 24) return `${hours} jam lalu`;\r\n    const days = Math.floor(hours / 24);\r\n    return `${days} hari lalu`;\r\n  };\r\n\r\n  const getFileStatus = (fileType: string) => {\r\n    const file = uploadedFiles.find(f => f.file_type === fileType);\r\n    return file ? 'uploaded' : 'pending';\r\n  };\r\n\r\n  const getUploadedFile = (fileType: string) => {\r\n    return uploadedFiles.find(f => f.file_type === fileType);\r\n  };\r\n\r\n  // Function to get job type specific descriptions\r\n  const getJobTypeSpecificDescription = (jobType: string, fileType: string) => {\r\n    const jobTypeDescriptions: { [key: string]: { [key: string]: string } } = {\r\n      'Guru': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Kepala Madrasah': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Wakil Kepala Madrasah': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Kepala TU': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Kepala Seksi': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Kepala Sub Bagian': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Kepala Urusan': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Staff': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      },\r\n      'Pelaksana': {\r\n        'surat_rekomendasi_kanwil': 'Surat Rekomendasi dari Instansi Pembina - Permohonan Pindah Tugas ke Dirjen Pendis',\r\n        'surat_persetujuan_kepala_wilayah': 'Surat Persetujuan Kepala Wilayah - Kemenag Provinsi',\r\n        'surat_pengantar_permohonan_rekomendasi': 'Surat Pengantar - Permohonan Rekomendasi Pindah Tugas',\r\n        'surat_pernyataan_tidak_tugas_belajar': 'Surat Pernyataan - Tidak Sedang Tugas Belajar atau Ikatan Dinas',\r\n        'surat_pernyataan_tidak_hukuman_disiplin': 'Surat Pernyataan - Tidak Sedang Dijatuhi Hukuman Disiplin',\r\n        'surat_pernyataan_tidak_proses_pidana': 'Surat Pernyataan - Tidak Sedang Proses Pidana atau Penjara',\r\n        'surat_pernyataan_tanggung_jawab_mutlak': 'Surat Pernyataan Tanggung Jawab Mutlak (SPTJM)',\r\n        'surat_keterangan_bebas_temuan_inspektorat': 'Surat Keterangan Bebas Temuan (SKBT)',\r\n        'hasil_evaluasi_pertimbangan_baperjakat': 'Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)',\r\n        'surat_rekomendasi_kanwil_khusus': 'Surat Rekomendasi Khusus - Dari Kanwil Provinsi'\r\n      }\r\n    };\r\n\r\n    return jobTypeDescriptions[jobType]?.[fileType] || null;\r\n  };\r\n\r\n  // Function to get descriptive label for file types based on job type\r\n  const getDescriptiveLabel = (fileConfig: AdminWilayahFileConfig) => {\r\n    const { file_type, display_name } = fileConfig;\r\n    \r\n    // Special handling for Surat Rekomendasi dari Instansi Pembina variants\r\n    if (file_type === 'surat_rekomendasi_kanwil') {\r\n      // Get job type specific description\r\n      const jobTypeSpecificDescription = getJobTypeSpecificDescription(jenisJabatanId, file_type);\r\n      return jobTypeSpecificDescription || 'Surat Rekomendasi dari Instansi Pembina - Varian 6.1-6.9';\r\n    }\r\n    \r\n    // Get job type specific description for other file types\r\n    const jobTypeSpecificDescription = getJobTypeSpecificDescription(jenisJabatanId, file_type);\r\n    if (jobTypeSpecificDescription) {\r\n      return jobTypeSpecificDescription;\r\n    }\r\n    \r\n    // Default fallback\r\n    return display_name;\r\n  };\r\n\r\n  // Preview file in new tab using auth token\r\n  const handlePreview = async (file: PengajuanFile) => {\r\n    try {\r\n      const res = await fetch(`/api/pengajuan/files/${file.id}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      if (!res.ok) throw new Error('Gagal mengambil file');\r\n      const blob = await res.blob();\r\n      const url = URL.createObjectURL(blob);\r\n      window.open(url, '_blank');\r\n      // Revoke later to avoid memory leak\r\n      setTimeout(() => URL.revokeObjectURL(url), 5000);\r\n    } catch (e) {\r\n      showError('OPERATION_FAILED', 'Gagal membuka preview file');\r\n    }\r\n  };\r\n\r\n  const handleDownload = async (file: PengajuanFile) => {\r\n    try {\r\n      const res = await fetch(`/api/pengajuan/files/${file.id}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      if (!res.ok) throw new Error('Gagal mengambil file');\r\n      const blob = await res.blob();\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = file.file_name || 'file.pdf';\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      setTimeout(() => URL.revokeObjectURL(url), 5000);\r\n    } catch (e) {\r\n      showDownloadError('Gagal mengunduh file');\r\n    }\r\n  };\r\n\r\n  const triggerReplace = (fileType: string) => {\r\n    const input = document.getElementById(`replace-${toSafeId(fileType)}`) as HTMLInputElement | null;\r\n    if (input) input.click();\r\n  };\r\n\r\n  // Guard: ensure selected job type matches operator's submitted job\r\n  const guardJabatanMatch = (): boolean => {\r\n    if (!pengajuanData?.jabatan_name || !jenisJabatanId) return true;\r\n    const operatorJabatan = String(pengajuanData.jabatan_name).toLowerCase();\r\n    const adminSelectedJabatan = String(jenisJabatanId).toLowerCase();\r\n    if (operatorJabatan !== adminSelectedJabatan) {\r\n      showErrorModalHandler(\r\n        'Jabatan Tidak Sesuai',\r\n        `Jenis jabatan yang Anda pilih tidak sama dengan yang diajukan oleh operator.\\n\\n` +\r\n          `â€¢ Diajukan operator: ${pengajuanData.jabatan_name}\\n` +\r\n          `â€¢ Dipilih admin wilayah: ${jenisJabatanId}\\n\\n` +\r\n          `Silakan pilih jenis jabatan yang sesuai terlebih dahulu, lalu ulangi upload.`\r\n      );\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  // Function to show error modal\r\n  const showErrorModalHandler = (title: string, message: string) => {\r\n    setErrorTitle(title);\r\n    setErrorMessage(message);\r\n    setShowErrorModal(true);\r\n  };\r\n\r\n  // Drag and drop handlers\r\n  const handleDragEnter = (fileType: string, event: React.DragEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    setDragOver(fileType);\r\n    setIsDragActive(true);\r\n  };\r\n\r\n  const handleDragLeave = (fileType: string, event: React.DragEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    // Only clear drag state if leaving the drop zone entirely\r\n    if (!event.currentTarget.contains(event.relatedTarget as Node)) {\r\n      setDragOver(null);\r\n      setIsDragActive(false);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (event: React.DragEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  };\r\n\r\n  const handleDrop = (fileType: string, event: React.DragEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    \r\n    // Block upload if jabatan mismatch\r\n    if (!guardJabatanMatch()) {\r\n      setDragOver(null);\r\n      setIsDragActive(false);\r\n      return;\r\n    }\r\n\r\n    const files = event.dataTransfer.files;\r\n    if (files && files.length > 0) {\r\n      const file = files[0];\r\n      \r\n      // Validate file type\r\n      const allowedTypes = ['.pdf', '.doc', '.docx'];\r\n      const fileExtension = '.' + file.name.split('.').pop()?.toLowerCase();\r\n      \r\n      if (!allowedTypes.includes(fileExtension)) {\r\n        showErrorModalHandler('Format File Tidak Didukung', 'Hanya file PDF, DOC, dan DOCX yang diizinkan untuk diupload.');\r\n        setDragOver(null);\r\n        setIsDragActive(false);\r\n        return;\r\n      }\r\n      \r\n      // Validate file size\r\n      const maxSize = fileType === 'skp_2_tahun_terakhir' ? 1.6 * 1024 * 1024 : 500 * 1024; // 1.6MB or 500KB\r\n      if (file.size > maxSize) {\r\n        const maxSizeText = fileType === 'skp_2_tahun_terakhir' ? '1.6MB' : '500KB';\r\n        showErrorModalHandler('Ukuran File Terlalu Besar', `Ukuran file maksimal ${maxSizeText}. Silakan kompres file atau pilih file yang lebih kecil.`);\r\n        setDragOver(null);\r\n        setIsDragActive(false);\r\n        return;\r\n      }\r\n      \r\n      // Upload the file\r\n      handleFileUpload(fileType, file);\r\n    }\r\n    \r\n    setDragOver(null);\r\n    setIsDragActive(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"animate-pulse space-y-4\">\r\n          <div className=\"h-6 bg-gray-200 rounded w-1/3\"></div>\r\n          <div className=\"space-y-3\">\r\n            {[...Array(5)].map((_, i) => (\r\n              <div key={i} className=\"h-20 bg-gray-200 rounded\"></div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"text-center py-8\">\r\n          <AlertCircle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Error Loading Files</h3>\r\n          <p className=\"text-gray-600 mb-4\">{error}</p>\r\n          <Button onClick={fetchFileConfigs} className=\"flex items-center gap-2\">\r\n            <RefreshCw className=\"h-4 w-4\" />\r\n            Retry\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-xl font-semibold\">Upload File Admin Wilayah</h2>\r\n        <Button onClick={() => { fetchFileConfigs(); fetchUploadedFiles(); }} variant=\"outline\" size=\"sm\">\r\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n          Refresh\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Semua Dokumen Wajib Admin Wilayah */}\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 className=\"text-lg font-medium text-gray-900\">Dokumen Wajib Admin Wilayah</h3>\r\n          <div className=\"text-sm text-gray-600\">\r\n            {(() => {\r\n              const uploadedCount = requiredFiles.filter(fileConfig => \r\n                uploadedFiles.some(uploadedFile => uploadedFile.file_type === fileConfig.file_type)\r\n              ).length;\r\n              return `${uploadedCount}/${requiredFiles.length} berkas sudah diupload`;\r\n            })()}\r\n          </div>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3\">\r\n          {requiredFiles.map((fileConfig) => {\r\n            console.log('ðŸ”§ Rendering fileConfig:', fileConfig);\r\n            const status = getFileStatus(fileConfig.file_type);\r\n            const uploadedFile = getUploadedFile(fileConfig.file_type);\r\n            \r\n            // Cek apakah status pengajuan adalah admin_wilayah_rejected\r\n            const isRejectedStatus = pengajuanStatus === 'admin_wilayah_rejected';\r\n            \r\n            // Cek apakah file ini approved (readonly) atau rejected (bisa diupload)\r\n            const isFileApproved = uploadedFile?.verification_status === 'approved';\r\n            const isFileRejected = uploadedFile?.verification_status === 'rejected';\r\n            \r\n            // Logika readonly: hanya untuk status rejected dan file approved\r\n            const isReadonly = isRejectedStatus && isFileApproved;\r\n            \r\n            // Logika canUpload:\r\n            // - Jika status BUKAN rejected: semua file bisa diupload (normal flow untuk pengajuan baru)\r\n            // - Jika status rejected: hanya file rejected yang bisa diupload, file approved readonly\r\n            const canUpload = !isRejectedStatus \r\n              ? true // Normal flow: semua file bisa diupload\r\n              : !isReadonly && isFileRejected; // Rejected status: hanya file rejected yang bisa diupload\r\n            \r\n            // Jika status admin_wilayah_rejected, hanya tampilkan file yang sudah ada (approved atau rejected)\r\n            // Jangan tampilkan file yang belum ada karena tidak perlu upload file baru\r\n            // Untuk status normal (bukan rejected), tampilkan semua file termasuk yang belum ada\r\n            if (isRejectedStatus && !uploadedFile) {\r\n              return null;\r\n            }\r\n            \r\n            return (\r\n              <Card key={fileConfig.id} className={`border ${isReadonly ? 'border-green-200 bg-green-50' : isFileRejected ? 'border-red-200 bg-red-50' : 'border-gray-200'}`}>\r\n                <CardContent className=\"p-3\">\r\n                  <div className=\"flex flex-col gap-3\">\r\n                    {/* Title and Status */}\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <h4 className=\"font-medium text-gray-900 text-sm leading-tight\" title={getDescriptiveLabel(fileConfig)}>\r\n                          {getDescriptiveLabel(fileConfig)}\r\n                        </h4>\r\n                        {fileConfig.is_required && (\r\n                          <Badge variant=\"destructive\" className=\"text-[10px] py-0 px-1.5\">Wajib</Badge>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Status Badge */}\r\n                      {isFileApproved ? (\r\n                        <Badge className=\"bg-green-600 text-white flex items-center gap-1 text-xs\">\r\n                          <CheckCircle className=\"h-3 w-3\" />\r\n                          Sesuai\r\n                        </Badge>\r\n                      ) : isFileRejected ? (\r\n                        <Badge className=\"bg-red-600 text-white flex items-center gap-1 text-xs\">\r\n                          <XCircle className=\"h-3 w-3\" />\r\n                          Ditolak\r\n                        </Badge>\r\n                      ) : status === 'uploaded' ? (\r\n                        <Badge className=\"bg-blue-600 text-white flex items-center gap-1 text-xs\">\r\n                          <FileText className=\"h-3 w-3\" />\r\n                          Uploaded\r\n                        </Badge>\r\n                      ) : (\r\n                        <Badge variant=\"secondary\" className=\"flex items-center gap-1 text-xs\">\r\n                          <FileText className=\"h-3 w-3\" />\r\n                          Pending\r\n                        </Badge>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    {/* File info and upload area */}\r\n                    <div className=\"space-y-2\">\r\n                      {/* File requirements */}\r\n                      <p className=\"text-xs text-gray-500\">\r\n                        PDF (maks. {fileConfig.file_type === 'skp_2_tahun_terakhir' ? '1.6MB' : '500KB'})\r\n                      </p>\r\n                      \r\n                      {/* Upload Progress */}\r\n                      <UploadProgressIndicator \r\n                        progress={uploadProgress[fileConfig.file_type] || 0}\r\n                        isUploading={uploading[fileConfig.file_type]}\r\n                        className=\"mt-2\"\r\n                      />\r\n                      \r\n                      {/* Uploaded File Info */}\r\n                      {status === 'uploaded' && uploadedFile && (\r\n                        <div className=\"space-y-2\">\r\n                          <div className={`flex items-center gap-1 text-xs ${isFileApproved ? 'text-green-600' : isFileRejected ? 'text-red-600' : 'text-blue-600'}`}>\r\n                            {isFileApproved ? (\r\n                              <CheckCircle className=\"h-3 w-3\" />\r\n                            ) : isFileRejected ? (\r\n                              <XCircle className=\"h-3 w-3\" />\r\n                            ) : (\r\n                              <FileText className=\"h-3 w-3\" />\r\n                            )}\r\n                            <span className=\"truncate\">{uploadedFile.file_name}</span>\r\n                            <span className=\"text-gray-500\">({formatFileSize(uploadedFile.file_size)})</span>\r\n                          </div>\r\n                          {isFileRejected && uploadedFile.verification_notes && (\r\n                            <p className=\"text-xs text-red-600 italic\">\r\n                              Catatan: {uploadedFile.verification_notes}\r\n                            </p>\r\n                          )}\r\n                          <div className=\"flex gap-1\">\r\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handlePreview(uploadedFile)} className=\"h-6 px-2 text-xs\">\r\n                              <Eye className=\"h-3 w-3\" />\r\n                            </Button>\r\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownload(uploadedFile)} className=\"h-6 px-2 text-xs\">\r\n                              <Download className=\"h-3 w-3\" />\r\n                            </Button>\r\n                            {/* Button Edit: \r\n                                - Untuk status normal (bukan rejected): semua file bisa diganti\r\n                                - Untuk status rejected: hanya file rejected yang bisa diganti, file approved readonly\r\n                            */}\r\n                            {(!isRejectedStatus || isFileRejected) && (\r\n                              <>\r\n                                <Button size=\"sm\" variant=\"outline\" onClick={() => triggerReplace(fileConfig.file_type)} className=\"h-6 px-2 text-xs\">\r\n                                  <Edit className=\"h-3 w-3\" />\r\n                                </Button>\r\n                                <input\r\n                                  id={`replace-${toSafeId(fileConfig.file_type)}`}\r\n                                  type=\"file\"\r\n                                  className=\"hidden\"\r\n                                  accept=\".pdf,.doc,.docx\"\r\n                                  onChange={(e) => {\r\n                                    const file = e.target.files?.[0];\r\n                                    if (file) {\r\n                                      handleFileUpload(fileConfig.file_type, file);\r\n                                      e.target.value = '';\r\n                                    }\r\n                                  }}\r\n                                />\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                          {isReadonly && (\r\n                            <p className=\"text-xs text-green-600 italic\">\r\n                              File ini sudah sesuai dan tidak perlu diperbaiki\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {/* Drag and Drop Zone - hanya tampilkan jika bisa upload */}\r\n                      {canUpload && status !== 'uploaded' && (\r\n                        <div\r\n                          className={`relative border-2 border-dashed rounded-lg p-6 transition-all duration-200 cursor-pointer w-full h-32 ${\r\n                            dragOver === fileConfig.file_type\r\n                              ? 'border-green-500 bg-green-50'\r\n                              : 'border-gray-300 hover:border-green-400 hover:bg-gray-50'\r\n                          } ${uploading[fileConfig.file_type] ? 'pointer-events-none opacity-50' : ''}`}\r\n                          onDragEnter={(e) => handleDragEnter(fileConfig.file_type, e)}\r\n                          onDragLeave={(e) => handleDragLeave(fileConfig.file_type, e)}\r\n                          onDragOver={handleDragOver}\r\n                          onDrop={(e) => handleDrop(fileConfig.file_type, e)}\r\n                          onClick={() => {\r\n                            const input = document.getElementById(`file-${toSafeId(fileConfig.file_type)}`) as HTMLInputElement | null;\r\n                            if (input && !input.disabled && !uploading[fileConfig.file_type]) input.click();\r\n                          }}\r\n                        >\r\n                          <div className=\"flex flex-col items-center justify-center h-full text-center\">\r\n                            {uploading[fileConfig.file_type] ? (\r\n                              <div className=\"w-full max-w-xs\">\r\n                                <UploadProgressIndicator \r\n                                  progress={uploadProgress[fileConfig.file_type] || 0}\r\n                                  isUploading={uploading[fileConfig.file_type]}\r\n                                />\r\n                              </div>\r\n                            ) : dragOver === fileConfig.file_type ? (\r\n                              <>\r\n                                <Upload className=\"h-8 w-8 text-green-500 mb-2\" />\r\n                                <p className=\"text-sm text-green-600 font-medium\">Lepaskan file di sini</p>\r\n                              </>\r\n                            ) : (\r\n                              <>\r\n                                <Upload className=\"h-6 w-6 text-gray-400 mb-2\" />\r\n                                <p className=\"text-xs text-gray-600 leading-tight\">Drag & drop file di sini atau klik untuk memilih</p>\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                          \r\n                          {/* Hidden file input */}\r\n                          <input\r\n                            type=\"file\"\r\n                            accept=\".pdf,.doc,.docx\"\r\n                            onChange={(e) => {\r\n                              console.log('ðŸ“ File input changed:', e.target.files);\r\n                              const file = e.target.files?.[0];\r\n                              if (file) {\r\n                                console.log('ðŸ“„ File selected:', file.name, 'fileConfig.file_type:', fileConfig.file_type);\r\n                                handleFileUpload(fileConfig.file_type, file);\r\n                                e.target.value = '';\r\n                              } else {\r\n                                console.log('âŒ No file selected');\r\n                              }\r\n                            }}\r\n                            className=\"hidden\"\r\n                            id={`file-${toSafeId(fileConfig.file_type)}`}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {/* Pesan untuk file yang belum ada tapi status rejected */}\r\n                      {isRejectedStatus && !uploadedFile && (\r\n                        <p className=\"text-xs text-gray-500 italic\">\r\n                          File ini belum diupload\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n\r\n\r\n      {/* Error Modal */}\r\n      <AlertDialog open={showErrorModal} onOpenChange={setShowErrorModal}>\r\n        <AlertDialogContent className=\"max-w-md\">\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle className=\"flex items-center gap-2 text-red-600 text-lg\">\r\n              <XCircle className=\"h-5 w-5\" />\r\n              {errorTitle}\r\n            </AlertDialogTitle>\r\n            <AlertDialogDescription className=\"text-gray-700 whitespace-pre-line leading-relaxed\">\r\n              {errorMessage}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogAction \r\n              onClick={() => setShowErrorModal(false)}\r\n              className=\"bg-red-600 hover:bg-red-700\"\r\n            >\r\n              Tutup\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminWilayahFileUpload;\r\n","import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, Upload, Clock } from 'lucide-react';\r\n\r\ninterface UploadProgressTrackerProps {\r\n  uploaded: number;\r\n  total: number;\r\n  isComplete: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst UploadProgressTracker: React.FC<UploadProgressTrackerProps> = ({\r\n  uploaded,\r\n  total,\r\n  isComplete,\r\n  className = ''\r\n}) => {\r\n  const percentage = total > 0 ? Math.round((uploaded / total) * 100) : 0;\r\n\r\n  return (\r\n    <div className={`bg-white border border-gray-200 rounded-lg p-4 ${className}`}>\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Progress Upload Dokumen</h3>\r\n        <div className=\"text-right\">\r\n          <div className=\"text-sm text-gray-600\">\r\n            {uploaded} dari {total} dokumen\r\n          </div>\r\n          <div className=\"text-lg font-bold text-green-600\">\r\n            {percentage}%\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Progress Bar */}\r\n      <div className=\"mb-4\">\r\n        <Progress \r\n          value={percentage} \r\n          className=\"h-3 bg-gray-200\"\r\n        />\r\n      </div>\r\n      \r\n      {/* Status Breakdown */}\r\n      <div className=\"flex items-center gap-6 text-sm\">\r\n        <div className=\"flex items-center gap-2 text-green-600\">\r\n          <CheckCircle className=\"h-4 w-4\" />\r\n          <span>{uploaded} Terupload</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-2 text-gray-500\">\r\n          <Clock className=\"h-4 w-4\" />\r\n          <span>{total - uploaded} Belum</span>\r\n        </div>\r\n        {isComplete && (\r\n          <div className=\"flex items-center gap-2 text-green-600 font-medium\">\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            <span>Upload Selesai</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadProgressTracker;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { ArrowLeft, FileText, User, Calendar, MapPin, CheckCircle, XCircle, Send, ChevronDown, Loader2 } from 'lucide-react';\r\nimport { useFormSubmissionProtection } from '@/hooks/useDoubleClickProtection';\r\nimport { SubmitButton } from '@/components/ui/protected-button';\r\nimport { PageHeader } from '@/components/PageHeader';\r\nimport AdminWilayahFileUpload from '@/components/AdminWilayahFileUpload';\r\nimport UploadProgressTracker from '@/components/UploadProgressTracker';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { apiGet, apiPost } from '@/lib/api';\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\r\n\r\ninterface PengajuanFile {\r\n  id: string;\r\n  file_type: string;\r\n  file_category?: string;\r\n  file_name: string;\r\n  file_size: number;\r\n  verification_status?: string;\r\n  verification_notes?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\ninterface PengajuanDetail {\r\n  id: string;\r\n  jenis_jabatan: number;\r\n  status: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  pegawai?: { nama: string; nip: string };\r\n  office?: { id: string; name: string; kabkota: string };\r\n  final_rejected_by?: string;\r\n  final_rejected_at?: string;\r\n  final_rejection_reason?: string;\r\n  rejection_reason?: string;\r\n  rejected_at?: string;\r\n  files?: PengajuanFile[];\r\n}\r\n\r\nconst AdminWilayahUploadPage: React.FC = () => {\r\n  const { pengajuanId } = useParams<{ pengajuanId: string }>();\r\n  const navigate = useNavigate();\r\n  const { token } = useAuth();\r\n  const [pengajuan, setPengajuan] = useState<PengajuanDetail | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const { submitForm, isSubmitting } = useFormSubmissionProtection();\r\n  const [showSuccessDialog, setShowSuccessDialog] = useState(false);\r\n  const [showErrorDialog, setShowErrorDialog] = useState(false);\r\n  const [dialogMessage, setDialogMessage] = useState('');\r\n  const [availableJobTypes, setAvailableJobTypes] = useState<string[]>([]);\r\n  const [selectedJobType, setSelectedJobType] = useState<string>('');\r\n  const [uploadProgress, setUploadProgress] = useState<{ required: number; total: number; isComplete: boolean }>({ required: 0, total: 0, isComplete: false });\r\n  const isFinalRejected = pengajuan?.status === 'admin_wilayah_rejected' && Boolean(pengajuan?.final_rejected_at);\r\n\r\n  const fetchDetail = async () => {\r\n    if (!token || !pengajuanId) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiGet(`/api/admin-wilayah/pengajuan/${pengajuanId}`, token);\r\n      if (res && res.success !== false) {\r\n        // backend returns { success, pengajuan, adminWilayahFileConfig, uploadProgress, ... }\r\n        setPengajuan(res.pengajuan || res.data?.pengajuan || res);\r\n        const progress = res.uploadProgress || res.data?.uploadProgress;\r\n        if (progress) {\r\n          const uploadedCount = Number(progress.required ?? 0); // backend uses 'required' as uploaded count\r\n          const totalRequired = Number(progress.total ?? 0);\r\n          const complete = typeof progress.isComplete === 'boolean' ? progress.isComplete : uploadedCount >= totalRequired;\r\n          setUploadProgress({\r\n            required: uploadedCount,\r\n            total: totalRequired,\r\n            isComplete: complete\r\n          });\r\n        } else {\r\n          setUploadProgress({ required: 0, total: 0, isComplete: false });\r\n        }\r\n      } else {\r\n        setPengajuan(null);\r\n        setUploadProgress({ required: 0, total: 0, isComplete: false });\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to fetch pengajuan detail', e);\r\n      setPengajuan(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fetch available job types from admin wilayah config\r\n  const fetchAvailableJobTypes = async () => {\r\n    try {\r\n      const res = await apiGet('/api/admin-wilayah-file-config', token);\r\n      if (res?.success && Array.isArray(res.data)) {\r\n        // Extract unique job type names with their IDs\r\n        const jobTypeMap = new Map();\r\n        res.data.forEach((c: any) => {\r\n          const jobTypeId = c.jenis_jabatan_id;\r\n          const jobTypeName = c.jenis_jabatan?.jenis_jabatan || `Jabatan ${jobTypeId}`;\r\n          if (jobTypeId && !jobTypeMap.has(jobTypeId)) {\r\n            jobTypeMap.set(jobTypeId, jobTypeName);\r\n          }\r\n        });\r\n        \r\n        const names = Array.from(jobTypeMap.values());\r\n        setAvailableJobTypes(names);\r\n        \r\n        // Set default selection if available\r\n        if (names.length > 0 && !selectedJobType) {\r\n          setSelectedJobType(names[0]);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch job types:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDetail();\r\n    fetchAvailableJobTypes();\r\n  }, [pengajuanId, token]);\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('id-ID', {\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const getStatusBadge = (status: string, pengajuan?: any) => {\r\n    // Helper function to determine if this is submitted after admin wilayah approval\r\n    const isSubmittedAfterAdminWilayah = (status: string, pengajuan?: any) => {\r\n      if (status !== 'submitted' || !pengajuan) return false;\r\n      // Only show \"Diajukan Admin Wilayah\" if there are actual admin wilayah files\r\n      return pengajuan.files?.some((f: any) => f.file_category === 'admin_wilayah') || false;\r\n    };\r\n\r\n    switch (status) {\r\n      case 'approved':\r\n        return <Badge className=\"bg-green-600 text-white\">Disetujui Kab/Kota</Badge>;\r\n      case 'rejected':\r\n        return <Badge className=\"bg-red-600 text-white\">Ditolak Admin Wilayah</Badge>;\r\n      case 'admin_wilayah_approved':\r\n        return <Badge className=\"bg-green-700 text-white\">Disetujui Admin Wilayah</Badge>;\r\n      case 'admin_wilayah_rejected':\r\n        return <Badge className=\"bg-red-600 text-white\">Ditolak Superadmin</Badge>;\r\n      case 'admin_wilayah_submitted':\r\n        return <Badge className=\"bg-blue-600 text-white\">Diajukan Admin Wilayah</Badge>;\r\n      case 'submitted':\r\n        return <Badge className=\"bg-blue-600 text-white\">Dikirim ke Superadmin</Badge>;\r\n      default:\r\n        return <Badge className=\"bg-gray-600 text-white\">{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  const approve = async () => {\r\n    if (!token || !pengajuanId) return;\r\n    setSubmitting(true);\r\n    try {\r\n      await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/approve`, {}, token);\r\n      await fetchDetail();\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const reject = async () => {\r\n    if (!token || !pengajuanId) return;\r\n    setSubmitting(true);\r\n    try {\r\n      await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/reject`, { rejection_reason: 'Ditolak oleh Admin Wilayah' }, token);\r\n      await fetchDetail();\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const submitToSuperadmin = async () => {\r\n    if (!token || !pengajuanId) return;\r\n    \r\n    submitForm(\r\n      async () => {\r\n        try {\r\n          const response = await apiPost(`/api/admin-wilayah/pengajuan/${pengajuanId}/submit-to-superadmin`, {}, token);\r\n          \r\n          if (response?.success !== false) {\r\n            setDialogMessage(\"Pengajuan berhasil diajukan ke Superadmin\");\r\n            setShowSuccessDialog(true);\r\n            // Update status immediately from response\r\n            if (response.pengajuan) {\r\n              setPengajuan(response.pengajuan);\r\n            }\r\n          }\r\n          \r\n          await fetchDetail();\r\n        } catch (error: any) {\r\n          console.error('Error submitting to superadmin:', error);\r\n          setDialogMessage(error?.message || \"Terjadi kesalahan saat mengajukan ke Superadmin\");\r\n          setShowErrorDialog(true);\r\n        }\r\n      },\r\n      () => {\r\n        // onSuccess - already handled above\r\n      },\r\n      (error) => {\r\n        // onError - already handled in try-catch above\r\n        console.error('Error submitting to superadmin:', error);\r\n      }\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background p-6\">\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          <div className=\"animate-pulse space-y-6\">\r\n            <div className=\"h-8 bg-gray-200 rounded w-1/3\"></div>\r\n            <div className=\"h-64 bg-gray-200 rounded\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!pengajuan) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background p-6\">\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          <div className=\"text-center py-12\">\r\n            <FileText className=\"h-16 w-16 mx-auto text-gray-300 mb-4\" />\r\n            <h2 className=\"text-2xl font-semibold text-gray-900 mb-2\">Pengajuan Tidak Ditemukan</h2>\r\n            <p className=\"text-gray-600 mb-6\">Pengajuan yang Anda cari tidak ditemukan atau tidak memiliki akses.</p>\r\n            <Button\r\n              onClick={() => navigate('/admin-wilayah/dashboard')}\r\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Kembali ke Dashboard\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Cek apakah masih ada file yang rejected (untuk status admin_wilayah_rejected)\r\n  const hasRejectedFiles = (() => {\r\n    if (pengajuan?.status !== 'admin_wilayah_rejected') return false;\r\n    if (!pengajuan?.files || !Array.isArray(pengajuan.files)) return false;\r\n    const adminWilayahFiles = pengajuan.files.filter((f: any) => f.file_category === 'admin_wilayah');\r\n    return adminWilayahFiles.some((f: any) => f.verification_status === 'rejected');\r\n  })();\r\n\r\n  const showSubmitButton = pengajuan.status === 'admin_wilayah_approved' || pengajuan.status === 'admin_wilayah_submitted' || pengajuan.status === 'admin_wilayah_rejected' || isFinalRejected;\r\n  \r\n  // Button disabled jika:\r\n  // 1. Status sudah submitted\r\n  // 2. Status rejected tapi masih ada file yang rejected (belum semua diperbaiki)\r\n  // 3. Upload progress belum complete (untuk status normal)\r\n  const submitButtonDisabled = pengajuan.status === 'admin_wilayah_submitted' || \r\n                                (pengajuan.status === 'admin_wilayah_rejected' && hasRejectedFiles) ||\r\n                                (pengajuan.status !== 'admin_wilayah_rejected' && !uploadProgress.isComplete);\r\n  \r\n  const submitButtonLabel = pengajuan.status === 'admin_wilayah_submitted'\r\n    ? 'Sudah Diajukan'\r\n    : (isFinalRejected || pengajuan.status === 'admin_wilayah_rejected')\r\n      ? 'Ajukan Lagi ke Superadmin'\r\n      : 'Ajukan ke Superadmin';\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background p-6\">\r\n      <div className=\"max-w-6xl mx-auto space-y-6\">\r\n        {/* Header with Breadcrumb */}\r\n        <PageHeader\r\n          title=\"Upload File Admin Wilayah\"\r\n          subtitle=\"Upload file tambahan untuk pengajuan mutasi pegawai\"\r\n          actions={\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge className=\"bg-green-100 text-green-800\">Admin Wilayah</Badge>\r\n              {getStatusBadge(pengajuan.status, pengajuan)}\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => navigate('/admin-wilayah/dashboard')}\r\n                className=\"border-green-200 text-green-700 hover:bg-green-50\"\r\n              >\r\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n                Kembali\r\n              </Button>\r\n            </div>\r\n          }\r\n        />\r\n\r\n        {/* Pengajuan Info */}\r\n        <Card className=\"border-green-200 bg-green-50\">\r\n          <CardHeader>\r\n            <CardTitle className=\"text-green-800 flex items-center gap-2\">\r\n              <FileText className=\"h-5 w-5\" />\r\n              Informasi Pengajuan\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <User className=\"h-5 w-5 text-green-600\" />\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-gray-900\">{pengajuan.pegawai?.nama || '-'}</h3>\r\n                    <p className=\"text-sm text-gray-600\">NIP: {pengajuan.pegawai?.nip || '-'}</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <MapPin className=\"h-5 w-5 text-green-600\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-gray-900\">{pengajuan.office?.kabkota || '-'}</p>\r\n                    <p className=\"text-sm text-gray-600\">{pengajuan.office?.name || '-'}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <FileText className=\"h-5 w-5 text-green-600\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-gray-900\">Jenis Jabatan</p>\r\n                    <p className=\"text-sm text-gray-600\">{pengajuan.jenis_jabatan}</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Calendar className=\"h-5 w-5 text-green-600\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-gray-900\">Tanggal Pengajuan</p>\r\n                    <p className=\"text-sm text-gray-600\">{formatDate(pengajuan.created_at)}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Upload Section */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-green-800\">Upload File Admin Wilayah</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {/* Job Type Selection */}\r\n            <div className=\"mb-6\">\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Pilih Jenis Berkas Admin Wilayah\r\n              </label>\r\n              <Select value={selectedJobType} onValueChange={setSelectedJobType}>\r\n                <SelectTrigger className=\"w-full max-w-md\">\r\n                  <SelectValue placeholder=\"Pilih jenis berkas...\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {availableJobTypes.map((jobType) => (\r\n                    <SelectItem key={jobType} value={jobType}>\r\n                      {jobType}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Pilih jenis berkas yang sudah dikonfigurasi oleh superadmin\r\n              </p>\r\n            </div>\r\n\r\n            {/* Upload Progress Tracker */}\r\n            {selectedJobType && uploadProgress.total > 0 && (\r\n              <UploadProgressTracker\r\n                uploaded={uploadProgress.required}\r\n                total={uploadProgress.total}\r\n                isComplete={uploadProgress.isComplete}\r\n                className=\"mb-6\"\r\n              />\r\n            )}\r\n\r\n            {(isFinalRejected || pengajuan.status === 'admin_wilayah_rejected') && (\r\n              <div className=\"mb-4 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800\">\r\n                <p className=\"font-semibold mb-1\">Dokumen Admin Wilayah Ditolak</p>\r\n                <p>{pengajuan.final_rejection_reason || pengajuan.rejection_reason || 'Perbaiki dokumen admin wilayah yang ditolak sebelum mengirim ulang ke Superadmin.'}</p>\r\n                {(pengajuan.final_rejected_at || pengajuan.rejected_at) && (\r\n                  <p className=\"text-xs text-red-600 mt-2\">\r\n                    Ditolak pada: {formatDate(pengajuan.final_rejected_at || pengajuan.rejected_at!)}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* File Upload Component */}\r\n            {selectedJobType && (\r\n              <AdminWilayahFileUpload\r\n                pengajuanId={pengajuan.id}\r\n                jenisJabatanId={selectedJobType}\r\n                onFilesUploaded={() => fetchDetail()}\r\n                onProgressChange={(uploaded, total) => setUploadProgress({ required: uploaded, total, isComplete: uploaded >= total && total > 0 })}\r\n                pengajuanStatus={pengajuan.status}\r\n                pengajuanData={pengajuan}\r\n              />\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex items-center justify-end gap-3\">\r\n          {showSubmitButton && (\r\n            <>\r\n              <span className=\"text-sm text-gray-600 mr-2\">{uploadProgress.required}/{uploadProgress.total} berkas wajib</span>\r\n              <SubmitButton \r\n                onClick={submitButtonDisabled ? () => {} : submitToSuperadmin} \r\n                className={`bg-green-600 hover:bg-green-700 text-white ${submitButtonDisabled ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                isProcessing={isSubmitting}\r\n                processingText=\"Mengirim...\"\r\n                onError={() => {}}\r\n                onSuccess={() => {}}\r\n              >\r\n                <Send className=\"h-4 w-4 mr-2\" />\r\n                {submitButtonLabel}\r\n              </SubmitButton>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Success Dialog */}\r\n      <AlertDialog open={showSuccessDialog} onOpenChange={setShowSuccessDialog}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle className=\"flex items-center gap-2 text-green-600 text-lg\">\r\n            <CheckCircle className=\"h-5 w-5\" />\r\n            Berhasil!\r\n          </AlertDialogTitle>\r\n          <AlertDialogDescription className=\"text-gray-700\">\r\n            {dialogMessage}\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogAction \r\n            onClick={() => setShowSuccessDialog(false)}\r\n            className=\"bg-green-600 hover:bg-green-700\"\r\n          >\r\n            OK\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Error Dialog */}\r\n      <AlertDialog open={showErrorDialog} onOpenChange={setShowErrorDialog}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle className=\"flex items-center gap-2 text-red-600 text-lg\">\r\n            <XCircle className=\"h-5 w-5\" />\r\n            Gagal Mengajukan\r\n          </AlertDialogTitle>\r\n          <AlertDialogDescription className=\"text-gray-700\">\r\n            {dialogMessage}\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogAction \r\n            onClick={() => setShowErrorDialog(false)}\r\n            className=\"bg-red-600 hover:bg-red-700\"\r\n          >\r\n            OK\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminWilayahUploadPage;\r\n"],"names":["UploadProgressIndicator","progress","isUploading","className","normalizedProgress","displayProgress","getStatusText","getProgressColor","getProgressBarColor","jsxs","jsx","toSafeId","raw","AdminWilayahFileUpload","pengajuanId","jenisJabatanId","onFilesUploaded","onProgressChange","pengajuanStatus","pengajuanData","token","user","useAuth","toast","useToast","useFormSubmissionProtection","requiredFiles","setRequiredFiles","useState","uploadedFiles","setUploadedFiles","uploading","setUploading","uploadProgress","setUploadProgress","loading","setLoading","error","setError","dragOver","setDragOver","isDragActive","setIsDragActive","showErrorModal","setShowErrorModal","errorMessage","setErrorMessage","errorTitle","setErrorTitle","fetchFileConfigs","jobTypeId","jobTypeRes","apiGet","jobType","jt","response","uploadedCount","f","c","fetchUploadedFiles","res","mapped","_a","useEffect","totalRequired","r","handleFileUpload","fileType","file","prev","guardJabatanMatch","formData","key","value","progressInterval","current","apiPost","newFile","nextFiles","errorMsg","showErrorModalHandler","formatFileSize","bytes","k","sizes","getFileStatus","getUploadedFile","getJobTypeSpecificDescription","getDescriptiveLabel","fileConfig","file_type","display_name","jobTypeSpecificDescription","handlePreview","blob","url","showError","handleDownload","a","showDownloadError","triggerReplace","input","operatorJabatan","adminSelectedJabatan","title","message","handleDragEnter","event","handleDragLeave","handleDragOver","handleDrop","files","allowedTypes","fileExtension","maxSize","_","i","AlertCircle","Button","RefreshCw","uploadedFile","status","isRejectedStatus","isFileApproved","isFileRejected","isReadonly","canUpload","Card","CardContent","Badge","CheckCircle","XCircle","FileText","Eye","Download","Fragment","Edit","e","Upload","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogAction","UploadProgressTracker","uploaded","total","isComplete","percentage","Progress","Clock","AdminWilayahUploadPage","useParams","navigate","useNavigate","pengajuan","setPengajuan","submitForm","isSubmitting","showSuccessDialog","setShowSuccessDialog","showErrorDialog","setShowErrorDialog","dialogMessage","setDialogMessage","availableJobTypes","setAvailableJobTypes","selectedJobType","setSelectedJobType","isFinalRejected","fetchDetail","_b","complete","fetchAvailableJobTypes","jobTypeMap","jobTypeName","names","formatDate","dateString","getStatusBadge","submitToSuperadmin","ArrowLeft","hasRejectedFiles","showSubmitButton","submitButtonDisabled","submitButtonLabel","PageHeader","CardHeader","CardTitle","User","MapPin","_c","_d","Calendar","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","SubmitButton","Send"],"mappings":"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"}