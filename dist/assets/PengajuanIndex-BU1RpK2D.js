import{j as e,F as P,ar as be,a8 as qe,aM as Y,aN as pe,E as fe,a3 as T,aD as A,at as ve,aK as X,p as Q,a9 as ye,as as we,ak as Ne}from"./ui-vendor-B7g5fNgE.js";import{e as Ye,r as d,c as Xe}from"./react-vendor-BNG1zHOu.js";import{C as Qe,a as Ze,b as ea,c as aa}from"./card-BxGrc11R.js";import{u as sa,a as ke,B as h,I as ta,b as I,p as Se,q as De,r as Ce,v as j,l as la}from"./index-BQ3AkV0g.js";import{S as Z,a as ee,b as ae,c as se,d as _}from"./select-Bek3Bytz.js";import{T as te,a as le,b as F,c,d as ne,e as m}from"./table-Cd7D0qcd.js";import{A as na,a as ia,b as ra,c as ca}from"./accordion-Cy4LZBgd.js";import{A as da,a as oa,b as ha,c as ma,d as xa,e as ga,g as ua,f as ja}from"./alert-dialog-XJWdMrzJ.js";const Sa=()=>{const u=Ye(),{user:l,token:O,isAuthenticated:M}=sa(),[b,_e]=d.useState([]),[Fe,ie]=d.useState(!0),[re,U]=d.useState(null),[C,$e]=d.useState(""),[y,ce]=d.useState("all"),[J,Pe]=d.useState("all"),[z,Te]=d.useState("all"),[r,x]=d.useState(1),[w,Ae]=d.useState(1),[f,Me]=d.useState(0),[Ue,B]=d.useState(!1),[de,H]=d.useState(null),[G,oe]=d.useState(!1),[$,Je]=d.useState({users:[],statuses:[],jenisJabatan:[]}),[R,he]=d.useState({}),N=50,o=(l==null?void 0:l.role)==="admin",k=(l==null?void 0:l.role)==="user",V=o||k,E=Xe.useMemo(()=>{if(!V)return{};if(Object.keys(R).length>0)return console.log("ðŸ” Using server grouping:",R),R;if(!b||b.length===0)return{};console.log("ðŸ” Using client grouping, pengajuanList length:",b.length);const a=b.reduce((t,s)=>{var i;const n=s.office&&(s.office.kabkota||s.office.name)||s.pegawai&&s.pegawai.induk_unit||((i=s.pegawai)==null?void 0:i.unit_kerja)||"Lainnya";return t[n]||(t[n]=[]),t[n].push(s),t},{});return console.log("ðŸ” Client grouped result:",a),a},[V,R,b]);d.useEffect(()=>{if(!M){u("/");return}k&&y!=="final_approved"&&ce("final_approved"),me()},[M,u,r,y,J,z,k,C]),d.useEffect(()=>{M&&ze()},[M]);const me=async()=>{var a,t,s;try{ie(!0);const n=new URLSearchParams({page:r.toString(),limit:N.toString(),...y!=="all"&&{status:y},...z!=="all"&&{jenis_jabatan:z},...C&&{search:C},...o&&J!=="all"&&{created_by:J}}),i=await ke(`/api/pengajuan?${n}`,O);if(i.success){if(_e(i.data),o){const v=i.grouped_by_kabkota;console.log("ðŸ” Frontend received grouped data:",v),console.log("ðŸ” Frontend received data length:",(a=i.data)==null?void 0:a.length),he(v||{})}const p=((t=i.pagination)==null?void 0:t.totalPages)||1,S=((s=i.pagination)==null?void 0:s.total)||0;Ae(p),Me(S)}else U(i.message||"Gagal mengambil data pengajuan")}catch(n){console.error("Error fetching pengajuan data:",n),U("Terjadi kesalahan saat mengambil data pengajuan")}finally{ie(!1)}},ze=async()=>{try{console.log("ðŸ” Fetching filter options...");const a=await ke("/api/pengajuan/filter-options",O);console.log("ðŸ” Filter options response:",a),a.success?(Je(a.data),console.log("ðŸ” Filter options set:",a.data)):console.error("ðŸ” Filter options failed:",a.message)}catch(a){console.error("Error fetching filter options:",a)}},Be=a=>{$e(a),x(1)},Re=a=>{k||(ce(a),x(1))},Ee=a=>{Pe(a),x(1)},Ke=a=>{Te(a),x(1)},Le=async()=>{if(de)try{oe(!0);const a=await la(`/api/pengajuan/${de}`,O);a.success?(me(),B(!1),H(null)):U(a.message||"Gagal menghapus pengajuan")}catch(a){console.error("Error deleting pengajuan:",a),U("Terjadi kesalahan saat menghapus pengajuan")}finally{oe(!1)}},xe=(a,t)=>{const s=(S,v)=>{var K;return S!=="submitted"||!v?!1:((K=v.files)==null?void 0:K.some(W=>W.file_category==="admin_wilayah"))||!1},i={draft:{label:"Draft",className:"bg-gray-100 text-gray-800 hover:bg-gray-200",icon:Ne},submitted:{label:s(a,t)?"Diajukan Admin Wilayah":"Diajukan",className:s(a,t)?"bg-blue-200 text-blue-800 hover:bg-blue-300":"bg-blue-100 text-blue-800 hover:bg-blue-200",icon:P},approved:{label:"Disetujui",className:"bg-green-100 text-green-800 hover:bg-green-200",icon:T},rejected:{label:"Ditolak",className:"bg-red-100 text-red-800 hover:bg-red-200",icon:A},resubmitted:{label:"Diajukan Ulang",className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",icon:Ne},admin_wilayah_approved:{label:"Disetujui Admin Wilayah",className:"bg-green-200 text-green-800 hover:bg-green-300",icon:T},admin_wilayah_rejected:{label:"Ditolak Admin Wilayah",className:"bg-red-200 text-red-800 hover:bg-red-300",icon:A},admin_wilayah_submitted:{label:"Diajukan Admin Wilayah",className:"bg-blue-200 text-blue-800 hover:bg-blue-300",icon:P},final_approved:{label:"Final Approved",className:"bg-green-600 text-white",icon:T},final_rejected:{label:"Final Rejected",className:"bg-red-600 text-white",icon:A}}[a]||{label:a,className:"bg-gray-100 text-gray-800",icon:P},p=i.icon;return e.jsxs(I,{className:i.className,children:[e.jsx(p,{className:"h-3 w-3 mr-1"}),i.label]})},ge=a=>({guru:"Guru",eselon_iv:"Eselon IV",fungsional:"Fungsional",pelaksana:"Pelaksana"})[a]||a,ue=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),je=()=>{const a=Object.keys(E).length>0?E:b.reduce((t,s)=>{var i;const n=s.office&&(s.office.kabkota||s.office.name)||s.pegawai&&s.pegawai.induk_unit||((i=s.pegawai)==null?void 0:i.unit_kerja)||"Lainnya";return t[n]||(t[n]=[]),t[n].push(s),t},{});return Object.entries(a).map(([t,s])=>({kabkota:t,total:s.length}))},Ie=(a,t)=>{const s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(s)},Oe=()=>{const a=je(),t=new Date,n=`Rekap-final_approved-per-kabkota-${`${t.getFullYear()}${String(t.getMonth()+1).padStart(2,"0")}${String(t.getDate()).padStart(2,"0")}`}.xls`,i=`
      <html>
      <head><meta charset="UTF-8" /></head>
      <body>
        <table border="1">
          <thead>
            <tr><th>Kab/Kota</th><th>Jumlah Pengajuan Final Approved</th></tr>
          </thead>
          <tbody>
            ${a.map(S=>`<tr><td>${S.kabkota}</td><td>${S.total}</td></tr>`).join("")}
          </tbody>
        </table>
      </body>
      </html>`,p=new Blob([i],{type:"application/vnd.ms-excel"});Ie(p,n)},He=()=>{const a=je().sort((g,D)=>D.total-g.total),t=a.reduce((g,D)=>g+D.total,0),s=Math.max(1,...a.map(g=>g.total)),n=a.length,i=new Date,p=i.toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),v=`Rekap-disetujui-kanwil-per-kabkota-${`${i.getFullYear()}${String(i.getMonth()+1).padStart(2,"0")}${String(i.getDate()).padStart(2,"0")}`}.pdf`,K=(l==null?void 0:l.full_name)||(l==null?void 0:l.email)||"Admin Pusat",W=a.slice(0,5),q=window.open("","_blank");q&&(q.document.write(`
      <html>
        <head>
          <meta charset="UTF-8" />
          <title>${v}</title>
          <style>
            @page { size: A4; margin: 18mm 14mm; }
            * { box-sizing: border-box; }
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color: #111827; }
            .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
            .title { font-size: 18px; font-weight: 700; }
            .meta { font-size: 12px; color: #4b5563; }
            .summary { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 8px; margin: 12px 0 16px; }
            .card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; }
            .card h3 { font-size: 12px; color: #6b7280; margin: 0 0 4px; font-weight: 600; }
            .card .value { font-size: 20px; font-weight: 700; color: #111827; }
            table { border-collapse: collapse; width: 100%; margin-top: 4px; }
            th, td { border: 1px solid #e5e7eb; padding: 8px 10px; font-size: 12px; }
            th { background: #f9fafb; text-align: left; }
            tfoot td { font-weight: 700; background: #f3f4f6; }
            .row { display: flex; align-items: center; gap: 10px; }
            .bar { height: 8px; background: #d1fae5; border-radius: 4px; overflow: hidden; }
            .bar > span { display: block; height: 100%; background: #10b981; }
            .note { margin-top: 12px; font-size: 11px; color: #6b7280; }
            .section-title { margin-top: 16px; font-size: 14px; font-weight: 700; }
          </style>
        </head>
        <body>
          <div class="header">
            <div>
              <div class="title">Rekap Pengajuan Telah Disetujui Kanwil per Kab/Kota</div>
              <div class="meta">Dihasilkan: ${p} â€¢ Dibuat oleh: ${K}</div>
            </div>
          </div>

          <div class="summary">
            <div class="card">
              <h3>Total Telah Disetujui Kanwil</h3>
              <div class="value">${t}</div>
            </div>
            <div class="card">
              <h3>Jumlah Kab/Kota</h3>
              <div class="value">${n}</div>
            </div>
            <div class="card">
              <h3>Top Kab/Kota</h3>
              <div style="font-size:12px; color:#111827; line-height:1.4;">
                ${W.map((g,D)=>`${D+1}. ${g.kabkota} (${g.total})`).join("<br/>")||"-"}
              </div>
            </div>
          </div>

          <div class="section-title">Tabel Rekap</div>
          <table>
            <thead>
              <tr>
                <th style="width:36px;">No</th>
                <th>Kab/Kota</th>
                <th style="width:110px;">Jumlah</th>
                <th style="width:80px;">Persen</th>
                <th>Visual</th>
              </tr>
            </thead>
            <tbody>
              ${a.map((g,D)=>{const Ge=t>0?Math.round(g.total/t*1e3)/10:0,Ve=Math.round(g.total/s*100),L=140,We=Math.max(1,Math.round(Ve/100*L));return`
                  <tr>
                    <td>${D+1}</td>
                    <td>${g.kabkota}</td>
                    <td style="text-align:right; font-variant-numeric: tabular-nums;">${g.total}</td>
                    <td style="text-align:right; font-variant-numeric: tabular-nums;">${Ge.toFixed(1)}%</td>
                    <td>
                      <svg width="${L}" height="10" viewBox="0 0 ${L} 10" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0" y="0" width="${L}" height="10" fill="#E5F6F1" stroke="#D1D5DB" />
                        <rect x="0" y="0" width="${We}" height="10" fill="#10B981" />
                      </svg>
                    </td>
                  </tr>
                `}).join("")}
            </tbody>
            <tfoot>
              <tr>
                <td colspan="2">Total</td>
                <td style="text-align:right; font-variant-numeric: tabular-nums;">${t}</td>
                <td></td>
                <td></td>
              </tr>
            </tfoot>
          </table>

          <div class="note">Catatan: Laporan ini menampilkan pengajuan yang <strong>telah disetujui Kanwil</strong>.</div>

          <script>
            window.onload = function() { window.print(); };
          <\/script>
        </body>
      </html>
    `),q.document.close())};return console.log("ðŸ” Debug PengajuanIndex:",{userRole:l==null?void 0:l.role,isAdmin:o,userEmail:l==null?void 0:l.email}),e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs(Qe,{children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ea,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),"Daftar Pengajuan Mutasi PNS"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o?"Semua pengajuan mutasi PNS":k?"Semua pengajuan berstatus final_approved (read-only)":"Pengajuan mutasi PNS Anda"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsxs(e.Fragment,{children:[e.jsx(h,{onClick:Oe,className:"bg-green-600 hover:bg-green-700 text-white",children:"Export Excel"}),e.jsx(h,{onClick:He,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Export PDF"})]}),(l==null?void 0:l.role)!=="user"&&e.jsxs(h,{onClick:()=>u("/pengajuan/select"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Tambah Pengajuan"]})]})]})}),e.jsxs(aa,{children:[re&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600",children:re})}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ta,{placeholder:"Cari berdasarkan nama pegawai, jabatan, atau jenis jabatan...",value:C,onChange:a=>Be(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-400"}),e.jsxs(Z,{value:y,onValueChange:Re,children:[e.jsx(ee,{className:"w-48",children:e.jsx(ae,{placeholder:"Filter Status"})}),e.jsxs(se,{children:[e.jsx(_,{value:"all",children:"Semua Status"}),$.statuses.filter(a=>a.count>0).map(a=>e.jsxs(_,{value:a.value,children:[a.label," (",a.count,")"]},a.value))]})]})]}),k&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-400"}),e.jsxs(Z,{value:z,onValueChange:Ke,children:[e.jsx(ee,{className:"w-48",children:e.jsx(ae,{placeholder:"Filter Jenis Jabatan"})}),e.jsxs(se,{children:[e.jsx(_,{value:"all",children:"Semua Jenis Jabatan"}),$.jenisJabatan.filter(a=>a.count>0).map(a=>e.jsxs(_,{value:a.value,children:[a.label," (",a.count,")"]},a.value))]})]})]}),o&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-400"}),e.jsxs(Z,{value:J,onValueChange:Ee,children:[e.jsx(ee,{className:"w-48",children:e.jsx(ae,{placeholder:"Filter Pembuat"})}),e.jsxs(se,{children:[e.jsx(_,{value:"all",children:"Semua Pembuat"}),$.users.map(a=>e.jsx(_,{value:a.id,children:a.full_name||a.email||"Unknown User"},a.id))]})]})]})]})]}),V&&Object.keys(E).length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Tergabung berdasarkan kabupaten/kota"}),e.jsx(na,{type:"multiple",className:"w-full",children:Object.entries(E).map(([a,t])=>e.jsxs(ia,{value:a,className:"border rounded-lg",children:[e.jsx(ra,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"font-medium",children:a}),e.jsx(I,{variant:"secondary",className:"ml-2",children:t.length})]})}),e.jsx(ca,{className:"px-0",children:e.jsx("div",{className:"border-t",children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs(F,{children:[e.jsx(c,{children:"Pegawai"}),e.jsx(c,{children:"Jenis Jabatan"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Jumlah Dokumen"}),o&&e.jsx(c,{children:"Pembuat"}),e.jsx(c,{children:"Tanggal Dibuat"}),e.jsx(c,{className:"text-right",children:"Aksi"})]})}),e.jsx(ne,{children:t.map(s=>e.jsxs(F,{className:"hover:bg-gray-50",children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.pegawai.nama}),e.jsx("div",{className:"text-sm text-gray-500",children:s.pegawai.jabatan})]})}),e.jsx(m,{children:e.jsx(I,{variant:"outline",children:ge(s.jenis_jabatan)})}),e.jsx(m,{children:xe(s.status,s)}),e.jsx(m,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm",children:s.files.length})})}),o&&e.jsx(m,{children:e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{var i;const n=$.users.find(p=>p.id===s.created_by);return n?n.full_name||n.email||"Unknown User":(i=s.created_by)!=null&&i.includes("@")?s.created_by:"Unknown User"})()})}),e.jsx(m,{children:e.jsx("div",{className:"text-sm text-gray-600",children:ue(s.created_at)})}),e.jsx(m,{className:"text-right",children:e.jsxs(Se,{children:[e.jsx(De,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsxs(Ce,{align:"end",children:[e.jsxs(j,{onClick:()=>u(`/pengajuan/${s.id}`),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Lihat Detail"]}),o&&s.status==="admin_wilayah_submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:()=>u(`/pengajuan/${s.id}`),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Setujui"]}),e.jsxs(j,{onClick:()=>u(`/pengajuan/${s.id}`),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Tolak"]})]}),o&&e.jsxs(j,{onClick:()=>{H(s.id),B(!0)},className:"text-red-600",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Hapus"]})]})]})})]},s.id))})]})})})]},a))}),w>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(r-1)*N+1," sampai ",Math.min(r*N,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r-1),disabled:r===1,children:[e.jsx(X,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:w},(a,t)=>t+1).map(a=>e.jsx(h,{variant:r===a?"default":"outline",size:"sm",onClick:()=>x(a),className:`w-8 h-8 p-0 ${r===a?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300"}`,children:a},a))}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r+1),disabled:r===w,children:["Selanjutnya",e.jsx(Q,{className:"h-4 w-4"})]})]})]})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:Fe?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(ye,{className:"h-8 w-8 animate-spin mr-2 text-green-600"}),e.jsx("span",{children:"Memuat data pengajuan..."})]}):b.length===0&&f===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:C||y!=="all"?"Tidak ada pengajuan yang sesuai dengan filter":"Belum ada pengajuan"}),!C&&y==="all"&&(l==null?void 0:l.role)!=="user"&&e.jsxs(h,{onClick:()=>u("/pengajuan/select"),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Buat Pengajuan Pertama"]})]}):b.length===0&&f>0?e.jsxs(e.Fragment,{children:[e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs(F,{children:[e.jsx(c,{children:"Pegawai"}),e.jsx(c,{children:"Jenis Jabatan"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Jumlah Dokumen"}),e.jsx(c,{children:"Tanggal Dibuat"}),e.jsx(c,{children:"Aksi"})]})}),e.jsx(ne,{children:e.jsx(F,{children:e.jsx(m,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Tidak ada data di halaman ini"})})})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(r-1)*N+1," sampai ",Math.min(r*N,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r-1),disabled:r===1,children:[e.jsx(X,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:w},(a,t)=>t+1).map(a=>e.jsx(h,{variant:r===a?"default":"outline",size:"sm",onClick:()=>x(a),className:`w-8 h-8 p-0 ${r===a?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300"}`,children:a},a))}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r+1),disabled:r===w,children:["Selanjutnya",e.jsx(Q,{className:"h-4 w-4"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(te,{children:[e.jsx(le,{children:e.jsxs(F,{children:[e.jsx(c,{children:"Pegawai"}),e.jsx(c,{children:"Jenis Jabatan"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Dokumen"}),o&&e.jsx(c,{children:"Pembuat"}),e.jsx(c,{children:"Tanggal Dibuat"}),e.jsx(c,{className:"text-right",children:"Aksi"})]})}),e.jsx(ne,{children:b.map(a=>e.jsxs(F,{className:"hover:bg-gray-50",children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.pegawai.nama}),e.jsx("div",{className:"text-sm text-gray-500",children:a.pegawai.jabatan})]})}),e.jsx(m,{children:e.jsx(I,{variant:"outline",children:ge(a.jenis_jabatan)})}),e.jsx(m,{children:xe(a.status,a)}),e.jsx(m,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm",children:a.files.length})})}),o&&e.jsx(m,{children:e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{var s;const t=$.users.find(n=>n.id===a.created_by);return t?t.full_name||t.email||"Unknown User":(s=a.created_by)!=null&&s.includes("@")?a.created_by:"Unknown User"})()})}),e.jsx(m,{children:e.jsx("div",{className:"text-sm text-gray-600",children:ue(a.created_at)})}),e.jsx(m,{className:"text-right",children:e.jsxs(Se,{children:[e.jsx(De,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsxs(Ce,{align:"end",children:[e.jsxs(j,{onClick:()=>u(`/pengajuan/${a.id}`),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Lihat Detail"]}),(l==null?void 0:l.role)!=="user"&&e.jsxs(e.Fragment,{children:[a.status==="draft"&&e.jsxs(j,{onClick:()=>u(`/pengajuan/${a.id}/upload`),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Upload Dokumen"]}),a.status==="rejected"&&e.jsxs(j,{onClick:()=>u(`/pengajuan/${a.id}/edit`),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Perbaiki Dokumen"]})]}),o&&a.status==="admin_wilayah_submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:()=>u(`/pengajuan/${a.id}`),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Setujui"]}),e.jsxs(j,{onClick:()=>u(`/pengajuan/${a.id}`),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Tolak"]})]}),(o||a.status==="draft"&&(l==null?void 0:l.role)!=="user")&&e.jsxs(j,{onClick:()=>{console.log("ðŸ” Debug: Klik hapus untuk pengajuan:",{id:a.id,status:a.status,isAdmin:o,userRole:l==null?void 0:l.role}),H(a.id),B(!0)},className:"text-red-600",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Hapus"]})]})]})})]},a.id))})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(r-1)*N+1," sampai ",Math.min(r*N,f)," dari ",f," pengajuan"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r-1),disabled:r===1,children:[e.jsx(X,{className:"h-4 w-4"}),"Sebelumnya"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:w},(a,t)=>t+1).map(a=>e.jsx(h,{variant:r===a?"default":"outline",size:"sm",onClick:()=>x(a),className:`w-8 h-8 p-0 ${r===a?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-white hover:bg-green-50 text-gray-700 border-gray-300 hover:border-green-300"}`,children:a},a))}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>x(r+1),disabled:r===w,children:["Selanjutnya",e.jsx(Q,{className:"h-4 w-4"})]})]})]})]})})]})]}),e.jsx(da,{open:Ue,onOpenChange:B,children:e.jsxs(oa,{children:[e.jsxs(ha,{children:[e.jsx(ma,{children:"Hapus Pengajuan"}),e.jsx(xa,{children:"Apakah Anda yakin ingin menghapus pengajuan ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(ga,{children:[e.jsx(ua,{disabled:G,children:"Batal"}),e.jsx(ja,{onClick:Le,disabled:G,className:"bg-red-600 hover:bg-red-700",children:G?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2 animate-spin text-green-600"}),"Menghapus..."]}):"Hapus"})]})]})})]})};export{Sa as default};
//# sourceMappingURL=PengajuanIndex-BU1RpK2D.js.map
