import{j as a,aa as ka,ax as Ka,F as P,a4 as N,E as X,ao as Q,at as Z,U as aa,X as U,aM as Ua}from"./ui-vendor-C6CR1JGj.js";import{d as Ma,e as $a,u as za,r as c}from"./react-vendor-B0B9C2fS.js";import{C as ea,c as sa,a as Ra,b as Ea}from"./card-DJBMZjiH.js";import{u as Ga,d as Ia,a as na,b as B,B as g,P as ta,D as _a,e as fa,f as Na,g as va,c as Ja,j as La}from"./index-Bl8eCSPV.js";import{A as qa,a as Oa,b as Ha,c as Wa,d as Va,e as Ta,g as Ya,f as Xa}from"./alert-dialog-DkoobKvJ.js";import{T as Qa,a as Za,b as wa,c as ya}from"./tabs-c3pWJdEo.js";const S=u=>String(u).toLowerCase().replace(/[^a-z0-9_-]+/gi,"_").replace(/^_+|_+$/g,""),F=u=>({surat_pengantar:"Surat Pengantar",surat_permohonan_dari_yang_bersangkutan:"Surat Permohonan Dari Yang Bersangkutan",surat_keputusan_cpns:"Surat Keputusan CPNS",surat_keputusan_pns:"Surat Keputusan PNS",surat_keputusan_kenaikan_pangkat_terakhir:"Surat Keputusan Kenaikan Pangkat Terakhir",surat_keputusan_jabatan_terakhir:"Surat Keputusan Jabatan Terakhir",skp_2_tahun_terakhir:"SKP 2 Tahun Terakhir",surat_keterangan_bebas_temuan_inspektorat:"Surat Keterangan Bebas Temuan Yang Diterbitkan Inspektorat Jenderal Kementerian Agama",surat_keterangan_anjab_abk_instansi_asal:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi asal",surat_keterangan_anjab_abk_instansi_penerima:"Surat Keterangan Anjab dan ABK terhadap jabatan PNS dari instansi penerima",surat_pernyataan_tidak_hukuman_disiplin:"Surat Pernyataan Tidak Pernah Dijatuhi Hukuman Disiplin Tingkat Sedang atau Berat Dalam 1 (satu) Tahun Terakhir Dari PPK",surat_persetujuan_mutasi_asal:"Surat Persetujuan Mutasi dari ASAL dengan menyebutkan jabatan yang akan diduduki",surat_lolos_butuh_ppk:"Surat Lolos Butuh dari Pejabat Pembina Kepegawaian instansi yang dituju",peta_jabatan:"Peta Jabatan",hasil_uji_kompetensi:"Hasil Uji Kompetensi",hasil_evaluasi_pertimbangan_baperjakat:"Hasil Evaluasi dan Pertimbangan (BAPERJAKAT)",anjab_abk_instansi_asal:"Anjab/Abk Instansi Asal",anjab_abk_instansi_penerima:"Anjab/Abk Instansi Penerima",surat_keterangan_tidak_tugas_belajar:"Surat Keterangan Tidak Sedang Tugas Belajar",sptjm_pimpinan_satker_asal:"SPTJM Pimpinan Satker dari Asal",sptjm_pimpinan_satker_penerima:"SPTJM Pimpinan Satker dari Penerima",surat_rekomendasi_instansi_pembina:"Surat Rekomendasi Instansi Pembina"})[u]||u.replace(/_/g," ").toUpperCase(),ae=u=>({surat_pengantar:"Dokumen Pengantar",surat_permohonan_dari_yang_bersangkutan:"Dokumen Pengantar",surat_keputusan_cpns:"Dokumen Kepegawaian",surat_keputusan_pns:"Dokumen Kepegawaian",surat_keputusan_kenaikan_pangkat_terakhir:"Dokumen Kepegawaian",surat_keputusan_jabatan_terakhir:"Dokumen Kepegawaian",skp_2_tahun_terakhir:"Dokumen Kepegawaian",surat_keterangan_bebas_temuan_inspektorat:"Dokumen Keterangan",surat_keterangan_anjab_abk_instansi_asal:"Dokumen Keterangan",surat_keterangan_anjab_abk_instansi_penerima:"Dokumen Keterangan",surat_pernyataan_tidak_hukuman_disiplin:"Dokumen Pernyataan",surat_persetujuan_mutasi_asal:"Dokumen Persetujuan",surat_lolos_butuh_ppk:"Dokumen Persetujuan",peta_jabatan:"Dokumen Pendukung",hasil_uji_kompetensi:"Dokumen Pendukung",hasil_evaluasi_pertimbangan_baperjakat:"Dokumen Pendukung",anjab_abk_instansi_asal:"Dokumen Pendukung",anjab_abk_instansi_penerima:"Dokumen Pendukung",surat_keterangan_tidak_tugas_belajar:"Dokumen Keterangan",sptjm_pimpinan_satker_asal:"Dokumen Pernyataan",sptjm_pimpinan_satker_penerima:"Dokumen Pernyataan",surat_rekomendasi_instansi_pembina:"Dokumen Rekomendasi"})[u]||"Dokumen Lainnya",ia=u=>({guru:"Guru",eselon_iv:"Eselon IV",fungsional:"Fungsional",pelaksana:"Pelaksana"})[u]||u,le=()=>{var ja,ba;const{pengajuanId:u}=Ma(),D=$a(),ra=za(),{token:b,user:M}=Ga(),{toast:k}=Ia(),[l,Pa]=c.useState(null),[f,v]=c.useState([]),[$,la]=c.useState({}),[z,R]=c.useState({}),[Sa,da]=c.useState(!1),[Fa,E]=c.useState(!1),[Da,ca]=c.useState(!0),[oa,m]=c.useState(null),[K,ua]=c.useState(!1),[x,Ca]=c.useState(null),[Aa,G]=c.useState(!1),[I,C]=c.useState(null),w=c.useRef({}),j=(ja=ra.state)==null?void 0:ja.jabatan,J=(ba=ra.state)==null?void 0:ba.requiredFiles,[ma,pa]=c.useState(null);c.useState([]);const[y,L]=c.useState([]),_=(M==null?void 0:M.role)==="kanwil";c.useEffect(()=>{u&&ga()},[u]),c.useEffect(()=>{if(!_||!b)return;(async()=>{j!=null&&j.id?await q(j.id):l!=null&&l.jabatan_id&&await q(l.jabatan_id)})()},[_,j==null?void 0:j.id,l==null?void 0:l.jabatan_id,b]),c.useEffect(()=>{(()=>{Object.values(w.current).forEach(n=>{n&&(n.value="")})})()});const ga=async()=>{try{ca(!0);const e=await na(`/api/pengajuan/${u}`,b);if(e.success){if(Pa(e.data.pengajuan),J&&J.length>0)v(J),j&&pa(j);else if(e.data.requiredFiles&&e.data.requiredFiles.length>0)v(e.data.requiredFiles);else if(e.data.pengajuan.jabatan_id)try{const n=await na(`/api/job-type-configurations/${e.data.pengajuan.jabatan_id}`,b);n.success&&n.data.required_files?(v(n.data.required_files),pa(n.data)):(m("Konfigurasi dokumen untuk jabatan ini belum tersedia. Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan."),v([]))}catch{m("Gagal mengambil konfigurasi dokumen. Silakan hubungi admin."),v([])}else m("Jabatan belum dikonfigurasi. Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan."),v([]);_&&e.data.pengajuan.jabatan_id&&await q(e.data.pengajuan.jabatan_id)}else m(e.message||"Gagal mengambil data pengajuan")}catch{m("Terjadi kesalahan saat mengambil data pengajuan")}finally{ca(!1)}},q=async e=>{try{const n=await na(`/api/admin-wilayah-file-config/job-type/${e}`,b);n.success&&Array.isArray(n.data)?L(n.data):L([])}catch{L([])}},O=async(e,n)=>{if(!l){const t="Data pengajuan tidak ditemukan. Silakan refresh halaman.";m(t),k({title:"Error",description:t,variant:"destructive"});return}const s=y.some(t=>t.file_type===e);if(!f.includes(e)&&!s){const t=l.jenis_jabatan||"tidak diketahui",i=`File "${F(e)}" tidak sesuai dengan jabatan pengajuan saat ini.

• Jabatan pengajuan: ${ia(t)}
• File yang diupload: ${F(e)}

Silakan pastikan Anda mengupload file yang sesuai dengan jabatan pengajuan.`;m(i),k({title:"Jabatan Tidak Sesuai",description:`File "${F(e)}" tidak sesuai dengan jabatan pengajuan "${ia(t)}". Silakan upload file yang sesuai dengan jabatan pengajuan.`,variant:"destructive"});return}if(n.type!=="application/pdf"&&!n.name.toLowerCase().endsWith(".pdf")){const t="Hanya file PDF yang diizinkan untuk diupload.";m(t),k({title:"Format File Tidak Valid",description:t,variant:"destructive"});return}const h=e==="skp_2_tahun_terakhir"?Math.floor(1.7*1024*1024):500*1024;if(n.size>h){const t=e==="skp_2_tahun_terakhir"?"1.7MB":"500KB",i=(n.size/(1024*1024)).toFixed(2),r=`File terlalu besar. Maksimal ${t}. Ukuran file saat ini: ${i}MB`;m(r),k({title:"Ukuran File Terlalu Besar",description:r,variant:"destructive"});return}la(t=>({...t,[e]:!0})),R(t=>({...t,[e]:0}));const p=new FormData;p.append("file",n),p.append("file_type",e),p.append("file_category",s?"admin_wilayah":"kabupaten");try{const t=setInterval(()=>{R(r=>({...r,[e]:Math.min(r[e]+10,90)}))},200),i=await fetch(`/api/pengajuan/${u}/upload`,{method:"POST",headers:{Authorization:`Bearer ${b}`},body:p});if(clearInterval(t),R(r=>({...r,[e]:100})),i.ok){const r=await i.json();if(r.success){await ga(),m(null),k({title:"Upload Berhasil",description:`File ${F(e)} berhasil diupload`,variant:"default"});const o=w.current[e];o&&(o.value="")}else{const o=r.message||"Gagal upload file";m(o),k({title:"Upload Gagal",description:o,variant:"destructive"})}}else{let r="Gagal upload file";try{const o=await i.json();r=o.message||o.error||`Error ${i.status}: ${i.statusText}`}catch{i.status===413?r="File terlalu besar. Untuk SKP 2 Tahun Terakhir maksimal 1.7MB, file lain maksimal 500KB.":i.status===400?r="Format file tidak valid atau file terlalu besar.":r=`Error ${i.status}: ${i.statusText}`}m(r),k({title:"Upload Gagal",description:r,variant:"destructive"})}}catch(t){const i=(t==null?void 0:t.message)||"Terjadi kesalahan saat upload file. Silakan coba lagi.";m(i),k({title:"Upload Gagal",description:i,variant:"destructive"})}finally{la(i=>({...i,[e]:!1})),C(null);const t=w.current[e];t&&(t.value="")}},Ba=async()=>{try{ua(!0);const e=_?`/api/pengajuan/${u}/submit-kanwil`:`/api/pengajuan/${u}/submit`,s=await(_?Ja:La)(e,{catatan:""},b);s.success?da(!0):m(s.message||"Gagal submit pengajuan")}catch{m("Terjadi kesalahan saat submit pengajuan")}finally{ua(!1),E(!1)}},H=async e=>{try{const n=await fetch(`/api/pengajuan/files/${e.id}`,{headers:{Authorization:`Bearer ${b}`}});if(!n.ok)throw new Error("Gagal mengambil file");const s=await n.blob(),d=URL.createObjectURL(s);Ca({...e,blobUrl:d}),G(!0)}catch{m("Gagal preview file. Silakan coba lagi.")}},W=e=>{window.open(`/api/pengajuan/files/${e.id}`,"_blank")},V=e=>{C(e)},ha=()=>{const e=f.every(n=>l==null?void 0:l.files.some(s=>s.file_type===n&&(!s.file_category||s.file_category==="kabupaten")));if(_&&y.length>0){const n=y.every(s=>l==null?void 0:l.files.some(d=>d.file_type===s.file_type&&d.file_category==="admin_wilayah"));return e&&n}return e},T=(e,n)=>n?l!=null&&l.files.some(s=>s.file_type===e&&s.file_category===n)?"uploaded":"pending":l!=null&&l.files.some(s=>s.file_type===e&&(!s.file_category||s.file_category==="kabupaten"))?"uploaded":"pending",Y=e=>{const s=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,d)).toFixed(2))+" "+s[d]},xa=f.reduce((e,n)=>{const s=ae(n);return e[s]||(e[s]=[]),e[s].push(n),e},{});return Da?a.jsx("div",{className:"container mx-auto p-6",children:a.jsx(ea,{children:a.jsxs(sa,{className:"flex items-center justify-center py-12",children:[a.jsx(ka,{className:"h-8 w-8 animate-spin text-green-600"}),a.jsx("span",{className:"ml-2",children:"Memuat data pengajuan..."})]})})}):l?a.jsxs("div",{className:"container mx-auto p-6",children:[a.jsxs(ea,{children:[a.jsxs(Ra,{children:[a.jsx(Ea,{children:"Upload Berkas Pengajuan Mutasi PNS"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[l.pegawai.nama," - ",l.pegawai.jabatan]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Jenis Jabatan: ",ia(l.jenis_jabatan)]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Total Dokumen: ",ma?ma.max_dokumen:f.length," surat"]})]}),a.jsxs(sa,{children:[oa&&a.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-red-600",children:oa})}),f.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(P,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500 mb-2",children:"Tidak ada dokumen yang diperlukan"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Silakan hubungi admin untuk mengkonfigurasi dokumen yang diperlukan"})]}):_&&y.length>0?a.jsxs(Qa,{defaultValue:"kabupaten",className:"w-full",children:[a.jsxs(Za,{className:"grid w-full grid-cols-2 mb-6",children:[a.jsxs(wa,{value:"kabupaten",className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-4 w-4"}),"Dokumen Kabupaten/Kota",a.jsx(B,{variant:"secondary",className:"ml-2",children:f.length})]}),a.jsxs(wa,{value:"admin_wilayah",className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-4 w-4"}),"Dokumen Admin Wilayah",a.jsx(B,{variant:"secondary",className:"ml-2 bg-purple-100 text-purple-800",children:y.length})]})]}),a.jsx(ya,{value:"kabupaten",className:"space-y-6",children:Object.entries(xa).map(([e,n])=>a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 border-b pb-2",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(s=>{const d=T(s),h=$[s],p=z[s],t=l.files.find(r=>r.file_type===s),i=I===s;return a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:F(s)}),a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Upload file PDF (maks. ",s==="skp_2_tahun_terakhir"?"1.7MB":"500KB",")"]})]}),a.jsxs(B,{variant:"secondary",className:d==="uploaded"?"bg-green-600 text-white hover:bg-green-700":"",children:[d==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),d==="uploaded"?"Uploaded":"Pending"]})]}),d==="uploaded"&&t&&!i?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-green-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:t.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(t.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>H(t),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>W(t),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>V(s),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:r=>w.current[s]=r,type:"file",accept:".pdf",onChange:r=>{var A;const o=(A=r.target.files)==null?void 0:A[0];o&&(O(s,o),r.target.value="")},disabled:h,className:"hidden",id:`file-${S(s)}`}),a.jsxs("label",{htmlFor:`file-${S(s)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),h?"Uploading...":i?"Pilih File Baru":"Pilih File"]}),i&&a.jsxs(g,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(U,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),h&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:p,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[p,"% uploaded"]})]})]},s)})})]},e))}),a.jsx(ya,{value:"admin_wilayah",className:"space-y-6",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(e=>{const n=e.file_type,s=T(n,"admin_wilayah"),d=$[n],h=z[n],p=l.files.find(i=>i.file_type===n&&i.file_category==="admin_wilayah"),t=I===n;return a.jsxs("div",{className:"border rounded-lg p-4 border-purple-300",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:e.display_name||n}),e.description&&a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:e.description}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Upload file PDF (maks. 500KB)"})]}),a.jsxs(B,{variant:"secondary",className:s==="uploaded"?"bg-purple-600 text-white hover:bg-purple-700":"bg-purple-100 text-purple-800",children:[s==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),s==="uploaded"?"Uploaded":"Pending"]})]}),s==="uploaded"&&p&&!t?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-purple-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:p.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(p.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>H(p),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>W(p),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>V(n),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:i=>w.current[n]=i,type:"file",accept:".pdf",onChange:i=>{var o;const r=(o=i.target.files)==null?void 0:o[0];r&&(O(n,r),i.target.value="")},disabled:d,className:"hidden",id:`file-aw-${S(n)}`}),a.jsxs("label",{htmlFor:`file-aw-${S(n)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-purple-300 rounded-md shadow-sm text-sm font-medium text-purple-700 bg-white hover:bg-purple-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),d?"Uploading...":t?"Pilih File Baru":"Pilih File"]}),t&&a.jsxs(g,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(U,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),d&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:h,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h,"% uploaded"]})]})]},n)})})})]}):Object.entries(xa).map(([e,n])=>a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800 border-b pb-2",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(s=>{const d=T(s),h=$[s],p=z[s],t=l.files.find(r=>r.file_type===s),i=I===s;return a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm leading-tight",children:F(s)}),a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Upload file PDF (maks. ",s==="skp_2_tahun_terakhir"?"1.7MB":"500KB",")"]})]}),a.jsxs(B,{variant:"secondary",className:d==="uploaded"?"bg-green-600 text-white hover:bg-green-700":"",children:[d==="uploaded"?a.jsx(N,{className:"h-3 w-3 mr-1"}):a.jsx(P,{className:"h-3 w-3 mr-1"}),d==="uploaded"?"Uploaded":"Pending"]})]}),d==="uploaded"&&t&&!i?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-green-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{className:"truncate",children:t.file_name}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["(",Y(t.file_size),")"]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>H(t),className:"flex items-center gap-1",children:[a.jsx(X,{className:"h-3 w-3"}),"Preview"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>W(t),className:"flex items-center gap-1",children:[a.jsx(Q,{className:"h-3 w-3"}),"Download"]}),a.jsxs(g,{size:"sm",variant:"outline",onClick:()=>V(s),className:"flex items-center gap-1",children:[a.jsx(Z,{className:"h-3 w-3"}),"Ganti File"]})]})]}):a.jsxs("div",{children:[a.jsx("input",{ref:r=>w.current[s]=r,type:"file",accept:".pdf",onChange:r=>{var A;const o=(A=r.target.files)==null?void 0:A[0];o&&(O(s,o),r.target.value="")},disabled:h,className:"hidden",id:`file-${S(s)}`}),a.jsxs("label",{htmlFor:`file-${S(s)}`,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:[a.jsx(aa,{className:"h-4 w-4 mr-2"}),h?"Uploading...":i?"Pilih File Baru":"Pilih File"]}),i&&a.jsxs(g,{size:"sm",variant:"ghost",onClick:()=>C(null),className:"ml-2 text-gray-500",children:[a.jsx(U,{className:"h-3 w-3 mr-1"}),"Batal"]})]}),h&&a.jsxs("div",{className:"mt-2",children:[a.jsx(ta,{value:p,className:"h-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[p,"% uploaded"]})]})]},s)})})]},e)),f.length>0&&a.jsxs("div",{className:"mt-8 pt-6 border-t",children:[a.jsxs(g,{onClick:()=>E(!0),disabled:!ha()||K,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"lg",children:[a.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Submit Pengajuan"]}),!ha()&&a.jsx("p",{className:"text-sm text-gray-500 mt-2 text-center",children:"Semua berkas harus diupload sebelum dapat submit"})]})]})]}),a.jsx(qa,{open:Fa,onOpenChange:E,children:a.jsxs(Oa,{children:[a.jsxs(Ha,{children:[a.jsx(Wa,{children:"Submit Pengajuan"}),a.jsx(Va,{children:"Apakah Anda yakin ingin submit pengajuan ini? Setelah disubmit, pengajuan tidak dapat diedit lagi dan akan diproses oleh admin."})]}),a.jsxs(Ta,{children:[a.jsx(Ya,{disabled:K,children:"Batal"}),a.jsx(Xa,{onClick:Ba,disabled:K,className:"bg-green-600 hover:bg-green-700 text-white",children:K?a.jsxs(a.Fragment,{children:[a.jsx(ka,{className:"h-4 w-4 mr-2 animate-spin text-green-600"}),"Submitting..."]}):"Submit Pengajuan"})]})]})}),a.jsx(_a,{open:Sa,onOpenChange:da,children:a.jsxs(fa,{children:[a.jsx(Na,{children:a.jsx(va,{children:"Pengajuan Berhasil!"})}),a.jsxs("div",{className:"text-center py-6",children:[a.jsx(N,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),a.jsxs("p",{className:"text-lg font-medium mb-2",children:["Pengajuan untuk ",l.pegawai.nama," berhasil disubmit"]}),a.jsx("p",{className:"text-gray-600 mb-6",children:_?"Pengajuan akan diproses oleh superadmin. Anda akan mendapat notifikasi ketika status berubah.":"Pengajuan akan diproses oleh admin. Anda akan mendapat notifikasi ketika status berubah."}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(g,{onClick:()=>D("/dashboard"),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:"Kembali ke Dashboard"}),a.jsx(g,{onClick:()=>D("/pengajuan/select"),variant:"outline",className:"flex-1",children:"Buat Pengajuan Baru"})]})]})]})}),a.jsx(_a,{open:Aa,onOpenChange:e=>{G(e),!e&&(x!=null&&x.blobUrl)&&URL.revokeObjectURL(x.blobUrl)},children:a.jsxs(fa,{className:"max-w-4xl",children:[a.jsx(Na,{children:a.jsx(va,{className:"flex items-center justify-between",children:a.jsxs("span",{children:["Preview File: ",x==null?void 0:x.file_name]})})}),a.jsx("div",{className:"mt-4",children:x&&a.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"bg-green-600 text-white px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:x.file_name}),a.jsx(g,{variant:"ghost",size:"sm",onClick:()=>G(!1),className:"text-white hover:bg-green-700",children:a.jsx(U,{className:"h-4 w-4"})})]}),a.jsx("iframe",{src:x.blobUrl||`/api/pengajuan/files/${x.id}`,className:"w-full h-96 border-0",title:"File Preview"})]})})]})})]}):a.jsx("div",{className:"container mx-auto p-6",children:a.jsx(ea,{children:a.jsxs(sa,{className:"flex items-center justify-center py-12",children:[a.jsx(Ka,{className:"h-8 w-8 text-red-500"}),a.jsx("span",{className:"ml-2 text-red-600",children:"Pengajuan tidak ditemukan"})]})})})};export{le as default};
